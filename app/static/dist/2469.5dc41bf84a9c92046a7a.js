"use strict";(self.webpackChunkvenezia_frontend=self.webpackChunkvenezia_frontend||[]).push([[2469],{22469:function(e,a,t){t.r(a);var r=t(96540),l=t(47767),n=t(67984),s=t(76069),c=t(19869),m=t(93893),d=t(3160),o=t(98188),i=t(32708),g=t(80697),u=t(44471),E=t(37946),x=t(94945),v=t(70700),y=t(42203),p=t(93823),h=t(72284),N=t(11562),b=t(71428),f=t(28219),k=t(67773);const w=({store:e,onEdit:a,onDelete:t,onView:l})=>r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 space-y-4 hover:shadow-md transition-shadow"},r.createElement("div",{className:"flex items-start justify-between"},r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:"p-2 bg-blue-100 dark:bg-blue-900/30 rounded-lg"},r.createElement(n.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})),r.createElement("div",null,r.createElement("h3",{className:"font-semibold text-gray-900 dark:text-white"},e.name),r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},e.code))),r.createElement(f.A,{variant:e.active?"success":"danger"},e.active?"Activa":"Inactiva")),r.createElement("div",{className:"space-y-3"},r.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400"},r.createElement(s.A,{className:"h-4 w-4"}),r.createElement("span",null,e.address)),r.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400"},r.createElement(c.A,{className:"h-4 w-4"}),r.createElement("span",null,e.phone||"Sin teléfono")),r.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-600 dark:text-gray-400"},r.createElement(m.A,{className:"h-4 w-4"}),r.createElement("span",null,e.employees_count||0," empleados"))),r.createElement("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"text-center"},r.createElement("div",{className:"text-lg font-semibold text-gray-900 dark:text-white"},"$",(e.monthly_sales||0).toFixed(0)),r.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400"},"Ventas del mes")),r.createElement("div",{className:"text-center"},r.createElement("div",{className:"text-lg font-semibold text-gray-900 dark:text-white"},e.daily_orders||0),r.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400"},"Órdenes hoy"))),r.createElement("div",{className:"flex items-center gap-2 pt-4"},r.createElement(h.A,{variant:"outline",size:"sm",onClick:()=>l(e),className:"flex-1"},r.createElement(d.A,{className:"h-4 w-4 mr-1"}),"Ver"),r.createElement(h.A,{variant:"outline",size:"sm",onClick:()=>a(e),className:"flex-1"},r.createElement(o.A,{className:"h-4 w-4 mr-1"}),"Editar"),r.createElement(h.A,{variant:"outline",size:"sm",onClick:()=>t(e),className:"text-red-600 hover:text-red-700 dark:text-red-400"},r.createElement(i.A,{className:"h-4 w-4"})))),A=({store:e,isOpen:a,onClose:t,onSave:l})=>{const[n,s]=(0,r.useState)({name:"",code:"",address:"",phone:"",email:"",manager:"",active:!0,coordinates:{lat:null,lng:null},opening_hours:{monday:{open:"09:00",close:"18:00",closed:!1},tuesday:{open:"09:00",close:"18:00",closed:!1},wednesday:{open:"09:00",close:"18:00",closed:!1},thursday:{open:"09:00",close:"18:00",closed:!1},friday:{open:"09:00",close:"18:00",closed:!1},saturday:{open:"09:00",close:"18:00",closed:!1},sunday:{open:"09:00",close:"18:00",closed:!0}}});return(0,r.useEffect)((()=>{s(e?{name:e.name||"",code:e.code||"",address:e.address||"",phone:e.phone||"",email:e.email||"",manager:e.manager||"",active:!1!==e.active,coordinates:e.coordinates||{lat:null,lng:null},opening_hours:e.opening_hours||n.opening_hours}:{name:"",code:"",address:"",phone:"",email:"",manager:"",active:!0,coordinates:{lat:null,lng:null},opening_hours:n.opening_hours})}),[e,a]),r.createElement(k.A,{isOpen:a,onClose:t,title:e?"Editar Tienda":"Nueva Tienda",size:"lg"},r.createElement("form",{onSubmit:e=>{e.preventDefault(),l(n)},className:"space-y-6"},r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Nombre de la Tienda"),r.createElement(N.A,{value:n.name,onChange:e=>s((a=>({...a,name:e.target.value}))),required:!0,placeholder:"Venezia Centro"})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Código"),r.createElement(N.A,{value:n.code,onChange:e=>s((a=>({...a,code:e.target.value}))),required:!0,placeholder:"VZ-001"}))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Dirección"),r.createElement(N.A,{value:n.address,onChange:e=>s((a=>({...a,address:e.target.value}))),required:!0,placeholder:"Av. Principal 123, Ciudad"})),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Teléfono"),r.createElement(N.A,{value:n.phone,onChange:e=>s((a=>({...a,phone:e.target.value}))),placeholder:"+1 234 567 8900"})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Email"),r.createElement(N.A,{type:"email",value:n.email,onChange:e=>s((a=>({...a,email:e.target.value}))),placeholder:"tienda@venezia.com"}))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Gerente"),r.createElement(N.A,{value:n.manager,onChange:e=>s((a=>({...a,manager:e.target.value}))),placeholder:"Nombre del gerente"})),r.createElement("div",{className:"flex items-center"},r.createElement("input",{type:"checkbox",id:"active",checked:n.active,onChange:e=>s((a=>({...a,active:e.target.checked}))),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),r.createElement("label",{htmlFor:"active",className:"ml-2 block text-sm text-gray-900 dark:text-white"},"Tienda activa")),r.createElement("div",{className:"flex gap-3 pt-4"},r.createElement(h.A,{type:"button",variant:"outline",onClick:t,className:"flex-1"},"Cancelar"),r.createElement(h.A,{type:"submit",className:"flex-1"},e?"Actualizar":"Crear"," Tienda"))))};a.default=()=>{(0,l.zy)();const{success:e,error:a,warning:t}=(0,y.d)(),[s,c]=(0,r.useState)(""),[m,d]=(0,r.useState)("all"),[o,i]=(0,r.useState)("name"),[f,C]=(0,r.useState)("grid"),[T,S]=(0,r.useState)(!1),[_,z]=(0,r.useState)(null),[O,j]=(0,r.useState)(!1),{data:V,loading:L,refetch:$}=(0,v.Wl)("/api/stores"),D=V?.data||V,q=Array.isArray(D)?D:[],F=(0,r.useMemo)((()=>{let e=(Array.isArray(q)?q:[]).filter((e=>{const a=e.name?.toLowerCase().includes(s.toLowerCase())||e.address?.toLowerCase().includes(s.toLowerCase())||e.code?.toLowerCase().includes(s.toLowerCase()),t="all"===m||"active"===m&&e.active||"inactive"===m&&!e.active;return a&&t}));return e.sort(((e,a)=>{switch(o){case"name":return e.name?.localeCompare(a.name)||0;case"sales":return(a.monthly_sales||0)-(e.monthly_sales||0);case"orders":return(a.daily_orders||0)-(e.daily_orders||0);default:return 0}})),e}),[q,s,m,o]),I=(0,r.useMemo)((()=>{const e=Array.isArray(q)?q:[],a=e.length,t=e.filter((e=>e.active)).length;return{total:a,active:t,inactive:a-t,totalSales:e.reduce(((e,a)=>e+(a.monthly_sales||0)),0)}}),[q]),P=e=>{z(e),S(!0)},G=e=>{z(e),j(!0)},M=e=>{console.log("View store:",e)};return L?r.createElement("div",{className:"flex items-center justify-center min-h-96"},r.createElement(p.A,{size:"lg"})):r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},r.createElement("div",null,r.createElement("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white"},"Tiendas"),r.createElement("p",{className:"text-gray-600 dark:text-gray-400"},"Gestiona las sucursales y puntos de venta")),r.createElement(h.A,{onClick:()=>{z(null),S(!0)},className:"flex items-center gap-2"},r.createElement(g.A,{className:"h-4 w-4"}),"Nueva Tienda")),r.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Total Tiendas"),r.createElement("p",{className:"text-2xl font-bold text-gray-900 dark:text-white"},I.total)),r.createElement(n.A,{className:"h-8 w-8 text-blue-600 dark:text-blue-400"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Activas"),r.createElement("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400"},I.active)),r.createElement(u.A,{className:"h-8 w-8 text-green-600 dark:text-green-400"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Inactivas"),r.createElement("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400"},I.inactive)),r.createElement(E.A,{className:"h-8 w-8 text-red-600 dark:text-red-400"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Ventas Totales"),r.createElement("p",{className:"text-2xl font-bold text-gray-900 dark:text-white"},"$",I.totalSales.toFixed(0))),r.createElement(x.A,{className:"h-8 w-8 text-purple-600 dark:text-purple-400"})))),r.createElement("div",{className:"flex flex-col sm:flex-row gap-4"},r.createElement("div",{className:"flex-1"},r.createElement(N.A,{placeholder:"Buscar tiendas...",value:s,onChange:e=>c(e.target.value),className:"w-full"})),r.createElement(b.A,{value:m,onChange:d,className:"w-full sm:w-48"},r.createElement("option",{value:"all"},"Todos los estados"),r.createElement("option",{value:"active"},"Activas"),r.createElement("option",{value:"inactive"},"Inactivas")),r.createElement(b.A,{value:o,onChange:i,className:"w-full sm:w-48"},r.createElement("option",{value:"name"},"Ordenar por nombre"),r.createElement("option",{value:"sales"},"Ordenar por ventas"),r.createElement("option",{value:"orders"},"Ordenar por órdenes"))),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},F.map((e=>r.createElement(w,{key:e.id,store:e,onEdit:P,onDelete:G,onView:M})))),0===F.length&&r.createElement("div",{className:"text-center py-12"},r.createElement(n.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"No se encontraron tiendas")),r.createElement(A,{store:_,isOpen:T,onClose:()=>{S(!1),z(null)},onSave:async t=>{try{const a=_?`/api/stores/${_.id}`:"/api/stores",r=_?"PUT":"POST";if(!(await fetch(a,{method:r,headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)throw new Error("Error al guardar la tienda");e(_?"Tienda actualizada":"Tienda creada",`${t.name} ha sido ${_?"actualizada":"creada"} exitosamente`),S(!1),z(null),$()}catch(e){a("Error",e.message||"Error al guardar la tienda")}}}),r.createElement(k.A,{isOpen:O,onClose:()=>{j(!1),z(null)},title:"Eliminar Tienda"},r.createElement("div",{className:"space-y-4"},r.createElement("p",{className:"text-gray-600 dark:text-gray-400"},"¿Estás seguro de que deseas eliminar la tienda ",r.createElement("strong",null,_?.name),"? Esta acción no se puede deshacer."),r.createElement("div",{className:"flex gap-3"},r.createElement(h.A,{variant:"outline",onClick:()=>{j(!1),z(null)},className:"flex-1"},"Cancelar"),r.createElement(h.A,{variant:"danger",onClick:async()=>{if(_)try{if(!(await fetch(`/api/stores/${_.id}`,{method:"DELETE"})).ok)throw new Error("Error al eliminar la tienda");e("Tienda eliminada",`${_.name} ha sido eliminada`),j(!1),z(null),$()}catch(e){a("Error",e.message||"Error al eliminar la tienda")}},className:"flex-1"},"Eliminar")))))}}}]);