"use strict";(self.webpackChunkvenezia_frontend=self.webpackChunkvenezia_frontend||[]).push([[9001],{69001:function(e,t,a){a.r(t);var r=a(96540),s=a(3385),l=a(78624),n=a(14403),m=a(63322),c=a(37037),i=a(42254),o=a(77117),d=a(89197),u=a(30072),E=a(80794),p=a(45795),x=a(21266),g=a(93823),v=a(67773),f=a(72284),h=a(11562);a(29310),t.default=()=>{const[e,t]=(0,r.useState)([]),[a,y]=(0,r.useState)(!0),[N,w]=(0,r.useState)(""),[b,C]=(0,r.useState)(""),[_,A]=(0,r.useState)(!1),[k,z]=(0,r.useState)(!1),[S,j]=(0,r.useState)(!1),[P,L]=(0,r.useState)(!1),[U,T]=(0,r.useState)(null),[D,q]=(0,r.useState)({email:"",first_name:"",last_name:"",phone:"",address:"",password:"",confirmPassword:"",active:!0}),[O,F]=(0,r.useState)({}),[I,J]=(0,r.useState)(!1);(0,r.useEffect)((()=>{R()}),[]);const R=async()=>{try{const e=await fetch("/api/web_users");if(e.ok){const a=await e.json();t(a)}}catch(e){console.error("Error cargando usuarios web:",e)}finally{y(!1)}},W=e.filter((e=>{const t=e.email.toLowerCase().includes(N.toLowerCase())||e.first_name?.toLowerCase().includes(N.toLowerCase())||e.last_name?.toLowerCase().includes(N.toLowerCase())||e.phone?.includes(N),a=!b||"active"===b&&e.active||"inactive"===b&&!e.active;return t&&a})),$=(e,t)=>{q((a=>({...a,[e]:t}))),O[e]&&F((t=>({...t,[e]:""})))},B=()=>{const e={};return D.email.trim()||(e.email="El email es requerido"),/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(D.email)||(e.email="El email no es válido"),D.first_name.trim()||(e.first_name="El nombre es requerido"),D.last_name.trim()||(e.last_name="El apellido es requerido"),D.phone.trim()||(e.phone="El teléfono es requerido"),(_||D.password)&&(D.password||(e.password="La contraseña es requerida"),D.password.length<6&&(e.password="La contraseña debe tener al menos 6 caracteres"),D.password!==D.confirmPassword&&(e.confirmPassword="Las contraseñas no coinciden")),F(e),0===Object.keys(e).length},G=()=>{q({email:"",first_name:"",last_name:"",phone:"",address:"",password:"",confirmPassword:"",active:!0}),F({})};return a?r.createElement("div",{className:"flex items-center justify-center h-64"},r.createElement(g.A,{size:"lg"})):r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},r.createElement("div",null,r.createElement("h1",{className:"text-2xl font-bold text-gray-900 flex items-center"},r.createElement(l.A,{className:"h-8 w-8 text-venezia-600 mr-3"}),"Gestión de Usuarios Web"),r.createElement("p",{className:"mt-1 text-sm text-gray-500"},"Administra usuarios del sistema web y sus permisos")),r.createElement("button",{onClick:()=>{G(),A(!0)},className:"mt-4 sm:mt-0 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-venezia-600 hover:bg-venezia-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-venezia-500"},r.createElement(n.A,{className:"h-5 w-5 mr-2"}),"Nuevo Usuario")),r.createElement("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200"},r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},r.createElement("div",{className:"relative"},r.createElement(m.A,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),r.createElement("input",{type:"text",placeholder:"Buscar usuarios por email, nombre o teléfono...",value:N,onChange:e=>w(e.target.value),className:"pl-10 block w-full border-gray-300 rounded-md shadow-sm focus:ring-venezia-500 focus:border-venezia-500 sm:text-sm"})),r.createElement("select",{value:b,onChange:e=>C(e.target.value),className:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-venezia-500 focus:border-venezia-500 sm:text-sm"},r.createElement("option",{value:""},"Todos los estados"),r.createElement("option",{value:"active"},"Activos"),r.createElement("option",{value:"inactive"},"Inactivos")),r.createElement("div",{className:"text-sm text-gray-500 flex items-center"},"Total: ",W.length," usuarios"))),r.createElement("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden"},r.createElement("div",{className:"overflow-x-auto"},r.createElement("table",{className:"min-w-full divide-y divide-gray-200"},r.createElement("thead",{className:"bg-gray-50"},r.createElement("tr",null,r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Usuario"),r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contacto"),r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Fecha Registro"),r.createElement("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),r.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},W.map((e=>r.createElement(s.P.tr,{key:e.id,initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50"},r.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},r.createElement("div",{className:"flex items-center"},r.createElement("div",{className:"h-10 w-10 flex-shrink-0"},r.createElement("div",{className:"h-10 w-10 rounded-full bg-venezia-100 flex items-center justify-center"},r.createElement(l.A,{className:"h-5 w-5 text-venezia-600"}))),r.createElement("div",{className:"ml-4"},r.createElement("div",{className:"text-sm font-medium text-gray-900"},e.first_name," ",e.last_name),r.createElement("div",{className:"text-sm text-gray-500"},e.email)))),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},r.createElement("div",{className:"text-sm text-gray-500 space-y-1"},e.phone&&r.createElement("div",{className:"flex items-center"},r.createElement(c.A,{className:"h-4 w-4 mr-1"}),e.phone),e.address&&r.createElement("div",{className:"flex items-center"},r.createElement(i.A,{className:"h-4 w-4 mr-1"}),e.address))),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},r.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(e.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},e.active?r.createElement(r.Fragment,null,r.createElement(o.A,{className:"h-4 w-4 mr-1"}),"Activo"):r.createElement(r.Fragment,null,r.createElement(d.A,{className:"h-4 w-4 mr-1"}),"Inactivo"))),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},e.created_at?new Date(e.created_at).toLocaleDateString():"-"),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2"},r.createElement("button",{onClick:()=>(e=>{T(e),j(!0)})(e),className:"text-venezia-600 hover:text-venezia-900 transition-colors",title:"Ver detalles"},r.createElement(u.A,{className:"h-5 w-5"})),r.createElement("button",{onClick:()=>(e=>{q({email:e.email||"",first_name:e.first_name||"",last_name:e.last_name||"",phone:e.phone||"",address:e.address||"",password:"",confirmPassword:"",active:void 0===e.active||e.active}),T(e),z(!0)})(e),className:"text-blue-600 hover:text-blue-900 transition-colors",title:"Editar"},r.createElement(E.A,{className:"h-5 w-5"})),r.createElement("button",{onClick:()=>(e=>{T(e),L(!0)})(e),className:"text-red-600 hover:text-red-900 transition-colors",title:"Eliminar"},r.createElement(p.A,{className:"h-5 w-5"})))))))),0===W.length&&r.createElement("div",{className:"text-center py-12"},r.createElement(l.A,{className:"mx-auto h-12 w-12 text-gray-400"}),r.createElement("h3",{className:"mt-2 text-sm font-medium text-gray-900"},"No se encontraron usuarios"),r.createElement("p",{className:"mt-1 text-sm text-gray-500"},N||b?"Prueba ajustando los filtros de búsqueda":"Comienza agregando un nuevo usuario")))),r.createElement(v.A,{isOpen:_||k,onClose:()=>{A(!1),z(!1),G(),T(null)},title:_?"Nuevo Usuario Web":"Editar Usuario Web",size:"lg"},r.createElement("div",{className:"space-y-4"},O.general&&r.createElement("div",{className:"bg-red-50 border border-red-200 rounded-md p-4"},r.createElement("p",{className:"text-sm text-red-600"},O.general)),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},r.createElement(h.A,{label:"Email *",type:"email",value:D.email,onChange:e=>$("email",e.target.value),error:O.email,placeholder:"usuario@ejemplo.com"}),r.createElement("div",{className:"flex items-center space-x-2 pt-6"},r.createElement("input",{type:"checkbox",id:"active",checked:D.active,onChange:e=>$("active",e.target.checked),className:"h-4 w-4 text-venezia-600 focus:ring-venezia-500 border-gray-300 rounded"}),r.createElement("label",{htmlFor:"active",className:"text-sm font-medium text-gray-700"},"Usuario activo")),r.createElement(h.A,{label:"Nombre *",value:D.first_name,onChange:e=>$("first_name",e.target.value),error:O.first_name,placeholder:"Juan"}),r.createElement(h.A,{label:"Apellido *",value:D.last_name,onChange:e=>$("last_name",e.target.value),error:O.last_name,placeholder:"Pérez"}),r.createElement(h.A,{label:"Teléfono *",value:D.phone,onChange:e=>$("phone",e.target.value),error:O.phone,placeholder:"+54 11 1234-5678"})),r.createElement(h.A,{label:"Dirección",value:D.address,onChange:e=>$("address",e.target.value),placeholder:"Av. Corrientes 1234, CABA"}),r.createElement("div",{className:"border-t pt-4"},r.createElement("h4",{className:"text-sm font-medium text-gray-900 mb-3 flex items-center"},r.createElement(x.A,{className:"h-4 w-4 mr-2"}),_?"Contraseña *":"Cambiar Contraseña (opcional)"),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},r.createElement(h.A,{label:_?"Contraseña *":"Nueva Contraseña",type:"password",value:D.password,onChange:e=>$("password",e.target.value),error:O.password,placeholder:"Mínimo 6 caracteres"}),r.createElement(h.A,{label:"Confirmar Contraseña",type:"password",value:D.confirmPassword,onChange:e=>$("confirmPassword",e.target.value),error:O.confirmPassword,placeholder:"Repetir contraseña"})))),r.createElement("div",{className:"flex justify-end space-x-3 mt-6"},r.createElement(f.A,{variant:"secondary",onClick:()=>{A(!1),z(!1),G(),T(null)}},"Cancelar"),r.createElement(f.A,{onClick:_?async()=>{if(B()){J(!0);try{const e=await fetch("/web_users/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:D.email,first_name:D.first_name,last_name:D.last_name,phone:D.phone,address:D.address,password:D.password,active:D.active})}),t=await e.json();e.ok&&t.success?(await R(),A(!1),G()):F({general:t.error||"Error al agregar usuario"})}catch(e){console.error("Error:",e),F({general:"Error de conexión"})}finally{J(!1)}}}:async()=>{if(B()){J(!0);try{const e=await fetch(`/web_users/${U.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:D.email,first_name:D.first_name,last_name:D.last_name,phone:D.phone,address:D.address,password:D.password||void 0,active:D.active})}),t=await e.json();e.ok&&t.success?(await R(),z(!1),G(),T(null)):F({general:t.error||"Error al editar usuario"})}catch(e){console.error("Error:",e),F({general:"Error de conexión"})}finally{J(!1)}}},loading:I},_?"Crear Usuario":"Guardar Cambios"))),r.createElement(v.A,{isOpen:S,onClose:()=>{j(!1),T(null)},title:"Detalles del Usuario",size:"lg"},U&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},r.createElement("div",null,r.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Información Personal"),r.createElement("dl",{className:"space-y-3"},r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Nombre Completo"),r.createElement("dd",{className:"text-sm text-gray-900"},U.first_name," ",U.last_name)),r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Email"),r.createElement("dd",{className:"text-sm text-gray-900"},U.email)),r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Estado"),r.createElement("dd",{className:"text-sm"},r.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(U.active?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},U.active?"Activo":"Inactivo"))))),r.createElement("div",null,r.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Información de Contacto"),r.createElement("dl",{className:"space-y-3"},U.phone&&r.createElement("div",{className:"flex items-center"},r.createElement(c.A,{className:"h-5 w-5 text-gray-400 mr-2"}),r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Teléfono"),r.createElement("dd",{className:"text-sm text-gray-900"},U.phone))),U.address&&r.createElement("div",{className:"flex items-center"},r.createElement(i.A,{className:"h-5 w-5 text-gray-400 mr-2"}),r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Dirección"),r.createElement("dd",{className:"text-sm text-gray-900"},U.address))),U.created_at&&r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Fecha de Registro"),r.createElement("dd",{className:"text-sm text-gray-900"},new Date(U.created_at).toLocaleDateString())))))),r.createElement("div",{className:"flex justify-end mt-6"},r.createElement(f.A,{variant:"secondary",onClick:()=>{j(!1),T(null)}},"Cerrar"))),r.createElement(v.A,{isOpen:P,onClose:()=>{L(!1),T(null)},title:"Confirmar Eliminación"},U&&r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-700 mb-4"},"¿Estás seguro de que deseas eliminar al usuario"," ",r.createElement("strong",null,'"',U.first_name," ",U.last_name,'"'),"?"),r.createElement("p",{className:"text-sm text-gray-500"},"Esta acción no se puede deshacer y se eliminará toda la información asociada.")),r.createElement("div",{className:"flex justify-end space-x-3 mt-6"},r.createElement(f.A,{variant:"secondary",onClick:()=>{L(!1),T(null)}},"Cancelar"),r.createElement(f.A,{variant:"danger",onClick:async()=>{J(!0);try{const e=await fetch(`/web_users/${U.id}`,{method:"DELETE"}),t=await e.json();e.ok&&t.success?(await R(),L(!1),T(null)):console.error("Error al eliminar usuario:",t.error)}catch(e){console.error("Error:",e)}finally{J(!1)}},loading:I},"Eliminar Usuario"))))}}}]);