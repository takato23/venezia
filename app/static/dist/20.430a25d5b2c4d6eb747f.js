"use strict";(self.webpackChunkvenezia_frontend=self.webpackChunkvenezia_frontend||[]).push([[20],{90020:function(e,t,a){a.r(t),a.d(t,{default:function(){return ae}});var r=a(96540),l=a(29696),n=a(86241),s=a(93893),c=a(17133),m=a(86589),o=a(27375),i=a(50211),d=a(33167),g=a(42021),y=a(94945),x=a(80697),p=a(44471),u=a(27235),E=a(37946),b=a(47392),v=a(76316),N=a(71429),h=a(99229),f=a(98445),k=a(96098),w=a(3160),A=a(39659),C=a(96814),_=a(16308),j=a(70700),S=a(42203),M=a(72284),O=a(11562),L=a(71428),$=a(28219),T=a(10607),z=a(48697),P=a(48852),F=a(67773),I=a(29310),D=a(20053),B=({isOpen:e,date:t,onOpen:a,onClose:l,onCancel:n,expectedCash:s=0})=>{const[c,d]=(0,r.useState)(""),[g,y]=(0,r.useState)({cash_counted:"",card_total:"",other_payments:"",notes:"",denominations:{bills_1000:0,bills_500:0,bills_200:0,bills_100:0,bills_50:0,bills_20:0,bills_10:0,coins:0}}),[x,b]=(0,r.useState)({});(0,r.useEffect)((()=>{if(e){const e=(()=>{const{denominations:e}=g;return 1e3*e.bills_1000+500*e.bills_500+200*e.bills_200+100*e.bills_100+50*e.bills_50+20*e.bills_20+10*e.bills_10+e.coins})();y((t=>({...t,cash_counted:e.toString()})))}}),[g.denominations,e]);const v=parseFloat(g.cash_counted||0)-s,N=Math.abs(v)>10;return r.createElement(F.A,{isOpen:!0,onClose:n,size:"lg"},r.createElement("div",{className:"max-h-[80vh] overflow-y-auto"},r.createElement("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 z-10"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white"},e?"Cierre de Caja":"Apertura de Caja"),r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1"},(0,A.A)(t,"EEEE d 'de' MMMM, yyyy",{locale:_.A}))),r.createElement("button",{onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},r.createElement(z.A,{className:"h-5 w-5"})))),r.createElement("div",{className:"p-6"},e?r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4"},r.createElement("div",{className:"flex items-start gap-3"},r.createElement(p.A,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),r.createElement("div",null,r.createElement("h3",{className:"font-medium text-yellow-900 dark:text-yellow-100"},"Cierre de Caja"),r.createElement("p",{className:"text-sm text-yellow-700 dark:text-yellow-300 mt-1"},"Cuenta el efectivo y registra los totales del día")))),r.createElement("div",{className:"grid grid-cols-2 gap-4"},r.createElement("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4"},r.createElement("div",{className:"text-sm text-gray-500 dark:text-gray-400"},"Efectivo esperado"),r.createElement("div",{className:"text-2xl font-bold text-gray-900 dark:text-white"},"$",s.toLocaleString())),r.createElement("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4"},r.createElement("div",{className:"text-sm text-gray-500 dark:text-gray-400"},"Efectivo contado"),r.createElement("div",{className:"text-2xl font-bold text-gray-900 dark:text-white"},"$",(parseFloat(g.cash_counted)||0).toLocaleString()))),r.createElement("div",null,r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Conteo de Billetes y Monedas"),r.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3"},[{key:"bills_1000",label:"$1000",value:1e3},{key:"bills_500",label:"$500",value:500},{key:"bills_200",label:"$200",value:200},{key:"bills_100",label:"$100",value:100},{key:"bills_50",label:"$50",value:50},{key:"bills_20",label:"$20",value:20},{key:"bills_10",label:"$10",value:10},{key:"coins",label:"Monedas",value:1}].map((e=>r.createElement("div",{key:e.key,className:"space-y-1"},r.createElement("label",{className:"text-sm text-gray-600 dark:text-gray-400"},e.label),r.createElement(O.A,{type:"number",value:g.denominations[e.key],onChange:t=>((e,t)=>{const a=parseInt(t)||0;y((t=>({...t,denominations:{...t.denominations,[e]:a}})))})(e.key,t.target.value),placeholder:"0",min:"0",className:"text-sm"}),r.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400"},"= $",(g.denominations[e.key]*("coins"===e.key?1:e.value)).toLocaleString())))))),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},r.createElement(i.A,{className:"h-4 w-4 inline mr-1"}),"Total en Tarjetas"),r.createElement(O.A,{type:"number",value:g.card_total,onChange:e=>y((t=>({...t,card_total:e.target.value}))),placeholder:"0",min:"0",step:"0.01"})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},r.createElement(o.A,{className:"h-4 w-4 inline mr-1"}),"Otros Pagos"),r.createElement(O.A,{type:"number",value:g.other_payments,onChange:e=>y((t=>({...t,other_payments:e.target.value}))),placeholder:"0",min:"0",step:"0.01"}))),0!==v&&r.createElement("div",{className:(0,D.A)("rounded-lg p-4",N?"bg-red-50 dark:bg-red-900/20":"bg-yellow-50 dark:bg-yellow-900/20")},r.createElement("div",{className:"flex items-start gap-3"},r.createElement(E.A,{className:(0,D.A)("h-5 w-5 mt-0.5",N?"text-red-600 dark:text-red-400":"text-yellow-600 dark:text-yellow-400")}),r.createElement("div",null,r.createElement("h4",{className:(0,D.A)("font-medium",N?"text-red-900 dark:text-red-100":"text-yellow-900 dark:text-yellow-100")},"Diferencia de $",Math.abs(v).toLocaleString()),r.createElement("p",{className:(0,D.A)("text-sm mt-1",N?"text-red-700 dark:text-red-300":"text-yellow-700 dark:text-yellow-300")},"Hay ",v>0?"más":"menos"," efectivo del esperado")))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Observaciones"),r.createElement(I.A,{value:g.notes,onChange:e=>y((t=>({...t,notes:e.target.value}))),placeholder:"Notas sobre el cierre de caja...",rows:3}))):r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4"},r.createElement("div",{className:"flex items-start gap-3"},r.createElement(u.A,{className:"h-5 w-5 text-blue-600 dark:text-blue-400 mt-0.5"}),r.createElement("div",null,r.createElement("h3",{className:"font-medium text-blue-900 dark:text-blue-100"},"Apertura de Caja"),r.createElement("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1"},"Registra el monto inicial de efectivo para comenzar el día")))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Monto de apertura"),r.createElement("div",{className:"relative"},r.createElement(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),r.createElement(O.A,{type:"number",value:c,onChange:e=>d(e.target.value),placeholder:"0",className:"pl-10 text-lg",error:x.openingAmount,min:"0",step:"0.01"}))))),r.createElement("div",{className:"sticky bottom-0 bg-gray-50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-700 px-6 py-4"},r.createElement("div",{className:"flex justify-between items-center"},r.createElement("div",null,e&&0!==v&&r.createElement($.A,{variant:v>0?"success":"danger",size:"lg"},v>0?"+":"",v.toLocaleString()," diferencia")),r.createElement("div",{className:"flex gap-3"},r.createElement(M.A,{variant:"secondary",onClick:n},"Cancelar"),r.createElement(M.A,{variant:"primary",onClick:e?()=>{(()=>{const e={};return(!g.cash_counted||parseFloat(g.cash_counted)<0)&&(e.cash_counted="Ingrese el efectivo contado"),b(e),0===Object.keys(e).length})()&&l({cash_counted:parseFloat(g.cash_counted),card_total:parseFloat(g.card_total)||0,other_payments:parseFloat(g.other_payments)||0,notes:g.notes,denominations:g.denominations})}:()=>{(()=>{const e={};return(!c||parseFloat(c)<0)&&(e.openingAmount="Ingrese un monto válido"),b(e),0===Object.keys(e).length})()&&a(parseFloat(c))}},r.createElement(P.A,{className:"h-4 w-4 mr-2"}),e?"Cerrar Caja":"Abrir Caja"))))))},R=a(6782),q=a(46858),H=a(46816),G=a(13603),V=a(48110),W=({expense:e,onSave:t,onClose:a})=>{const[l,o]=(0,r.useState)({type:"expense",amount:"",description:"",category:"supplier",sub_category:"",payment_method:"cash",provider:"",invoice_number:"",due_date:"",notes:""}),[i,d]=(0,r.useState)({});(0,r.useEffect)((()=>{e&&o({type:"expense",amount:e.amount.toString(),description:e.description||"",category:e.category||"supplier",sub_category:e.sub_category||"",payment_method:e.payment_method||"cash",provider:e.provider||"",invoice_number:e.invoice_number||"",due_date:e.due_date||"",notes:e.notes||""})}),[e]);const g=[{value:"supplier",label:"Proveedores",icon:c.A,subCategories:["Materia prima","Insumos","Envases","Otros"]},{value:"salary",label:"Sueldos",icon:s.A,subCategories:["Salarios","Cargas sociales","Aguinaldo","Vacaciones"]},{value:"rent",label:"Alquiler",icon:R.A,subCategories:["Local comercial","Depósito","Otros"]},{value:"utilities",label:"Servicios",icon:q.A,subCategories:["Electricidad","Gas","Agua","Internet","Teléfono"]},{value:"maintenance",label:"Mantenimiento",icon:H.A,subCategories:["Equipos","Local","Vehículos","Otros"]},{value:"transport",label:"Transporte",icon:G.A,subCategories:["Combustible","Peajes","Estacionamiento","Fletes"]},{value:"marketing",label:"Marketing",icon:V.A,subCategories:["Publicidad","Promociones","Redes sociales","Otros"]},{value:"other",label:"Otros",icon:n.A,subCategories:["Gastos varios","Imprevistos"]}],y=g.find((e=>e.value===l.category)),x=y?.icon||c.A,p=e=>{const{name:t,value:a}=e.target;o((e=>({...e,[t]:a}))),i[t]&&d((e=>({...e,[t]:""}))),"category"===t&&o((e=>({...e,sub_category:""})))};return r.createElement(F.A,{isOpen:!0,onClose:a,size:"lg"},r.createElement("form",{onSubmit:e=>{e.preventDefault(),(()=>{const e={};return(!l.amount||parseFloat(l.amount)<=0)&&(e.amount="Ingrese un monto válido"),l.description.trim()||(e.description="La descripción es requerida"),l.category||(e.category="Seleccione una categoría"),d(e),0===Object.keys(e).length})()&&t({...l,amount:parseFloat(l.amount)})}},r.createElement("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 z-10"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:"p-2 rounded-lg bg-red-100 dark:bg-red-900/20"},r.createElement(n.A,{className:"h-5 w-5 text-red-600 dark:text-red-400"})),r.createElement("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white"},e?"Editar":"Registrar"," Egreso")),r.createElement("button",{type:"button",onClick:a,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},r.createElement(z.A,{className:"h-5 w-5"})))),r.createElement("div",{className:"p-6 space-y-4"},r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Monto *"),r.createElement("div",{className:"relative"},r.createElement(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),r.createElement(O.A,{type:"number",name:"amount",value:l.amount,onChange:p,placeholder:"0.00",className:"pl-10",error:i.amount,min:"0.01",step:"0.01"}))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Método de Pago"),r.createElement(L.A,{name:"payment_method",value:l.payment_method,onChange:p},[{value:"cash",label:"Efectivo"},{value:"card",label:"Tarjeta"},{value:"transfer",label:"Transferencia"},{value:"check",label:"Cheque"}].map((e=>r.createElement("option",{key:e.value,value:e.value},e.label)))))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Descripción *"),r.createElement(O.A,{name:"description",value:l.description,onChange:p,placeholder:"Ej: Compra de insumos, Pago de servicios...",error:i.description})),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Categoría *"),r.createElement(L.A,{name:"category",value:l.category,onChange:p,error:i.category},g.map((e=>r.createElement("option",{key:e.value,value:e.value},e.label))))),y?.subCategories&&r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Subcategoría"),r.createElement(L.A,{name:"sub_category",value:l.sub_category,onChange:p},r.createElement("option",{value:""},"Seleccionar..."),y.subCategories.map((e=>r.createElement("option",{key:e,value:e},e)))))),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Proveedor/Beneficiario"),r.createElement(O.A,{name:"provider",value:l.provider,onChange:p,placeholder:"Nombre del proveedor o beneficiario"})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Número de Factura/Comprobante"),r.createElement(O.A,{name:"invoice_number",value:l.invoice_number,onChange:p,placeholder:"Ej: FC-A-0001-00012345"}))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Fecha de vencimiento (si aplica)"),r.createElement(O.A,{type:"date",name:"due_date",value:l.due_date,onChange:p,min:(new Date).toISOString().split("T")[0]})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Notas adicionales"),r.createElement(I.A,{name:"notes",value:l.notes,onChange:p,placeholder:"Información adicional sobre el gasto...",rows:3}))),r.createElement("div",{className:"sticky bottom-0 bg-gray-50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-700 px-6 py-4"},r.createElement("div",{className:"flex justify-between items-center"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(x,{className:"h-5 w-5 text-gray-400"}),r.createElement("span",{className:"text-sm text-gray-600 dark:text-gray-400"},y?.label)),r.createElement("div",{className:"flex gap-3"},r.createElement(M.A,{type:"button",variant:"secondary",onClick:a},"Cancelar"),r.createElement(M.A,{type:"submit",variant:"danger"},r.createElement(P.A,{className:"h-4 w-4 mr-2"}),e?"Actualizar":"Registrar"," Egreso"))))))},J=a(80827),U=({type:e="income",movement:t,onSave:a,onClose:n})=>{const[s,g]=(0,r.useState)({type:e,amount:"",description:"",category:"income"===e?"sales":"expense",payment_method:"cash",reference:"",notes:""}),[y,x]=(0,r.useState)({});(0,r.useEffect)((()=>{t&&g({type:t.type,amount:t.amount.toString(),description:t.description||"",category:t.category||("income"===e?"sales":"expense"),payment_method:t.payment_method||"cash",reference:t.reference||"",notes:t.notes||""})}),[t,e]);const p=[{value:"sales",label:"Ventas",icon:l.A},{value:"service",label:"Servicios",icon:c.A},{value:"other",label:"Otros Ingresos",icon:m.A}],u=[{value:"cash",label:"Efectivo",icon:o.A},{value:"card",label:"Tarjeta",icon:i.A},{value:"transfer",label:"Transferencia",icon:d.A},{value:"check",label:"Cheque",icon:J.A}],E=e=>{const{name:t,value:a}=e.target;g((e=>({...e,[t]:a}))),y[t]&&x((e=>({...e,[t]:""})))},b="income"===s.type;return r.createElement(F.A,{isOpen:!0,onClose:n,size:"md"},r.createElement("form",{onSubmit:e=>{e.preventDefault(),(()=>{const e={};return(!s.amount||parseFloat(s.amount)<=0)&&(e.amount="Ingrese un monto válido"),s.description.trim()||(e.description="La descripción es requerida"),x(e),0===Object.keys(e).length})()&&a({...s,amount:parseFloat(s.amount)})}},r.createElement("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 z-10"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white"},t?"Editar":"Registrar"," ",b?"Ingreso":"Egreso"),r.createElement("button",{type:"button",onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},r.createElement(z.A,{className:"h-5 w-5"})))),r.createElement("div",{className:"p-6 space-y-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Monto *"),r.createElement("div",{className:"relative"},r.createElement(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),r.createElement(O.A,{type:"number",name:"amount",value:s.amount,onChange:E,placeholder:"0.00",className:"pl-10",error:y.amount,min:"0.01",step:"0.01"}))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Descripción *"),r.createElement(O.A,{name:"description",value:s.description,onChange:E,placeholder:b?"Ej: Venta de productos":"Ej: Pago a proveedor",error:y.description})),b&&r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Categoría"),r.createElement(L.A,{name:"category",value:s.category,onChange:E},p.map((e=>r.createElement("option",{key:e.value,value:e.value},e.label))))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Método de Pago"),r.createElement(L.A,{name:"payment_method",value:s.payment_method,onChange:E},u.map((e=>r.createElement("option",{key:e.value,value:e.value},e.label))))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Referencia"),r.createElement(O.A,{name:"reference",value:s.reference,onChange:E,placeholder:b?"Ej: Factura #1234":"Ej: Orden de compra #5678"})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Notas adicionales"),r.createElement(I.A,{name:"notes",value:s.notes,onChange:E,placeholder:"Información adicional...",rows:3}))),r.createElement("div",{className:"sticky bottom-0 bg-gray-50 dark:bg-gray-900/50 border-t border-gray-200 dark:border-gray-700 px-6 py-4"},r.createElement("div",{className:"flex justify-end gap-3"},r.createElement(M.A,{type:"button",variant:"secondary",onClick:n},"Cancelar"),r.createElement(M.A,{type:"submit",variant:b?"success":"primary"},r.createElement(P.A,{className:"h-4 w-4 mr-2"}),t?"Actualizar":"Registrar"," ",b?"Ingreso":"Egreso")))))},K=a(89369),Q=a(48309),X=a(50205),Y=a(48234),Z=a(44731),ee=a(66118);ee.t1.register(ee.Bs,ee.PP,ee.kc,ee.E8,ee.hE,ee.m_,ee.s$);var te=({date:e,summary:t,movements:a,isOpen:l,onClose:n})=>{const[s,c]=(0,r.useState)("summary"),o=a.filter((e=>"expense"===e.type)).reduce(((e,t)=>{const a=t.category||"other";return e[a]=(e[a]||0)+t.amount,e}),{}),i=a.filter((e=>"income"===e.type)).reduce(((e,t)=>{const a=t.payment_method||"cash";return e[a]=(e[a]||0)+t.amount,e}),{}),d={labels:Object.keys(o).map((e=>({supplier:"Proveedores",salary:"Sueldos",rent:"Alquiler",utilities:"Servicios",maintenance:"Mantenimiento",transport:"Transporte",marketing:"Marketing",other:"Otros"}[e]||e))),datasets:[{data:Object.values(o),backgroundColor:["#3B82F6","#10B981","#F59E0B","#EF4444","#8B5CF6","#EC4899","#14B8A6","#6B7280"],borderWidth:0}]},g={labels:Object.keys(i).map((e=>({cash:"Efectivo",card:"Tarjeta",transfer:"Transferencia",check:"Cheque"}[e]||e))),datasets:[{label:"Ingresos",data:Object.values(i),backgroundColor:"#10B981",borderWidth:0}]},x={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:10,font:{size:12}}}}};return r.createElement(F.A,{isOpen:l,onClose:n,size:"xl"},r.createElement("div",{className:"max-h-[80vh] overflow-y-auto"},r.createElement("div",{className:"sticky top-0 bg-white dark:bg-gray-800 border-b border-gray-200 dark:border-gray-700 px-6 py-4 z-10"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("h2",{className:"text-xl font-semibold text-gray-900 dark:text-white"},"Reporte de Caja Diaria"),r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1"},(0,A.A)(e,"EEEE d 'de' MMMM, yyyy",{locale:_.A}))),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(M.A,{variant:"secondary",size:"sm",onClick:()=>{window.print()}},r.createElement(K.A,{className:"h-4 w-4 mr-1"}),"Imprimir"),r.createElement(M.A,{variant:"secondary",size:"sm",onClick:()=>{console.log("Exportando reporte en formato pdf")}},r.createElement(Q.A,{className:"h-4 w-4 mr-1"}),"PDF"),r.createElement(M.A,{variant:"secondary",size:"sm",onClick:()=>{console.log("Compartiendo reporte por email")}},r.createElement(X.A,{className:"h-4 w-4 mr-1"}),"Compartir"),r.createElement("button",{onClick:n,className:"p-1 text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},r.createElement(z.A,{className:"h-5 w-5"}))))),r.createElement("div",{className:"border-b border-gray-200 dark:border-gray-700"},r.createElement("nav",{className:"flex space-x-8 px-6","aria-label":"Tabs"},[{id:"summary",label:"Resumen",icon:y.A},{id:"movements",label:"Movimientos",icon:J.A},{id:"charts",label:"Gráficos",icon:Y.A}].map((e=>r.createElement("button",{key:e.id,onClick:()=>c(e.id),className:(0,D.A)("py-3 px-1 border-b-2 font-medium text-sm transition-colors flex items-center gap-2",s===e.id?"border-blue-500 text-blue-600 dark:text-blue-400":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 dark:text-gray-400 dark:hover:text-gray-300")},r.createElement(e.icon,{className:"h-4 w-4"}),e.label))))),r.createElement("div",{className:"p-6"},"summary"===s&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4"},r.createElement("div",{className:"bg-gray-50 dark:bg-gray-900/50 rounded-lg p-4"},r.createElement("div",{className:"flex items-center gap-2 mb-2"},r.createElement(m.A,{className:"h-5 w-5 text-gray-400"}),r.createElement("span",{className:"text-sm text-gray-500 dark:text-gray-400"},"Apertura")),r.createElement("div",{className:"text-2xl font-bold text-gray-900 dark:text-white"},"$",t.openingCash.toLocaleString())),r.createElement("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4"},r.createElement("div",{className:"flex items-center gap-2 mb-2"},r.createElement(v.A,{className:"h-5 w-5 text-green-500"}),r.createElement("span",{className:"text-sm text-gray-500 dark:text-gray-400"},"Ingresos")),r.createElement("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400"},"+$",t.income.toLocaleString())),r.createElement("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4"},r.createElement("div",{className:"flex items-center gap-2 mb-2"},r.createElement(N.A,{className:"h-5 w-5 text-red-500"}),r.createElement("span",{className:"text-sm text-gray-500 dark:text-gray-400"},"Egresos")),r.createElement("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400"},"-$",t.expenses.toLocaleString())),r.createElement("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4"},r.createElement("div",{className:"flex items-center gap-2 mb-2"},r.createElement(m.A,{className:"h-5 w-5 text-blue-500"}),r.createElement("span",{className:"text-sm text-gray-500 dark:text-gray-400"},"Cierre")),r.createElement("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400"},"$",t.actualCash.toLocaleString()))),r.createElement("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Balance del Día"),r.createElement("div",{className:"space-y-3"},r.createElement("div",{className:"flex justify-between items-center py-2"},r.createElement("span",{className:"text-gray-600 dark:text-gray-400"},"Efectivo inicial"),r.createElement("span",{className:"font-medium text-gray-900 dark:text-white"},"$",t.openingCash.toLocaleString())),r.createElement("div",{className:"flex justify-between items-center py-2"},r.createElement("span",{className:"text-gray-600 dark:text-gray-400"},"Total ingresos"),r.createElement("span",{className:"font-medium text-green-600 dark:text-green-400"},"+$",t.income.toLocaleString())),r.createElement("div",{className:"flex justify-between items-center py-2"},r.createElement("span",{className:"text-gray-600 dark:text-gray-400"},"Total egresos"),r.createElement("span",{className:"font-medium text-red-600 dark:text-red-400"},"-$",t.expenses.toLocaleString())),r.createElement("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-3"},r.createElement("div",{className:"flex justify-between items-center"},r.createElement("span",{className:"font-medium text-gray-900 dark:text-white"},"Efectivo esperado"),r.createElement("span",{className:"text-lg font-bold text-gray-900 dark:text-white"},"$",t.expectedCash.toLocaleString()))),r.createElement("div",{className:"flex justify-between items-center py-2"},r.createElement("span",{className:"text-gray-600 dark:text-gray-400"},"Efectivo contado"),r.createElement("span",{className:"font-medium text-gray-900 dark:text-white"},"$",t.actualCash.toLocaleString())),0!==t.difference&&r.createElement("div",{className:"flex justify-between items-center py-2 bg-gray-50 dark:bg-gray-900/50 px-3 rounded"},r.createElement("span",{className:"text-gray-600 dark:text-gray-400"},"Diferencia"),r.createElement($.A,{variant:t.difference>0?"success":"danger",size:"lg"},t.difference>0?"+":"",t.difference.toLocaleString())))),r.createElement("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Métodos de Pago"),r.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4"},Object.entries(t.paymentMethods).map((([e,t])=>r.createElement("div",{key:e,className:"text-center"},r.createElement("div",{className:"text-2xl font-bold text-gray-900 dark:text-white"},"$",t.toLocaleString()),r.createElement("div",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize"},"cash"===e?"Efectivo":"card"===e?"Tarjeta":"transfer"===e?"Transferencia":e))))))),"movements"===s&&r.createElement("div",{className:"space-y-4"},r.createElement("div",{className:"flex justify-between items-center mb-4"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white"},"Detalle de Movimientos"),r.createElement($.A,{variant:"gray"},a.length," movimientos")),r.createElement("div",{className:"space-y-2"},a.map(((e,t)=>r.createElement("div",{key:e.id||t,className:"flex items-center justify-between p-4 bg-gray-50 dark:bg-gray-900/50 rounded-lg"},r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:(0,D.A)("p-2 rounded-lg","income"===e.type?"bg-green-100 dark:bg-green-900/20":"bg-red-100 dark:bg-red-900/20")},"income"===e.type?r.createElement(v.A,{className:"h-4 w-4 text-green-600 dark:text-green-400"}):r.createElement(N.A,{className:"h-4 w-4 text-red-600 dark:text-red-400"})),r.createElement("div",null,r.createElement("div",{className:"font-medium text-gray-900 dark:text-white"},e.description),r.createElement("div",{className:"text-sm text-gray-500 dark:text-gray-400"},(0,A.A)(new Date(e.created_at),"HH:mm")," -",e.category," -","cash"===e.payment_method?"Efectivo":"card"===e.payment_method?"Tarjeta":e.payment_method))),r.createElement("div",{className:(0,D.A)("text-lg font-medium","income"===e.type?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")},"income"===e.type?"+":"-","$",e.amount.toLocaleString())))))),"charts"===s&&r.createElement("div",{className:"space-y-6"},Object.keys(o).length>0&&r.createElement("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Egresos por Categoría"),r.createElement("div",{className:"h-64"},r.createElement(Z.nu,{data:d,options:x}))),Object.keys(i).length>0&&r.createElement("div",{className:"bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg p-6"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Ingresos por Método de Pago"),r.createElement("div",{className:"h-64"},r.createElement(Z.yP,{data:g,options:x})))))))},ae=()=>{const[e,t]=(0,r.useState)(new Date),[a,z]=(0,r.useState)("all"),[P,F]=(0,r.useState)(""),[I,R]=(0,r.useState)(!1),[q,H]=(0,r.useState)(!1),[G,V]=(0,r.useState)(!1),[J,K]=(0,r.useState)(!1),[Q,X]=(0,r.useState)(null),[Y,Z]=(0,r.useState)(null),{success:ee,error:ae,warning:re}=(0,S.d)(),le=(0,A.A)(e,"yyyy-MM-dd"),{data:ne,loading:se,refetch:ce}=(0,j.Wl)(`/api/cashflow?date=${le}`),{data:me,refetch:oe}=(0,j.Wl)(`/api/cashflow/status?date=${le}`);(0,r.useEffect)((()=>{me&&Z(me)}),[me]);const ie=(0,r.useMemo)((()=>{if(!ne)return null;const e=ne.movements||[],t=e.filter((e=>"income"===e.type)).reduce(((e,t)=>e+t.amount),0),a=e.filter((e=>"expense"===e.type)).reduce(((e,t)=>e+t.amount),0),r=t-a,l=ne.opening_cash||0,n=l+r,s=ne.closing_cash||n;return{income:t,expenses:a,balance:r,openingCash:l,expectedCash:n,actualCash:s,difference:s-n,paymentMethods:e.reduce(((e,t)=>{if("income"===t.type){const a=t.payment_method||"cash";e[a]=(e[a]||0)+t.amount}return e}),{}),movementCount:e.length}}),[ne]),de=(0,r.useMemo)((()=>{if(!ne?.movements)return[];let e=[...ne.movements];return"all"!==a&&(e=e.filter((e=>e.type===a))),P&&(e=e.filter((e=>e.description.toLowerCase().includes(P.toLowerCase())||e.category?.toLowerCase().includes(P.toLowerCase())||e.reference?.toLowerCase().includes(P.toLowerCase())))),e.sort(((e,t)=>new Date(t.created_at)-new Date(e.created_at))),e}),[ne,a,P]),ge=async e=>{try{const t=Q?`/api/cashflow/movements/${Q.id}`:"/api/cashflow/movements",a=Q?"PUT":"POST";if(!(await fetch(t,{method:a,headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,date:le})})).ok)throw new Error("Error al guardar movimiento");ee(Q?"Movimiento actualizado":"Movimiento registrado","El movimiento se guardó correctamente"),ce(),V(!1),H(!1),X(null)}catch(e){ae("Error","No se pudo guardar el movimiento")}},ye=e=>({cash:o.A,card:i.A,transfer:d.A,check:g.A}[e]||m.A);if(se&&!ne)return r.createElement(T.A,{message:"Cargando información de caja..."});const xe="open"===Y?.status,pe="closed"===Y?.status,ue=xe&&(0,C.A)(e);return r.createElement("div",{className:"page-container"},r.createElement("div",{className:"page-header"},r.createElement("div",null,r.createElement("h1",{className:"page-title"},"Control de Caja"),r.createElement("p",{className:"page-subtitle"},"Gestión de ingresos, egresos y flujo de efectivo")),r.createElement("div",{className:"flex gap-3"},r.createElement(M.A,{variant:"secondary",onClick:()=>K(!0),disabled:!ie},r.createElement(y.A,{className:"h-4 w-4 mr-2"}),"Ver Reporte"),!xe&&(0,C.A)(e)&&r.createElement(M.A,{variant:"primary",onClick:()=>R(!0)},r.createElement(x.A,{className:"h-4 w-4 mr-2"}),"Abrir Caja"),xe&&(0,C.A)(e)&&r.createElement(M.A,{variant:"warning",onClick:()=>R(!0)},r.createElement(p.A,{className:"h-4 w-4 mr-2"}),"Cerrar Caja"))),r.createElement("div",{className:"flex flex-wrap items-center justify-between gap-4 mb-6"},r.createElement("div",{className:"flex items-center gap-4"},r.createElement(O.A,{type:"date",value:(0,A.A)(e,"yyyy-MM-dd"),onChange:e=>t(new Date(e.target.value)),max:(0,A.A)(new Date,"yyyy-MM-dd"),className:"w-48"}),r.createElement("div",{className:"flex items-center gap-2"},r.createElement("span",{className:"text-sm text-gray-500 dark:text-gray-400"},"Estado:"),xe&&r.createElement($.A,{variant:"success"},r.createElement(u.A,{className:"h-3 w-3 mr-1"}),"Caja Abierta"),pe&&r.createElement($.A,{variant:"gray"},r.createElement(p.A,{className:"h-3 w-3 mr-1"}),"Caja Cerrada"),!Y&&r.createElement($.A,{variant:"warning"},r.createElement(E.A,{className:"h-3 w-3 mr-1"}),"Sin Apertura"))),ue&&r.createElement("div",{className:"flex gap-2"},r.createElement(M.A,{variant:"success",size:"sm",onClick:()=>{X(null),V(!0)}},r.createElement(x.A,{className:"h-4 w-4 mr-1"}),"Ingreso"),r.createElement(M.A,{variant:"danger",size:"sm",onClick:()=>{X(null),H(!0)}},r.createElement(n.A,{className:"h-4 w-4 mr-1"}),"Egreso"))),ie&&r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4 mb-6"},r.createElement("div",{className:"stat-card"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement(b.A,{className:"h-5 w-5 text-gray-400"}),r.createElement("span",{className:"text-xs text-gray-500"},"Apertura")),r.createElement("div",{className:"text-2xl font-bold text-gray-900 dark:text-white"},"$",ie.openingCash.toLocaleString()),r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},"Efectivo inicial")),r.createElement("div",{className:"stat-card"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement(v.A,{className:"h-5 w-5 text-green-500"}),r.createElement("span",{className:"text-xs text-gray-500"},"Ingresos")),r.createElement("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400"},"+$",ie.income.toLocaleString()),r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},"Total ingresos")),r.createElement("div",{className:"stat-card"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement(N.A,{className:"h-5 w-5 text-red-500"}),r.createElement("span",{className:"text-xs text-gray-500"},"Egresos")),r.createElement("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400"},"-$",ie.expenses.toLocaleString()),r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},"Total egresos")),r.createElement("div",{className:"stat-card"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement(h.A,{className:"h-5 w-5 text-blue-500"}),r.createElement("span",{className:"text-xs text-gray-500"},"Balance")),r.createElement("div",{className:(0,D.A)("text-2xl font-bold",ie.balance>=0?"text-blue-600 dark:text-blue-400":"text-red-600 dark:text-red-400")},"$",Math.abs(ie.balance).toLocaleString()),r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},ie.balance>=0?"Ganancia":"Pérdida"," del día")),r.createElement("div",{className:"stat-card"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement(m.A,{className:"h-5 w-5 text-purple-500"}),r.createElement("span",{className:"text-xs text-gray-500"},"Cierre")),r.createElement("div",{className:"text-2xl font-bold text-gray-900 dark:text-white"},"$",ie.actualCash.toLocaleString()),r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},pe?"Efectivo final":"Esperado"),0!==ie.difference&&pe&&r.createElement("div",{className:(0,D.A)("text-xs mt-1",ie.difference>0?"text-green-600":"text-red-600")},ie.difference>0?"+":"",ie.difference.toLocaleString()," diferencia"))),ie&&Object.keys(ie.paymentMethods).length>0&&r.createElement("div",{className:"card p-4 mb-6"},r.createElement("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},"Ingresos por Método de Pago"),r.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4"},Object.entries(ie.paymentMethods).map((([e,t])=>{const a=ye(e);return r.createElement("div",{key:e,className:"flex items-center gap-3"},r.createElement("div",{className:"p-2 rounded-lg bg-gray-100 dark:bg-gray-700"},r.createElement(a,{className:"h-4 w-4 text-gray-600 dark:text-gray-300"})),r.createElement("div",null,r.createElement("div",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize"},"cash"===e?"Efectivo":"card"===e?"Tarjeta":e),r.createElement("div",{className:"font-medium text-gray-900 dark:text-white"},"$",t.toLocaleString())))})))),r.createElement("div",{className:"card p-4 mb-6"},r.createElement("div",{className:"flex flex-wrap gap-4"},r.createElement("div",{className:"flex-1 min-w-[200px]"},r.createElement("div",{className:"relative"},r.createElement(f.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),r.createElement(O.A,{type:"text",placeholder:"Buscar movimiento...",value:P,onChange:e=>F(e.target.value),className:"pl-10"}))),r.createElement(L.A,{value:a,onChange:e=>z(e.target.value),className:"w-48"},r.createElement("option",{value:"all"},"Todos los movimientos"),r.createElement("option",{value:"income"},"Solo ingresos"),r.createElement("option",{value:"expense"},"Solo egresos")))),r.createElement("div",{className:"card overflow-hidden"},r.createElement("div",{className:"overflow-x-auto"},r.createElement("table",{className:"w-full"},r.createElement("thead",null,r.createElement("tr",{className:"border-b border-gray-200 dark:border-gray-700"},r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Hora"),r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Descripción"),r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Categoría"),r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Método"),r.createElement("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Monto"),r.createElement("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider"},"Acciones"))),r.createElement("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},de.map((e=>{const t="income"===e.type,a=(o=e.category,{sales:l.A,expense:n.A,salary:s.A,supplier:c.A,other:m.A}[o]||m.A);var o;const i=ye(e.payment_method);return r.createElement("tr",{key:e.id,className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},r.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400"},(0,A.A)(new Date(e.created_at),"HH:mm",{locale:_.A})),r.createElement("td",{className:"px-6 py-4"},r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:(0,D.A)("p-2 rounded-lg",t?"bg-green-100 dark:bg-green-900/20":"bg-red-100 dark:bg-red-900/20")},t?r.createElement(d.A,{className:"h-4 w-4 text-green-600 dark:text-green-400"}):r.createElement(k.A,{className:"h-4 w-4 text-red-600 dark:text-red-400"})),r.createElement("div",null,r.createElement("div",{className:"text-sm font-medium text-gray-900 dark:text-white"},e.description),e.reference&&r.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400"},"Ref: ",e.reference)))),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(a,{className:"h-4 w-4 text-gray-400"}),r.createElement("span",{className:"text-sm text-gray-900 dark:text-white capitalize"},e.category))),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(i,{className:"h-4 w-4 text-gray-400"}),r.createElement("span",{className:"text-sm text-gray-500 dark:text-gray-400 capitalize"},"cash"===e.payment_method?"Efectivo":"card"===e.payment_method?"Tarjeta":e.payment_method))),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-right"},r.createElement("span",{className:(0,D.A)("text-sm font-medium",t?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400")},t?"+":"-","$",e.amount.toLocaleString())),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},r.createElement("button",{onClick:()=>{X(e),"income"===e.type?V(!0):H(!0)},className:"text-blue-600 hover:text-blue-900 dark:text-blue-400 dark:hover:text-blue-300",disabled:!ue},r.createElement(w.A,{className:"h-4 w-4"}))))})))),0===de.length&&r.createElement("div",{className:"text-center py-12"},r.createElement(g.A,{className:"h-12 w-12 text-gray-300 dark:text-gray-600 mx-auto mb-3"}),r.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"No hay movimientos registrados")))),I&&r.createElement(B,{isOpen:xe,date:e,onOpen:async e=>{try{if(!(await fetch("/api/cashflow/open",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:le,opening_amount:e})})).ok)throw new Error("Error al abrir caja");ee("Caja abierta",`Caja abierta con $${e.toLocaleString()}`),ce(),oe(),R(!1)}catch(e){ae("Error","No se pudo abrir la caja")}},onClose:async e=>{try{if(!(await fetch("/api/cashflow/close",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({date:le,...e})})).ok)throw new Error("Error al cerrar caja");ee("Caja cerrada","El cierre de caja se realizó correctamente"),ce(),oe(),R(!1),K(!0)}catch(e){ae("Error","No se pudo cerrar la caja")}},onCancel:()=>R(!1),expectedCash:ie?.expectedCash}),G&&r.createElement(U,{type:"income",movement:Q,onSave:ge,onClose:()=>{V(!1),X(null)}}),q&&r.createElement(W,{expense:Q,onSave:ge,onClose:()=>{H(!1),X(null)}}),J&&ie&&r.createElement(te,{date:e,summary:ie,movements:ne?.movements||[],isOpen:J,onClose:()=>K(!1)}))}}}]);