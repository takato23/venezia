"use strict";(self.webpackChunkvenezia_frontend=self.webpackChunkvenezia_frontend||[]).push([[2076],{3802:function(e,a,t){var n=t(96540),r=t(17133),o=t(90232),s=t(37946),i=t(48697),c=t(40073),l=t(48686),d=t(32307),m=t(80697),u=t(44471),g=t(72284),p=t(11562),h=t(71428),b=t(28219);a.A=({order:e,onAssignBatch:a,onCancel:t,users:v=[],existingBatches:y=[]})=>{const[x,f]=(0,n.useState)((()=>{if(y.length>0)return y;const a=`L${(new Date).getFullYear()}-${String(Date.now()).slice(-6)}`;return[{id:Date.now(),batch_number:a,quantity:e.quantity||1,assigned_to:"",start_date:(new Date).toISOString().split("T")[0],notes:"",status:"pending"}]})),[k,E]=(0,n.useState)({}),[A,w]=(0,n.useState)(!1),N=x.reduce(((e,a)=>e+(parseFloat(a.quantity)||0)),0),C=e.quantity-N,_=(e,a,t)=>{f((n=>n.map(((n,r)=>r===e?{...n,[a]:t}:n))));const n=`batch_${e}_${a}`;k[n]&&E((e=>({...e,[n]:""})))};return n.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700 p-6"},n.createElement("div",{className:"mb-6"},n.createElement("div",{className:"flex items-center justify-between"},n.createElement("div",null,n.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center gap-2"},n.createElement(r.A,{className:"w-5 h-5"}),"Asignación de Lotes"),n.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"Orden #",e.order_number||e.id," - ",e.recipe?.name||e.product_name)),t&&n.createElement(g.A,{variant:"outline",size:"sm",icon:o.A,onClick:t,className:"text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white"},"Volver"))),k.general&&n.createElement("div",{className:"mb-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3"},n.createElement("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-300"},n.createElement(s.A,{className:"w-4 h-4"}),n.createElement("span",{className:"text-sm"},k.general))),n.createElement("div",{className:"mb-6 p-4 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},n.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4"},n.createElement("div",null,n.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Cantidad Total"),n.createElement("p",{className:"font-medium text-gray-900 dark:text-white"},e.quantity," ",e.unit)),n.createElement("div",null,n.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Cantidad Asignada"),n.createElement("p",{className:"font-medium "+(Math.abs(N-e.quantity)<.01?"text-green-600 dark:text-green-400":"text-yellow-600 dark:text-yellow-400")},N," ",e.unit)),n.createElement("div",null,n.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Cantidad Restante"),n.createElement("p",{className:"font-medium "+(0===C?"text-gray-500 dark:text-gray-400":"text-red-600 dark:text-red-400")},C.toFixed(2)," ",e.unit)),n.createElement("div",null,n.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Número de Lotes"),n.createElement("p",{className:"font-medium text-gray-900 dark:text-white"},x.length)))),n.createElement("div",{className:"space-y-4 mb-6"},x.map(((e,a)=>n.createElement("div",{key:e.id,className:"p-4 border dark:border-gray-700 rounded-lg bg-gray-50 dark:bg-gray-700/30"},n.createElement("div",{className:"flex items-start justify-between mb-3"},n.createElement("h4",{className:"font-medium text-gray-900 dark:text-white"},"Lote ",a+1),x.length>1&&n.createElement(g.A,{variant:"ghost",size:"xs",icon:i.A,onClick:()=>(e=>{f((a=>a.filter(((a,t)=>t!==e))))})(a),className:"text-red-600 hover:text-red-700"})),n.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3"},n.createElement(p.A,{label:"Número de Lote",value:e.batch_number,onChange:e=>_(a,"batch_number",e.target.value),placeholder:"Ej: L2024-001",error:k[`batch_${a}_batch_number`],icon:c.A,required:!0}),n.createElement(p.A,{label:"Cantidad",type:"number",step:"0.01",value:e.quantity,onChange:e=>_(a,"quantity",e.target.value),error:k[`batch_${a}_quantity`],required:!0}),n.createElement(h.A,{label:"Responsable",value:e.assigned_to,onChange:e=>_(a,"assigned_to",e.target.value),options:[{value:"",label:"Seleccionar"},...v.map((e=>({value:e.id||e.name,label:e.name||e.email})))],error:k[`batch_${a}_assigned_to`],icon:l.A,required:!0}),n.createElement(p.A,{label:"Fecha de Inicio",type:"date",value:e.start_date,onChange:e=>_(a,"start_date",e.target.value),error:k[`batch_${a}_start_date`],icon:d.A,min:(new Date).toISOString().split("T")[0],required:!0})),n.createElement("div",{className:"mt-3"},n.createElement(p.A,{label:"Notas",value:e.notes,onChange:e=>_(a,"notes",e.target.value),placeholder:"Notas o instrucciones especiales para este lote (opcional)"})),"pending"!==e.status&&n.createElement("div",{className:"mt-3"},n.createElement(b.A,{variant:"completed"===e.status?"success":"in_progress"===e.status?"warning":"default",size:"sm"},"completed"===e.status?"Completado":"in_progress"===e.status?"En Proceso":"Pendiente")))))),n.createElement("div",{className:"flex justify-between items-center"},n.createElement("div",{className:"flex items-center gap-2"},n.createElement(g.A,{variant:"outline",size:"sm",icon:m.A,onClick:()=>{const e=`L${(new Date).getFullYear()}-${String(Date.now()+1e3*Math.random()).slice(-6)}`;f((a=>[...a,{id:Date.now()+Math.random(),batch_number:e,quantity:C>0?C:1,assigned_to:"",start_date:(new Date).toISOString().split("T")[0],notes:"",status:"pending"}]))},disabled:C<=0},"Agregar Lote"),C>0&&n.createElement("span",{className:"text-sm text-yellow-600 dark:text-yellow-400"},"⚠️ Faltan ",C.toFixed(2)," ",e.unit," por asignar")),n.createElement("div",{className:"flex items-center gap-2"},0===C&&n.createElement("span",{className:"text-sm text-green-600 dark:text-green-400 flex items-center gap-1"},n.createElement(u.A,{className:"w-4 h-4"}),"Cantidad completa"),n.createElement(g.A,{variant:"primary",icon:u.A,onClick:async()=>{if((()=>{const a={};let t=!0;0===x.length&&(a.general="Debe agregar al menos un lote",t=!1),x.forEach(((e,n)=>{e.batch_number&&e.batch_number.trim()||(a[`batch_${n}_batch_number`]="El número de lote es requerido",t=!1);const r=parseFloat(e.quantity);(isNaN(r)||r<=0)&&(a[`batch_${n}_quantity`]="La cantidad debe ser un número mayor a 0",t=!1),e.assigned_to&&e.assigned_to.trim()||(a[`batch_${n}_assigned_to`]="Debe asignar un responsable",t=!1),e.start_date||(a[`batch_${n}_start_date`]="La fecha de inicio es requerida",t=!1)}));const n=x.reduce(((e,a)=>{const t=parseFloat(a.quantity);return e+(isNaN(t)?0:t)}),0);return Math.abs(n-e.quantity)>.01&&(a.general=`La cantidad total asignada (${n.toFixed(2)}) no coincide con la cantidad de la orden (${e.quantity})`,t=!1),E(a),t})()){w(!0);try{const t=x.map((e=>({batch_number:e.batch_number.trim(),quantity:parseFloat(e.quantity)||0,assigned_to:e.assigned_to||"",start_date:e.start_date||(new Date).toISOString().split("T")[0],notes:e.notes||""})));console.log("Enviando lotes:",{orderId:e.id,batches:t}),await a(e.id,t)}catch(e){console.error("Error assigning batches:",e),E({general:`Error al asignar los lotes: ${e.message||e.toString()}`})}finally{w(!1)}}},loading:A,disabled:0===x.length||A},A?"Asignando...":"Asignar Lotes"))))}},7693:function(e,a,t){var n=t(96540),r=t(59612);a.A=({productName:e,size:a="default",className:t=""})=>{const o=(e=>{if(!e)return"bg-venezia-100 text-venezia-600";const a=["bg-pink-100 text-pink-600","bg-purple-100 text-purple-600","bg-blue-100 text-blue-600","bg-green-100 text-green-600","bg-yellow-100 text-yellow-600","bg-red-100 text-red-600","bg-indigo-100 text-indigo-600","bg-orange-100 text-orange-600"];let t=0;for(let a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t);return a[Math.abs(t)%a.length]})(e);return n.createElement("div",{className:`\n      ${{small:"h-8 w-8",default:"h-12 w-12",large:"h-24 w-24"}[a]}\n      ${o}\n      rounded-lg flex items-center justify-center\n      ${t}\n    `},n.createElement(r.A,{className:{small:"h-4 w-4",default:"h-6 w-6",large:"h-12 w-12"}[a]}))}},10607:function(e,a,t){var n=t(96540),r=t(93823),o=t(37946),s=t(15977),i=t(72284),c=t(20053);a.A=({loading:e=!0,error:a=null,empty:t=!1,onRetry:l,loadingText:d="Cargando...",errorText:m="Error al cargar datos",emptyText:u="No hay datos disponibles",emptyIcon:g,className:p,size:h="default"})=>{const b=(0,c.A)("flex flex-col items-center justify-center",{small:"h-32",default:"h-64",large:"h-96",full:"min-h-screen"}[h],p);return e?n.createElement("div",{className:b},n.createElement(r.A,{size:"lg"}),n.createElement("p",{className:"mt-4 text-gray-600 dark:text-gray-400"},d)):a?n.createElement("div",{className:b},n.createElement("div",{className:"text-center"},n.createElement(o.A,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),n.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2"},m),n.createElement("p",{className:"text-gray-600 dark:text-gray-400 mb-4"},a.message||"Ocurrió un error inesperado"),l&&n.createElement(i.A,{onClick:l,variant:"outline",icon:s.A},"Reintentar"))):t?n.createElement("div",{className:b},n.createElement("div",{className:"text-center"},g&&n.createElement(g,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),n.createElement("p",{className:"text-gray-500 dark:text-gray-400"},u))):null}},11562:function(e,a,t){var n=t(96540),r=t(20053);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},o.apply(null,arguments)}a.A=({label:e,error:a,help:t,className:s,disabled:i=!1,leftIcon:c,icon:l,multiline:d=!1,required:m=!1,...u})=>{const g=l||c,p=(0,r.A)("block w-full rounded-lg border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white shadow-sm transition-all duration-200 focus:border-venezia-500 focus:ring-venezia-500 dark:focus:border-venezia-400 dark:focus:ring-venezia-400 sm:text-sm",a&&"border-red-300 focus:border-red-500 focus:ring-red-500 dark:border-red-600 dark:focus:border-red-500",i&&"bg-gray-50 dark:bg-gray-800 cursor-not-allowed opacity-60",g&&"pl-10",d&&"resize-vertical",s);return n.createElement("div",null,e&&n.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},e,m&&n.createElement("span",{className:"text-red-500 ml-1"},"*")),n.createElement("div",{className:"relative"},g&&n.createElement("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},n.createElement(g,{className:"h-5 w-5 text-gray-400 dark:text-gray-500","aria-hidden":"true"})),d?n.createElement("textarea",o({className:p,disabled:i},u)):n.createElement("input",o({className:p,disabled:i},u))),a&&n.createElement("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400"},a),t&&!a&&n.createElement("p",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400"},t))}},24596:function(e,a,t){var n=t(13596);t(25708),a.A=new class{constructor(){this.companyInfo={name:"Heladería Venezia",address:"Av. Principal 123, Buenos Aires",phone:"+54 11 1234-5678",email:"info@heladeriavenezia.com",cuit:"30-12345678-9"}}generateReceipt(e){const a=new n.Ay({format:[80,297],unit:"mm"});a.setFont("helvetica");let t=10;a.setFontSize(14),a.setFont("helvetica","bold"),a.text(this.companyInfo.name,40,t,{align:"center"}),t+=6,a.setFontSize(8),a.setFont("helvetica","normal"),a.text(this.companyInfo.address,40,t,{align:"center"}),t+=4,a.text(`Tel: ${this.companyInfo.phone}`,40,t,{align:"center"}),t+=4,a.text(`CUIT: ${this.companyInfo.cuit}`,40,t,{align:"center"}),t+=6,a.line(5,t,75,t),t+=4,a.setFontSize(9),a.setFont("helvetica","bold"),a.text(`RECIBO ${e.receipt_number}`,40,t,{align:"center"}),t+=4,a.setFont("helvetica","normal"),a.setFontSize(8);const r=new Date(e.created_at||Date.now());a.text(`Fecha: ${r.toLocaleDateString("es-AR")} ${r.toLocaleTimeString("es-AR")}`,5,t),t+=4,(e.customer_name||e.customer?.name)&&(a.text(`Cliente: ${e.customer_name||e.customer?.name}`,5,t),t+=4),(e.customer_phone||e.customer?.phone)&&(a.text(`Tel: ${e.customer_phone||e.customer?.phone}`,5,t),t+=4),t+=2,a.line(5,t,75,t),t+=4,a.setFont("helvetica","bold"),a.text("Producto",5,t),a.text("Cant",35,t),a.text("Precio",45,t),a.text("Total",65,t),t+=4,a.setFont("helvetica","normal"),a.line(5,t,75,t),t+=4;let o=0;if(e.items.forEach((e=>{const n=e.product_name||e.name||"Producto",r=n.length>20?n.substring(0,17)+"...":n;a.text(r,5,t),a.text(e.quantity.toString(),37,t);const s=parseFloat(e.unit_price||e.price||0);a.text(`$${s.toFixed(2)}`,45,t);const i=s*e.quantity;o+=i,a.text(`$${i.toFixed(2)}`,60,t),t+=4,t>280&&(a.addPage(),t=10)})),t+=2,a.line(5,t,75,t),t+=4,a.setFont("helvetica","bold"),a.text("Subtotal:",45,t),a.text(`$${o.toFixed(2)}`,60,t),t+=4,e.discount&&e.discount>0){a.text("Descuento:",45,t);const n="percent"===e.discount_type?o*(e.discount/100):e.discount;a.text(`-$${n.toFixed(2)}`,60,t),t+=4}a.setFontSize(10),a.text("TOTAL:",45,t),a.text(`$${parseFloat(e.total).toFixed(2)}`,60,t),t+=6,a.setFontSize(8),a.setFont("helvetica","normal");const s=this.getPaymentMethodName(e.payment_method);return a.text(`Forma de pago: ${s}`,5,t),t+=4,"delivery"===e.sale_type&&e.delivery_address&&(t+=2,a.line(5,t,75,t),t+=4,a.setFont("helvetica","bold"),a.text("INFORMACIÓN DE ENTREGA",40,t,{align:"center"}),t+=4,a.setFont("helvetica","normal"),a.text(`Dirección: ${e.delivery_address}`,5,t),t+=4,e.estimated_time&&(a.text(`Tiempo estimado: ${e.estimated_time}`,5,t),t+=4)),t+=4,a.line(5,t,75,t),t+=4,a.setFontSize(7),a.text("¡Gracias por su compra!",40,t,{align:"center"}),t+=4,a.text("Conserve este recibo para cualquier reclamo",40,t,{align:"center"}),a}generateInvoice(e){const a=new n.Ay({format:"a4",unit:"mm"});a.setFont("helvetica"),a.setFontSize(20),a.setFont("helvetica","bold"),a.text(this.companyInfo.name,20,20),a.setFontSize(10),a.setFont("helvetica","normal"),a.text(this.companyInfo.address,20,28),a.text(`Tel: ${this.companyInfo.phone}`,20,33),a.text(`Email: ${this.companyInfo.email}`,20,38),a.text(`CUIT: ${this.companyInfo.cuit}`,20,43),a.setFontSize(16),a.setFont("helvetica","bold"),a.text("FACTURA",160,20),a.setFontSize(10),a.setFont("helvetica","normal"),a.text(`Nº: ${e.invoice_number||e.receipt_number}`,160,28);const t=new Date(e.created_at||Date.now());a.text(`Fecha: ${t.toLocaleDateString("es-AR")}`,160,33),a.rect(20,55,170,30),a.setFont("helvetica","bold"),a.text("DATOS DEL CLIENTE",25,62),a.setFont("helvetica","normal"),a.text(`Nombre: ${e.customer_name||e.customer?.name||"Cliente General"}`,25,70),a.text(`Teléfono: ${e.customer_phone||e.customer?.phone||"-"}`,25,75),a.text(`Email: ${e.customer_email||e.customer?.email||"-"}`,25,80);const r=e.items.map((e=>[e.product_name||e.name||"Producto",e.quantity,`$${parseFloat(e.unit_price||e.price||0).toFixed(2)}`,`$${(parseFloat(e.unit_price||e.price||0)*e.quantity).toFixed(2)}`]));a.autoTable({head:[["Producto","Cantidad","Precio Unit.","Total"]],body:r,startY:95,theme:"striped",headStyles:{fillColor:[66,66,66]},columnStyles:{0:{cellWidth:100},1:{cellWidth:25,halign:"center"},2:{cellWidth:30,halign:"right"},3:{cellWidth:30,halign:"right"}}});const o=a.lastAutoTable.finalY,s=e.items.reduce(((e,a)=>e+parseFloat(a.unit_price||a.price||0)*a.quantity),0);if(a.setFont("helvetica","bold"),a.text("Subtotal:",140,o+10),a.text(`$${s.toFixed(2)}`,175,o+10,{align:"right"}),e.discount&&e.discount>0){const t="percent"===e.discount_type?s*(e.discount/100):e.discount;a.text("Descuento:",140,o+15),a.text(`-$${t.toFixed(2)}`,175,o+15,{align:"right"})}const i=.21*parseFloat(e.total)/1.21;a.text("IVA (21%):",140,o+20),a.text(`$${i.toFixed(2)}`,175,o+20,{align:"right"}),a.setFontSize(12),a.text("TOTAL:",140,o+30),a.text(`$${parseFloat(e.total).toFixed(2)}`,175,o+30,{align:"right"}),a.setFontSize(10),a.setFont("helvetica","normal");const c=this.getPaymentMethodName(e.payment_method);return a.text(`Forma de pago: ${c}`,20,o+40),a.setFontSize(8),a.text("Este documento es válido como factura",105,280,{align:"center"}),a}getPaymentMethodName(e){return{cash:"Efectivo",card:"Tarjeta",transfer:"Transferencia",mercadopago:"MercadoPago",debit:"Débito",credit:"Crédito"}[e]||e||"Efectivo"}downloadReceipt(e,a=null){const t=this.generateReceipt(e),n=`recibo-${e.receipt_number||"venta"}.pdf`;t.save(a||n)}downloadInvoice(e,a=null){const t=this.generateInvoice(e),n=`factura-${e.invoice_number||e.receipt_number||"venta"}.pdf`;t.save(a||n)}printReceipt(e){const a=this.generateReceipt(e);a.autoPrint(),window.open(a.output("bloburl"),"_blank")}printInvoice(e){const a=this.generateInvoice(e);a.autoPrint(),window.open(a.output("bloburl"),"_blank")}getReceiptBase64(e){return this.generateReceipt(e).output("datauristring")}getInvoiceBase64(e){return this.generateInvoice(e).output("datauristring")}getReceiptBlob(e){return this.generateReceipt(e).output("blob")}getInvoiceBlob(e){return this.generateInvoice(e).output("blob")}}},27993:function(e,a,t){t.d(a,{ZV:function(){return r},vv:function(){return n}});const n=(e,a="ARS")=>null==e?"$0":new Intl.NumberFormat("es-AR",{style:"currency",currency:a,minimumFractionDigits:0,maximumFractionDigits:2}).format(e),r=(e,a=0)=>null==e?"0":new Intl.NumberFormat("es-AR",{minimumFractionDigits:a,maximumFractionDigits:a}).format(e)},29310:function(e,a,t){var n=t(96540),r=t(20053);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},o.apply(null,arguments)}a.A=({label:e,error:a,className:t,disabled:s=!1,rows:i=3,...c})=>{const l=(0,r.A)("block w-full rounded-md border-gray-300 shadow-sm transition-colors","focus:border-venezia-500 focus:ring-venezia-500 sm:text-sm","resize-vertical",a&&"border-red-300 focus:border-red-500 focus:ring-red-500",s&&"bg-gray-50 cursor-not-allowed",t);return n.createElement("div",null,e&&n.createElement("label",{className:"block text-sm font-medium text-gray-700 mb-1"},e),n.createElement("textarea",o({className:l,disabled:s,rows:i},c)),a&&n.createElement("p",{className:"mt-1 text-sm text-red-600"},a))}},42693:function(e,a,t){t.r(a);var n=t(80082);try{if("undefined"!=typeof localStorage&&!localStorage.getItem("gemini-api-key")){const e="AIzaSyCuSgA0UIHHhmq8YjXD1e_Nn8582EG3gVU";e?(localStorage.setItem("gemini-api-key",e),console.log("🚀 API key de Gemini configurada desde variables de entorno"),Promise.resolve().then(t.bind(t,50646)).then((a=>{a.default.setGeminiApiKey(e),console.log("✅ Gemini AI configurado con API key del entorno")})).catch((e=>{console.log("ℹ️ AIService se configurará cuando sea necesario")}))):console.log("⚠️ No se encontró REACT_APP_GEMINI_API_KEY en las variables de entorno")}}catch(e){console.log("ℹ️ Configuración automática de Gemini omitida")}a.default=class{static async chatResponse(e,a=[]){await new Promise((e=>setTimeout(e,1e3+2e3*Math.random())));const t=await this.processActionCommand(e);if(t)return t;const n={greetings:{keywords:["hola","hello","hi","buenos días","buenas tardes","saludos"],response:"¡Hola! Soy **VenezIA**, tu asistente inteligente de Venezia Ice Cream. ¿En qué puedo ayudarte hoy? Puedo ayudarte con ventas, inventario, producción, entregas y análisis."},sales:{keywords:["ventas","sales","vender","vendido","facturación","ingresos","cómo van las ventas","cómo van las ventas hoy","van las ventas"],response:"📊 **Ventas de Hoy - Excelente Rendimiento**\n\n💰 **Ingresos actuales:** $15,450\n📦 **Órdenes procesadas:** 89\n🏆 **Sabor más vendido:** Chocolate con Almendras (23 unidades)\n📈 **Tendencia:** +18% vs ayer\n\n🎯 *Recomendación: Considera aumentar stock de Chocolate con Almendras para mañana.*"},inventory:{keywords:["inventario","inventory","stock","reponer","reabastecer","productos","necesito reponer","qué productos","falta","agotar","qué productos necesito reponer"],response:"📦 **Estado del Inventario - Alerta de Stock**\n\n🔴 **Stock Crítico:**\n• Chocolate Belga: 5 kg (Recomendado: 45 kg)\n• Vainilla Bourbon: 12 kg (Recomendado: 35 kg)\n\n🟡 **Stock Bajo:**\n• Frutilla Natural: 18 kg (Recomendado: 30 kg)\n• Dulce de Leche: 22 kg (Recomendado: 40 kg)\n\n✅ **Acción sugerida:** Crear orden de producción urgente para Chocolate y Vainilla.\n💡 *¿Quieres que genere automáticamente las órdenes de producción?*"},flavors:{keywords:["sabores","flavors","sabores más vendidos","cuáles son mis sabores","top sabores","populares","más vendidos"],response:"🍦 **Top Sabores Más Vendidos**\n\n🥇 **#1 Chocolate con Almendras**\n• 127 ventas esta semana\n• Margen: 45%\n• Stock actual: Crítico (5 kg)\n\n🥈 **#2 Vainilla Premium**\n• 98 ventas esta semana\n• Margen: 40%\n• Stock actual: Bajo (12 kg)\n\n🥉 **#3 Dulce de Leche**\n• 85 ventas esta semana\n• Margen: 42%\n• Stock actual: Normal (22 kg)\n\n📈 **Tendencias:**\n• Chocolate +23% vs semana pasada\n• Sabores premium crecen 18%\n• Demanda pico: Viernes-Domingo\n\n💡 *Recomendación: Aumenta producción de los top 3 para el fin de semana.*"},addStock:{keywords:["agregar stock","quiero agregar stock","añadir stock","suma stock","incrementar stock","agreguemos","helado","agregar helado","añadir helado"],response:'➕ **Agregar Stock a Productos**\n\n📝 **Para agregar stock, puedes decirme:**\n\n**Ejemplos de comandos:**\n• "Suma 15 kg de chocolate"\n• "Agregar 20 litros de vainilla"\n• "Incrementar 10 kg de frutilla"\n\n📦 **Productos disponibles:**\n• Chocolate Belga (crítico)\n• Vainilla Bourbon (bajo)\n• Frutilla Natural (normal)\n• Dulce de Leche (normal)\n• Mint Chip (normal)\n• Pistache Premium (normal)\n\n💡 *Solo escribe algo como "Suma 25 kg de chocolate" y yo lo ejecutaré automáticamente.*'},newFlavor:{keywords:["nuevo sabor","crear sabor","crear un nuevo sabor","nuevo helado","nueva receta"],response:'🆕 **Crear Nuevo Sabor de Helado**\n\n📋 **Para crear un nuevo sabor necesito:**\n\n🍦 **Información básica:**\n• Nombre del sabor\n• Ingredientes principales\n• Tipo (cremoso, frutal, premium)\n• Precio sugerido\n\n📊 **Datos técnicos:**\n• Tiempo de preparación\n• Rendimiento por lote\n• Ingredientes especiales\n• Alergenos\n\n**Ejemplo:** "Crear sabor Cookies & Cream, cremoso, con galletas oreo trituradas, precio $180 por kg"\n\n💡 *¿Qué sabor tienes en mente? Compárteme los detalles y yo ayudo con la receta y configuración.*'},suppliers:{keywords:["agregar proveedor","nuevo proveedor","crear proveedor","proveedores","suppliers"],response:'🏢 **Gestión de Proveedores**\n\n📋 **Para agregar un proveedor necesito:**\n\n🏭 **Información básica:**\n• Nombre de la empresa\n• Contacto principal\n• Teléfono y email\n• Dirección\n\n📦 **Productos que suministra:**\n• Tipo de ingredientes\n• Calidad (premium, estándar)\n• Precios por kg/litro\n• Tiempos de entrega\n\n**Ejemplo:** "Crear proveedor Lácteos San Miguel, contacto Juan Pérez, tel 1234-5678, suministra leche premium a $120/litro"\n\n💡 *¿Qué proveedor quieres agregar? Proporciona los detalles.*'},changePrices:{keywords:["cambiar precios","actualizar precios","modificar precios","ajustar precios","nuevos precios"],response:'💰 **Cambiar Precios de Productos**\n\n📊 **Precios Actuales:**\n• Chocolate Belga: $195/kg\n• Vainilla Premium: $185/kg\n• Frutilla Natural: $175/kg\n• Dulce de Leche: $190/kg\n• Mint Chip: $180/kg\n• Pistache Premium: $220/kg\n\n📈 **Para cambiar precios, dime:**\n• "Cambiar precio de chocolate a $200"\n• "Actualizar vainilla a $190 por kg"\n• "Subir todos los precios 5%"\n\n💡 **Análisis de mercado:**\n• Competencia promedio: $185/kg\n• Margen actual: 38-45%\n• Elasticidad: Premium tolera +10%\n\n🎯 *¿Qué producto quieres ajustar y a qué precio?*'},production:{keywords:["producción","production","lotes","fabricar","hacer","preparar","cocinar","batches"],response:"🏭 **Estado de Producción Actual**\n\n🔄 **Lotes en Proceso:**\n• **Lote #145** - Chocolate Premium\n  └ Progreso: 80% completo\n  └ Tiempo restante: 2 horas\n\n• **Lote #146** - Vainilla Bourbon\n  └ Progreso: 45% completo\n  └ Tiempo restante: 5.5 horas\n\n• **Lote #147** - Frutilla Natural\n  └ Progreso: 20% completo\n  └ Tiempo restante: 8 horas\n\n⚡ **Capacidad disponible:** 2 máquinas libres\n🎯 *¿Necesitas programar nuevos lotes?*"},analytics:{keywords:["análisis","analytics","reporte","estadísticas","performance","rendimiento","métricas","analiza","rendimeinto","heladeria","heladería"],response:"📈 **Análisis de Rendimiento Semanal**\n\n🚀 **Crecimiento:** +15% en ventas\n📅 **Días pico:** Viernes y Sábado (+40%)\n🍦 **Top 3 Sabores:**\n  1. Chocolate con Almendras (127 ventas)\n  2. Vainilla Premium (98 ventas)\n  3. Dulce de Leche (85 ventas)\n\n💡 **Insights:**\n• Los fines de semana demandan 40% más helados premium\n• Las promociones de medio día aumentan ventas 25%\n• Días lluviosos reducen ventas 15%\n\n🎯 **Recomendación:** Aumentar producción premium para el próximo fin de semana."},deliveries:{keywords:["entregas","deliveries","delivery","repartidores","envíos","distribución","drivers"],response:"🚚 **Estado de Entregas del Día**\n\n📊 **Resumen General:**\n• Total programadas: 12 entregas\n• ✅ Entregadas: 8 (67%)\n• 🚛 En tránsito: 3 (25%)\n• ⏳ Pendientes: 1 (8%)\n\n👨‍💼 **Rendimiento de Repartidores:**\n• **Juan Pérez:** 98% éxito (5 entregas hoy)\n• **María García:** 95% éxito (3 entregas hoy)\n• **Carlos López:** 92% éxito (2 entregas hoy)\n\n🎯 *Tiempo promedio de entrega: 32 minutos*"},recommendations:{keywords:["recomendaciones","recommendations","sugerencias","consejos","qué hacer","mejoras","mejorar","como puedo mejorar","mejorar mis ventas","aumentar ventas"],response:"💡 **Recomendaciones Inteligentes Basadas en Datos**\n\n🔥 **Prioridad Alta:**\n1. **Aumentar Producción de Chocolate** - Stock crítico, alta demanda\n2. **Promocionar Sabores de Temporada** - Aprovecha tendencias estacionales\n3. **Optimizar Rutas de Entrega** - Reduce tiempos 15%\n\n📈 **Oportunidades de Crecimiento:**\n• Programa de fidelización de clientes (+25% retención)\n• Horarios extendidos fin de semana (+30% ventas)\n• Nuevos sabores premium (+20% margen)\n\n🎯 *¿Te interesa implementar alguna de estas recomendaciones?*"}},r=e.toLowerCase();for(const[e,a]of Object.entries(n))for(const e of a.keywords)if(r.includes(e))return a.response;return r.includes("?")||r.includes("qué")||r.includes("what")||r.includes("how")?`Entiendo que preguntas sobre "${e}". Como asistente AI de Venezia, puedo ayudarte con información sobre ventas, inventario, producción, entregas y análisis del negocio. ¿Podrías ser más específico sobre qué aspecto te interesa?`:`He procesado tu mensaje: "${e}". Como tu asistente AI especializado en heladería, puedo ayudarte con análisis de ventas, optimización de inventario, planificación de producción y gestión de entregas. ¿En qué área específica necesitas asistencia?`}static async processActionCommand(e){const a=e.toLowerCase();return this.isInventoryCommand(a)?await this.handleInventoryCommand(e,a):this.isProductionCommand(a)?await this.handleProductionCommand(e,a):this.isOrderCommand(a)?await this.handleOrderCommand(e,a):this.isDeliveryCommand(a)?await this.handleDeliveryCommand(e,a):null}static isInventoryCommand(e){return["suma","agregar","añadir","incrementar","stock","inventario","kg","kilogramo","litro"].some((a=>e.includes(a)))}static async handleInventoryCommand(e,a){const t=e.match(/(\d+(?:\.\d+)?)\s*(kg|kilogramo|litro|l|unidad)/i),r=t?parseFloat(t[1]):null,o=t?t[2].toLowerCase():"kg";let s=null,i=null;const c={chocolate:{id:1,name:"Chocolate Amargo"},"chocolate amargo":{id:1,name:"Chocolate Amargo"},vainilla:{id:2,name:"Vainilla"},"dulce de leche":{id:3,name:"Dulce de Leche"},frutilla:{id:4,name:"Frutilla"},menta:{id:5,name:"Menta Granizada"},"menta granizada":{id:5,name:"Menta Granizada"}};for(const[e,t]of Object.entries(c))if(a.includes(e)){s=t.name,i=t.id;break}if(!s&&r&&(s="Chocolate Amargo",i=1),!r||!i)return'❓ Entiendo que quieres agregar stock, pero necesito más información:\n\n**Formato sugerido:** "Suma 2 kg de chocolate" o "Agregar 5 kg de vainilla"\n\n📦 **Productos disponibles:**\n- Chocolate Amargo\n- Vainilla\n- Dulce de Leche\n- Frutilla\n- Menta Granizada\n\n¿Podrías especificar la cantidad y el producto?';try{console.log("🔥 Llamando API real:","/api/executive/add-stock");const e=await fetch("/api/executive/add-stock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({product_id:i,quantity:r,unit:o})});if(e.ok){const a=await e.json();return console.log("✅ Respuesta API real:",a),`✅ ¡Listo! He agregado ${r} ${o} de ${a.product.name} al inventario real.\n\n📦 **Acción ejecutada en la base de datos:**\n- Producto: ${a.product.name}\n- Cantidad agregada: ${r} ${o}\n- Stock actual: ${a.new_stock} ${o}\n- Precio: $${a.product.price}\n\n🔄 **El cambio se refleja inmediatamente en toda la aplicación web.**\n💡 *Puedes verificarlo en la sección de productos o inventario.*`}{const a=await e.json();throw console.error("❌ Error API real:",a),new Error(a.message||"API error")}}catch(e){console.error("❌ Error conectando con backend:",e);try{const e=await n.A.addInventory({product:s,quantity:r,unit:o,reason:"AI Assistant - Comando de usuario"});if(e.success)return`⚠️ ¡Comando ejecutado en modo simulación!\n\n📦 **Acción ejecutada (solo simulación):**\n- Producto: ${s}\n- Cantidad agregada: ${r} ${o}\n- Stock simulado: ${e.data.new_stock} ${o}\n- Timestamp: ${new Date(e.data.timestamp).toLocaleString()}\n\n🔧 **Nota:** El backend no está disponible, esto es solo una simulación.\n💡 *Para cambios reales, usa el Asistente Guiado o verifica la conexión.*`}catch(e){console.error("Mock API error:",e)}return`❌ **Error de conexión**\n\nNo pude conectar con la base de datos para agregar ${r} ${o} de ${s}.\n\n🔧 **Posibles causas:**\n- Servidor backend no disponible\n- Producto no encontrado en la base de datos\n- Error de red\n\n💡 **Soluciones:**\n- Usa el Asistente Guiado para acciones manuales\n- Verifica que el servidor esté ejecutándose\n- Intenta nuevamente en unos momentos`}}static isProductionCommand(e){return["producir","hacer","preparar","lote","receta","fabricar","crear sabor","nuevo sabor","nueva receta"].some((a=>e.includes(a)))}static async handleProductionCommand(e,a){if(a.includes("nuevo")||a.includes("crear")||a.includes("sabor"))return this.handleNewProductCreation(e,a);const t=e.match(/(\d+(?:\.\d+)?)\s*(kg|kilogramo|litro|l|unidad|lote)/i),n=t?parseFloat(t[1]):25;let r="Chocolate Premium";return a.includes("vainilla")?r="Vainilla Bourbon":a.includes("frutilla")?r="Frutilla Natural":a.includes("dulce")&&(r="Dulce de Leche"),`🏭 **Gestión de Producción**\n\n📋 **Para órdenes de producción:** \nEl sistema actual maneja inventario directo. Para aumentar stock de ${r}:\n\n💡 **Comando sugerido:** "Suma ${n} kg de ${r.split(" ")[0].toLowerCase()}"\n\n📦 **Productos disponibles para stock:**\n- Chocolate Amargo\n- Vainilla\n- Dulce de Leche\n- Frutilla\n- Menta Granizada\n\n🎯 *El comando de suma actualizará el inventario inmediatamente en la base de datos.*`}static async handleNewProductCreation(e,a){const t=e.match(/(?:crear|nuevo|nueva)\s+(?:sabor\s+)?(.+?)(?:\s+(?:precio|a|por)|\s*$)/i);let n=t?t[1].trim():null;const r=e.match(/precio\s+(?:\$)?(\d+(?:\.\d+)?)/i),o=r?parseFloat(r[1]):3500;if(!n)return'🆕 **Crear Nuevo Sabor**\n\nPara crear un nuevo producto necesito el nombre:\n\n**Formato:** "Crear sabor [Nombre] precio $[cantidad]"\n**Ejemplo:** "Crear sabor Cookies & Cream precio $4000"\n\n¿Qué sabor quieres crear?';try{console.log("🔥 Creando producto:",n);const e=await fetch("/api/executive/create-product",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,price:o,context:"ai_created",category:"Helado",initial_stock:0})});if(e.ok){const a=await e.json();return console.log("✅ Producto creado:",a),`🆕 ¡Nuevo sabor creado exitosamente!\n\n📦 **Producto agregado a la base de datos:**\n- Nombre: ${a.product.name}\n- ID: #${a.product.id}\n- Precio: $${a.product.price}\n- Stock inicial: ${a.product.stock} kg\n- Categoría: ${a.product.category}\n\n🔄 **El producto ya está disponible en toda la aplicación.**\n💡 *Ahora puedes agregar stock con: "Suma X kg de ${n}"*`}{const a=await e.json();if(console.error("❌ Error creando producto:",a),a.message&&a.message.includes("already exists"))return`⚠️ **Producto Similar Existe**\n\n${a.message}\n\n💡 **Opciones:**\n- Usa un nombre diferente\n- Agrega stock al producto existente\n- Modifica el nombre para hacerlo único`;throw new Error(a.message||"Error creando producto")}}catch(e){return console.error("❌ Error conectando con backend:",e),`❌ **Error al crear producto**\n\nNo pude crear "${n}" en la base de datos.\n\n🔧 **Posibles causas:**\n- Servidor backend no disponible\n- Producto con nombre similar ya existe\n- Error de red\n\n💡 **Soluciones:**\n- Verifica que el servidor esté ejecutándose\n- Usa el Asistente Guiado para crear productos manualmente\n- Intenta con un nombre diferente`}}static isOrderCommand(e){return["crear orden","nueva venta","vender","orden","pedido"].some((a=>e.includes(a)))}static async handleOrderCommand(e,a){return'🛒 Para crear órdenes de venta necesito más información:\n\n**Datos requeridos:**\n- Cliente (nombre/teléfono)\n- Productos y cantidades\n- Método de pago\n- ¿Es para delivery?\n\n**Ejemplo:** "Crear orden para Juan Pérez, 2 kg chocolate y 1 kg vainilla, pago efectivo, delivery a Av. Corrientes 1234"\n\n¿Me proporcionas estos datos?'}static isDeliveryCommand(e){return["entregar","delivery","envío","repartir","asignar repartidor","repartidores","drivers","disponibles"].some((a=>e.includes(a)))}static async handleDeliveryCommand(e,a){if(a.includes("disponibles")||a.includes("repartidores")||a.includes("drivers"))try{const e=await n.A.getAvailableDrivers();if(e.success){const a=e.drivers.filter((e=>e.available)),t=e.drivers.filter((e=>!e.available));let n="🚚 **Estado actual de repartidores:**\n\n";return a.length>0&&(n+=`✅ **Disponibles (${a.length}):**\n`,a.forEach((e=>{n+=`• ${e.name} - ${e.vehicle} (${e.current_orders} órdenes activas)\n`}))),t.length>0&&(n+=`\n❌ **No disponibles (${t.length}):**\n`,t.forEach((e=>{n+=`• ${e.name} - ${e.vehicle}\n`}))),n+=`\n💡 **Puedes decir:** "Asignar orden #1234 a ${a[0]?.name||"Juan"}"`,n}}catch(e){console.error("Error getting drivers:",e)}return'🚚 **Control de entregas disponible:**\n\nPuedo ayudarte con:\n- Ver repartidores disponibles: "¿Qué repartidores están disponibles?"\n- Asignar repartidores a órdenes\n- Actualizar estado de entregas\n- Optimizar rutas\n\n**Ejemplo:** "Asignar orden #1234 a Juan Pérez" o "¿Qué repartidores están disponibles?"\n\n¿Qué acción específica necesitas?'}static async getPredictions(e=7){await new Promise((e=>setTimeout(e,1500)));const a=[],t=new Date;for(let n=0;n<e;n++){const e=new Date(t);e.setDate(t.getDate()+n);const r=8e3+4e3*Math.random(),o=Math.floor(r/150),s=.75+.2*Math.random();a.push({date:e.toLocaleDateString("es-AR"),predicted_sales:o,predicted_revenue:r,confidence:s})}return{summary:`Predicciones para los próximos ${e} días muestran un crecimiento sostenido del 12% con ingresos estimados de $${a.reduce(((e,a)=>e+a.predicted_revenue),0).toLocaleString("es-AR",{maximumFractionDigits:0})}`,predictions:a,recommended_products:[{product_name:"Chocolate con Almendras",expected_demand:Math.floor(150+50*Math.random()),priority:"alta"},{product_name:"Vainilla Premium",expected_demand:Math.floor(120+40*Math.random()),priority:"media"},{product_name:"Frutilla Natural",expected_demand:Math.floor(100+30*Math.random()),priority:"media"},{product_name:"Dulce de Leche",expected_demand:Math.floor(90+25*Math.random()),priority:"baja"}],insights:["Los fines de semana muestran un aumento del 40% en ventas","Los sabores premium tienen mayor demanda en días calurosos","Las promociones de medio día aumentan las ventas en un 25%","Los días lluviosos reducen las ventas de helados en un 15%"]}}static async getBusinessAnalysis(){return await new Promise((e=>setTimeout(e,2e3))),{summary:"El rendimiento general del negocio es excelente este mes. Las ventas han crecido un 18% comparado con el mes anterior, la eficiencia operativa ha mejorado y la satisfacción del cliente se mantiene alta.",performance_score:Math.floor(7+3*Math.random()),recommendations:[{category:"Ventas",priority:"alta",action:"Implementar programa de fidelización para clientes frecuentes",impact:"Podría aumentar ventas recurrentes en un 25%"},{category:"Inventario",priority:"media",action:"Optimizar niveles de stock usando predicciones AI",impact:"Reducción del 15% en desperdicio de productos"},{category:"Producción",priority:"media",action:"Automatizar más procesos de preparación",impact:"Aumento del 20% en eficiencia de producción"},{category:"Entregas",priority:"baja",action:"Expandir zona de delivery a nuevos barrios",impact:"Potencial de crecimiento del 30% en entregas"}],trends:{sales_growth:"18%",customer_satisfaction:"94%",operational_efficiency:"89%",profit_margin:"32%"}}}static async getInventoryOptimization(){return await new Promise((e=>setTimeout(e,1800))),{summary:"Análisis de inventario completo. Se detectaron 3 productos con stock crítico, 2 con exceso de stock y se generaron recomendaciones de producción optimizada.",stock_alerts:[{product:"Chocolate Belga",store:"Sucursal Centro",current_stock:5,recommended_stock:45,urgency:"alta",reasoning:"Stock crítico. Producto muy demandado los fines de semana."},{product:"Vainilla Bourbon",store:"Sucursal Norte",current_stock:12,recommended_stock:35,urgency:"media",reasoning:"Stock bajo. Aumentar antes del próximo fin de semana."},{product:"Limón Natural",store:"Sucursal Sur",current_stock:8,recommended_stock:25,urgency:"media",reasoning:"Sabor de temporada con demanda creciente."}],overstock_items:[{product:"Menta Granizada",store:"Sucursal Centro",current_stock:75,suggested_action:"Promoción especial para reducir stock"},{product:"Coco Rayado",store:"Sucursal Norte",current_stock:60,suggested_action:"Transferir 20 unidades a Sucursal Sur"}],production_priorities:["Chocolate Belga","Vainilla Bourbon","Dulce de Leche","Frutilla Cremosa","Limón Natural"]}}}},71428:function(e,a,t){var n=t(96540),r=t(20053);function o(){return o=Object.assign?Object.assign.bind():function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var n in t)({}).hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e},o.apply(null,arguments)}a.A=({label:e,error:a,placeholder:t,className:s,disabled:i=!1,options:c=[],icon:l,children:d,...m})=>{const u=(0,r.A)("block w-full rounded-md border-gray-300 dark:border-gray-600 shadow-sm transition-colors","bg-white dark:bg-gray-800 text-gray-900 dark:text-white","focus:border-venezia-500 focus:ring-venezia-500 dark:focus:border-venezia-400 dark:focus:ring-venezia-400","sm:text-sm",a&&"border-red-300 dark:border-red-600 focus:border-red-500 focus:ring-red-500",i&&"bg-gray-50 dark:bg-gray-700 cursor-not-allowed opacity-50",l&&"pl-10",s);return n.createElement("div",{className:"relative"},e&&n.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},e),n.createElement("div",{className:"relative"},l&&n.createElement("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},n.createElement(l,{className:"h-4 w-4 text-gray-400 dark:text-gray-500"})),n.createElement("select",o({className:u,disabled:i},m),t&&n.createElement("option",{value:"",disabled:!0,className:"text-gray-500 dark:text-gray-400"},t),c.length>0?c.map(((e,a)=>n.createElement("option",{key:e.value||a,value:e.value,className:"bg-white dark:bg-gray-800 text-gray-900 dark:text-white"},e.label))):d)),a&&n.createElement("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400"},a))}},76894:function(e,a,t){var n=t(96540),r=t(37946),o=t(20053);a.A=({error:e,className:a,showIcon:t=!0,variant:s="default"})=>{if(!e)return null;const i={default:"text-red-600 dark:text-red-400",inline:"text-red-600 dark:text-red-400 text-sm",block:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3"};return"block"===s?n.createElement("div",{className:(0,o.A)(i.block,a)},n.createElement("div",{className:"flex items-start gap-2"},t&&n.createElement(r.A,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),n.createElement("div",{className:"text-sm"},"string"==typeof e?n.createElement("p",null,e):n.createElement("ul",{className:"space-y-1"},Object.entries(e).map((([e,a])=>n.createElement("li",{key:e},n.createElement("strong",null,e,":")," ",Array.isArray(a)?a.join(", "):a))))))):n.createElement("div",{className:(0,o.A)("flex items-center gap-1 mt-1",i[s],a)},t&&n.createElement(r.A,{className:"w-3 h-3"}),n.createElement("span",{className:"inline"===s?"text-sm":"text-xs"},"string"==typeof e?e:"Error de validación"))}}}]);