"use strict";(self.webpackChunkvenezia_frontend=self.webpackChunkvenezia_frontend||[]).push([[8620],{88620:function(e,t,a){a.r(t),a.d(t,{default:function(){return te}});var r=a(96540),n=a(47767),l=a(17133),i=a(22247),s=a(91385),c=a(94945),o=a(15977),d=a(80697),m=a(29696),u=a(71429),g=a(418),p=a(76316),y=a(98445),x=a(35627),b=a(98645),E=a(70700),v=a(42203),k=a(93823),f=a(72284),N=a(11562),h=a(71428),_=a(28219),w=a(89141),A=a(58543),C=a(98188),S=a(32708),z=a(86589),q=a(20053),$=({ingredient:e,onEdit:t,onDelete:a,onStockUpdate:n,className:i})=>{const{id:s,name:c,unit:o,current_stock:d,min_stock:m,max_stock:p,unit_cost:y,supplier_name:x,last_purchase_date:b,expiry_date:E}=e,v=p>0?d/p*100:0,k=d<=0?"out-of-stock":d<=m?"low-stock":d>=.9*p?"overstock":"normal",N=(()=>{switch(k){case"out-of-stock":return{color:"text-red-600 bg-red-50",borderColor:"border-red-200",barColor:"bg-red-500",icon:r.createElement(g.A,{className:"w-4 h-4"}),text:"Sin Stock"};case"low-stock":return{color:"text-yellow-600 bg-yellow-50",borderColor:"border-yellow-200",barColor:"bg-yellow-500",icon:r.createElement(u.A,{className:"w-4 h-4"}),text:"Stock Bajo"};case"overstock":return{color:"text-blue-600 bg-blue-50",borderColor:"border-blue-200",barColor:"bg-blue-500",text:"Exceso"};default:return{color:"text-green-600 bg-green-50",borderColor:"border-gray-200",barColor:"bg-green-500",text:"Normal"}}})(),h=()=>!!E&&new Date(E)<new Date;return r.createElement("div",{className:(0,q.A)("bg-white dark:bg-gray-800 rounded-lg shadow-sm border transition-all duration-200","hover:shadow-md hover:border-gray-300 dark:hover:border-gray-600",N.borderColor,i)},r.createElement("div",{className:"p-4 border-b dark:border-gray-700"},r.createElement("div",{className:"flex items-start justify-between mb-2"},r.createElement("div",{className:"flex-1"},r.createElement("h3",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2"},(()=>{switch(o?.toLowerCase()){case"kg":case"g":return r.createElement(w.A,{className:"w-4 h-4"});case"l":case"ml":return r.createElement(A.A,{className:"w-4 h-4"});default:return r.createElement(l.A,{className:"w-4 h-4"})}})(),c),x&&r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1"},"Proveedor: ",x)),r.createElement("div",{className:"flex items-center gap-1"},r.createElement(f.A,{onClick:()=>t(e),variant:"ghost",size:"sm",icon:C.A,className:"text-gray-400 hover:text-gray-600"}),r.createElement(f.A,{onClick:()=>a(s),variant:"ghost",size:"sm",icon:S.A,className:"text-gray-400 hover:text-red-600"}))),r.createElement("div",{className:"flex items-center justify-between"},r.createElement("span",{className:(0,q.A)("inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",N.color)},N.icon,N.text),(h()||(()=>{if(!E)return!1;const e=Math.ceil((new Date(E)-new Date)/864e5);return e<=7&&e>0})())&&r.createElement("span",{className:(0,q.A)("text-xs px-2 py-1 rounded-full",h()?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700")},h()?"Expirado":`Expira en ${Math.ceil((new Date(E)-new Date)/864e5)} días`))),r.createElement("div",{className:"p-4 space-y-3"},r.createElement("div",null,r.createElement("div",{className:"flex justify-between text-sm mb-1"},r.createElement("span",{className:"text-gray-600 dark:text-gray-400"},"Stock Actual"),r.createElement("span",{className:"font-medium"},d," ",o)),r.createElement("div",{className:"relative h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},r.createElement("div",{className:(0,q.A)("absolute inset-y-0 left-0 transition-all duration-300",N.barColor),style:{width:`${Math.min(v,100)}%`}}),r.createElement("div",{className:"absolute top-0 bottom-0 w-0.5 bg-gray-400",style:{left:m/p*100+"%"},title:`Mínimo: ${m} ${o}`})),r.createElement("div",{className:"flex justify-between text-xs text-gray-500 mt-1"},r.createElement("span",null,"Mín: ",m),r.createElement("span",null,"Máx: ",p))),r.createElement("div",{className:"flex items-center justify-between pt-2 border-t dark:border-gray-700"},r.createElement("div",{className:"flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400"},r.createElement(z.A,{className:"w-3 h-3"}),r.createElement("span",null,"Costo unitario")),r.createElement("span",{className:"font-medium text-gray-900 dark:text-white"},"$",y?.toFixed(2)||"0.00","/",o)),b&&r.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400"},"Última compra: ",new Date(b).toLocaleDateString()),r.createElement("div",{className:"pt-3 border-t dark:border-gray-700"},r.createElement(f.A,{onClick:()=>n(e),variant:"outline",size:"sm",className:"w-full",icon:l.A},"Actualizar Stock"))))},j=a(60665),D=a(35404),I=a(27235),F=a(93893),L=a(72102),T=a(75107),O=a(99229),P=({recipe:e,ingredients:t=[],onEdit:a,onDelete:n,onDuplicate:i,onCalculateCost:s,onCheckAvailability:c,className:o})=>{const[d,u]=(0,r.useState)(!1),{id:g,name:p,product_name:y,yield_quantity:x,yield_unit:b,preparation_time:E,difficulty:v,instructions:k,recipe_ingredients:N=[],total_cost:h,cost_per_unit:w,created_at:A,updated_at:$}=e,P=h||N.reduce(((e,a)=>{const r=t.find((e=>e.id===a.ingredient_id));return r?e+a.quantity*(r.unit_cost||0):e}),0),R=w||(x>0?P/x:0),M=()=>N.some((e=>{const a=t.find((t=>t.id===e.ingredient_id));return a&&a.current_stock<=a.min_stock}));return r.createElement("div",{className:(0,q.A)("bg-white dark:bg-gray-800 rounded-lg shadow-sm border transition-all duration-200","hover:shadow-md",M()?"border-yellow-300":"border-gray-200 dark:border-gray-700",o)},r.createElement("div",{className:"p-4"},r.createElement("div",{className:"flex items-start justify-between mb-3"},r.createElement("div",{className:"flex-1"},r.createElement("h3",{className:"font-semibold text-gray-900 dark:text-white flex items-center gap-2"},r.createElement(j.A,{className:"w-5 h-5 text-gray-500 dark:text-gray-400"}),p),y&&r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1"},"Producto: ",y)),r.createElement("div",{className:"flex items-center gap-1"},r.createElement(f.A,{onClick:()=>i(e),variant:"ghost",size:"sm",icon:D.A,className:"text-gray-400 hover:text-gray-600",title:"Duplicar receta"}),r.createElement(f.A,{onClick:()=>a(e),variant:"ghost",size:"sm",icon:C.A,className:"text-gray-400 hover:text-gray-600",title:"Editar receta"}),r.createElement(f.A,{onClick:()=>n(g),variant:"ghost",size:"sm",icon:S.A,className:"text-gray-400 hover:text-red-600",title:"Eliminar receta"}))),r.createElement("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mb-3"},r.createElement("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-700 rounded"},r.createElement(l.A,{className:"w-4 h-4 text-gray-500 dark:text-gray-400 mx-auto mb-1"}),r.createElement("p",{className:"text-xs text-gray-600 dark:text-gray-400"},"Rendimiento"),r.createElement("p",{className:"text-sm font-medium"},x," ",b)),r.createElement("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-700 rounded"},r.createElement(I.A,{className:"w-4 h-4 text-gray-500 dark:text-gray-400 mx-auto mb-1"}),r.createElement("p",{className:"text-xs text-gray-600 dark:text-gray-400"},"Tiempo"),r.createElement("p",{className:"text-sm font-medium"},E||"-"," min")),r.createElement("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-700 rounded"},r.createElement(z.A,{className:"w-4 h-4 text-gray-500 dark:text-gray-400 mx-auto mb-1"}),r.createElement("p",{className:"text-xs text-gray-600 dark:text-gray-400"},"Costo/unidad"),r.createElement("p",{className:"text-sm font-medium"},"$",R.toFixed(2))),r.createElement("div",{className:"text-center p-2 bg-gray-50 dark:bg-gray-700 rounded"},r.createElement(F.A,{className:"w-4 h-4 text-gray-500 dark:text-gray-400 mx-auto mb-1"}),r.createElement("p",{className:"text-xs text-gray-600 dark:text-gray-400"},"Dificultad"),r.createElement(_.A,{variant:(()=>{switch(v?.toLowerCase()){case"facil":case"easy":return"success";case"medio":case"medium":return"warning";case"dificil":case"hard":return"danger";default:return"default"}})(),size:"sm"},v||"Media"))),M()&&r.createElement("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded p-2 mb-3"},r.createElement("p",{className:"text-xs text-yellow-800 dark:text-yellow-200"},"⚠️ Algunos ingredientes tienen stock bajo")),r.createElement(f.A,{onClick:()=>u(!d),variant:"ghost",size:"sm",className:"w-full justify-between"},r.createElement("span",null,"Ver ",d?"menos":"detalles"),d?r.createElement(L.A,{className:"w-4 h-4"}):r.createElement(T.A,{className:"w-4 h-4"}))),d&&r.createElement("div",{className:"border-t dark:border-gray-700"},r.createElement("div",{className:"p-4"},r.createElement("h4",{className:"font-medium text-sm mb-3 flex items-center gap-2"},r.createElement(l.A,{className:"w-4 h-4"}),"Ingredientes (",N.length,")"),r.createElement("div",{className:"space-y-2"},N.map(((e,a)=>{const n=t.find((t=>t.id===e.ingredient_id)),l=n&&n.current_stock<=n.min_stock;return r.createElement("div",{key:e.id||a,className:(0,q.A)("flex items-center justify-between p-2 rounded","bg-gray-50 dark:bg-gray-700",l&&"border border-yellow-300")},r.createElement("div",{className:"flex items-center gap-2"},r.createElement("span",{className:"text-sm font-medium"},n?.name||"Ingrediente desconocido"),l&&r.createElement(_.A,{variant:"warning",size:"xs"},"Stock bajo")),r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},e.quantity," ",n?.unit||"",n&&r.createElement("span",{className:"ml-2 text-xs"},"($",(e.quantity*n.unit_cost).toFixed(2),")")))}))),r.createElement("div",{className:"mt-3 pt-3 border-t dark:border-gray-600 flex justify-between items-center"},r.createElement("span",{className:"font-medium"},"Costo Total:"),r.createElement("span",{className:"text-lg font-bold text-venezia-600 dark:text-venezia-400"},"$",P.toFixed(2)))),k&&r.createElement("div",{className:"p-4 border-t dark:border-gray-700"},r.createElement("h4",{className:"font-medium text-sm mb-2"},"Instrucciones"),r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400 whitespace-pre-wrap"},k)),r.createElement("div",{className:"p-4 border-t dark:border-gray-700 flex gap-2"},r.createElement(f.A,{onClick:()=>s(e),variant:"outline",size:"sm",icon:O.A,className:"flex-1"},"Recalcular Costo"),c&&r.createElement(f.A,{onClick:()=>c(e),variant:"outline",size:"sm",icon:m.A,className:"flex-1"},"Verificar Stock")),r.createElement("div",{className:"px-4 pb-3 text-xs text-gray-500 dark:text-gray-400"},"Creado: ",new Date(A).toLocaleDateString(),$&&$!==A&&r.createElement("span",{className:"ml-2"},"• Actualizado: ",new Date($).toLocaleDateString()))))},R=a(37946),M=a(97213),U=a(22492),V=a(93540),B=a(3160),W=a(46858),G=a(76069),J=a(81393),K=a(32307),H=a(48697),Q=a(48852),X=a(67773),Y=({isOpen:e,onClose:t,onSave:a,ingredient:n=null,suppliers:i=[]})=>{const[s,c]=(0,r.useState)({name:"",unit:"kg",current_stock:0,min_stock:0,max_stock:0,unit_cost:0,supplier_id:"",supplier_name:"",expiry_date:"",description:"",storage_location:"",reorder_point:0,reorder_quantity:0}),[o,d]=(0,r.useState)({}),[m,u]=(0,r.useState)(!1),[g,y]=(0,r.useState)(1),[x,b]=(0,r.useState)(!1),[E,v]=(0,r.useState)(0),k=[{value:"kg",label:"Kilogramos (kg)",icon:w.A},{value:"g",label:"Gramos (g)",icon:w.A},{value:"l",label:"Litros (l)",icon:A.A},{value:"ml",label:"Mililitros (ml)",icon:A.A},{value:"unidad",label:"Unidad",icon:l.A},{value:"docena",label:"Docena",icon:l.A},{value:"caja",label:"Caja",icon:l.A}];(0,r.useEffect)((()=>{n?(c({name:n.name||"",unit:n.unit||"kg",current_stock:n.current_stock||0,min_stock:n.min_stock||0,max_stock:n.max_stock||0,unit_cost:n.unit_cost||0,supplier_id:n.supplier_id||"",supplier_name:n.supplier_name||"",expiry_date:n.expiry_date?new Date(n.expiry_date).toISOString().split("T")[0]:"",description:n.description||"",storage_location:n.storage_location||"",reorder_point:n.reorder_point||n.min_stock||0,reorder_quantity:n.reorder_quantity||0}),b(!0)):(c({name:"",unit:"kg",current_stock:0,min_stock:0,max_stock:0,unit_cost:0,supplier_id:"",supplier_name:"",expiry_date:"",description:"",storage_location:"",reorder_point:0,reorder_quantity:0}),b(!1)),d({}),y(1)}),[n]),(0,r.useEffect)((()=>{const e=parseFloat(s.current_stock)*parseFloat(s.unit_cost);v(isNaN(e)?0:e)}),[s.current_stock,s.unit_cost]);const _=e=>{const{name:t,value:a}=e.target;c((e=>({...e,[t]:a}))),o[t]&&d((e=>({...e,[t]:""})))},C=(()=>{const e=k.find((e=>e.value===s.unit));return e?e.icon:l.A})(),S=e=>{switch(e){case 1:return s.name.trim()&&s.unit;case 2:return s.current_stock>=0&&s.min_stock>=0;case 3:return s.unit_cost>=0;default:return!0}};return r.createElement(X.A,{isOpen:e,onClose:t,title:r.createElement("div",{className:"flex items-center justify-between w-full"},r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:"p-2 bg-venezia-100 dark:bg-venezia-900 rounded-lg"},r.createElement(l.A,{className:"w-5 h-5 text-venezia-600 dark:text-venezia-400"})),r.createElement("div",null,r.createElement("h2",{className:"text-lg font-semibold text-gray-900 dark:text-white"},n?"Editar Ingrediente":"Nuevo Ingrediente"),r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},(()=>{switch(g){case 1:default:return"Información Básica";case 2:return"Control de Stock";case 3:return"Proveedor y Costos"}})()))),r.createElement("div",{className:"flex items-center gap-2"},[1,2,3].map((e=>r.createElement("div",{key:e,className:"w-8 h-8 rounded-full flex items-center justify-center text-xs font-medium transition-colors "+(e===g?"bg-venezia-600 text-white":e<g?"bg-green-500 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-500 dark:text-gray-400")},e<g?"✓":e))))),size:"lg"},r.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return s.name.trim()||(e.name="El nombre es requerido"),s.min_stock<0&&(e.min_stock="El stock mínimo no puede ser negativo"),s.max_stock<s.min_stock&&(e.max_stock="El stock máximo debe ser mayor al mínimo"),s.current_stock<0&&(e.current_stock="El stock actual no puede ser negativo"),s.unit_cost<0&&(e.unit_cost="El costo no puede ser negativo"),s.reorder_point<0&&(e.reorder_point="El punto de reorden no puede ser negativo"),s.expiry_date&&new Date(s.expiry_date)<new Date&&(e.expiry_date="La fecha de expiración no puede ser en el pasado"),d(e),0===Object.keys(e).length})()){u(!0);try{const e=i.find((e=>e.id===parseInt(s.supplier_id))),r={...s,supplier_name:e?e.name:s.supplier_name,current_stock:parseFloat(s.current_stock),min_stock:parseFloat(s.min_stock),max_stock:parseFloat(s.max_stock),unit_cost:parseFloat(s.unit_cost),reorder_point:parseFloat(s.reorder_point)||parseFloat(s.min_stock),reorder_quantity:parseFloat(s.reorder_quantity)||0};await a(r),t()}catch(e){console.error("Error saving ingredient:",e),d({general:"Error al guardar el ingrediente"})}finally{u(!1)}}},className:"space-y-6"},o.general&&r.createElement("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3"},r.createElement("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-300"},r.createElement(R.A,{className:"w-4 h-4"}),r.createElement("span",{className:"text-sm"},o.general))),1===g&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"bg-gradient-to-r from-venezia-50 to-blue-50 dark:from-venezia-900/20 dark:to-blue-900/20 rounded-xl p-6 border border-venezia-200 dark:border-venezia-800"},r.createElement("div",{className:"flex items-start gap-4"},r.createElement("div",{className:"p-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm"},r.createElement(C,{className:"w-6 h-6 text-venezia-600 dark:text-venezia-400"})),r.createElement("div",{className:"flex-1"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2"},"Información del Ingrediente"),r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Comencemos con la información básica del ingrediente")))),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},r.createElement("div",{className:"space-y-4"},r.createElement(N.A,{label:"Nombre del Ingrediente",name:"name",value:s.name,onChange:_,placeholder:"Ej: Leche entera, Chocolate en polvo...",error:o.name,required:!0,className:"text-lg"}),r.createElement(h.A,{label:"Unidad de Medida",name:"unit",value:s.unit,onChange:_,options:k.map((e=>({value:e.value,label:e.label}))),icon:C})),r.createElement("div",{className:"space-y-4"},r.createElement(N.A,{label:"Descripción (Opcional)",name:"description",value:s.description,onChange:_,placeholder:"Detalles adicionales sobre el ingrediente...",multiline:!0,rows:4}),r.createElement("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4 border border-blue-200 dark:border-blue-800"},r.createElement("div",{className:"flex items-start gap-2"},r.createElement(M.A,{className:"w-4 h-4 text-blue-600 mt-0.5"}),r.createElement("div",{className:"text-sm text-blue-700 dark:text-blue-300"},r.createElement("strong",null,"Tip:")," Un nombre descriptivo ayuda a identificar rápidamente el ingrediente en el inventario.")))))),2===g&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-xl p-6 border border-green-200 dark:border-green-800"},r.createElement("div",{className:"flex items-start gap-4"},r.createElement("div",{className:"p-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm"},r.createElement(l.A,{className:"w-6 h-6 text-green-600 dark:text-green-400"})),r.createElement("div",{className:"flex-1"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2"},"Control de Inventario"),r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Define las cantidades para un control eficiente del stock")))),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6"},r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center gap-2 mb-3"},r.createElement("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg"},r.createElement(l.A,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})),r.createElement("span",{className:"font-medium text-gray-900 dark:text-white"},"Stock Actual")),r.createElement(N.A,{name:"current_stock",type:"number",step:"0.01",value:s.current_stock,onChange:_,error:o.current_stock,placeholder:"0.00",className:"text-xl font-semibold"}),r.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Cantidad disponible ahora")),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center gap-2 mb-3"},r.createElement("div",{className:"p-2 bg-yellow-100 dark:bg-yellow-900 rounded-lg"},r.createElement(U.A,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400"})),r.createElement("span",{className:"font-medium text-gray-900 dark:text-white"},"Stock Mínimo")),r.createElement(N.A,{name:"min_stock",type:"number",step:"0.01",value:s.min_stock,onChange:_,error:o.min_stock,placeholder:"0.00",className:"text-xl font-semibold"}),r.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Nivel de alerta de reposición")),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center gap-2 mb-3"},r.createElement("div",{className:"p-2 bg-green-100 dark:bg-green-900 rounded-lg"},r.createElement(p.A,{className:"w-4 h-4 text-green-600 dark:text-green-400"})),r.createElement("span",{className:"font-medium text-gray-900 dark:text-white"},"Stock Máximo")),r.createElement(N.A,{name:"max_stock",type:"number",step:"0.01",value:s.max_stock,onChange:_,error:o.max_stock,placeholder:"0.00",className:"text-xl font-semibold"}),r.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Capacidad máxima recomendada"))),r.createElement("div",{className:"border-t dark:border-gray-700 pt-6"},r.createElement("button",{type:"button",onClick:()=>b(!x),className:"flex items-center gap-2 text-sm font-medium text-venezia-600 dark:text-venezia-400 hover:text-venezia-700 dark:hover:text-venezia-300 transition-colors mb-4"},x?r.createElement(V.A,{className:"w-4 h-4"}):r.createElement(B.A,{className:"w-4 h-4"}),x?"Ocultar":"Mostrar"," opciones avanzadas"),x&&r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},r.createElement("div",{className:"space-y-4"},r.createElement(N.A,{label:"Punto de Reorden",name:"reorder_point",type:"number",step:"0.01",value:s.reorder_point,onChange:_,error:o.reorder_point,icon:W.A,placeholder:s.min_stock.toString(),help:"Nivel que activa automáticamente una orden de compra"}),r.createElement(N.A,{label:"Cantidad de Reorden",name:"reorder_quantity",type:"number",step:"0.01",value:s.reorder_quantity,onChange:_,icon:l.A,help:"Cantidad a pedir cuando se alcance el punto de reorden"})),r.createElement(N.A,{label:"Ubicación de Almacenamiento",name:"storage_location",value:s.storage_location,onChange:_,placeholder:"Ej: Refrigerador 1, Estante A3, Área seca...",icon:G.A,help:"Ubicación física donde se almacena el ingrediente"})))),3===g&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"bg-gradient-to-r from-yellow-50 to-orange-50 dark:from-yellow-900/20 dark:to-orange-900/20 rounded-xl p-6 border border-yellow-200 dark:border-yellow-800"},r.createElement("div",{className:"flex items-start gap-4"},r.createElement("div",{className:"p-3 bg-white dark:bg-gray-800 rounded-lg shadow-sm"},r.createElement(z.A,{className:"w-6 h-6 text-yellow-600 dark:text-yellow-400"})),r.createElement("div",{className:"flex-1"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2"},"Costos y Proveedor"),r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Información comercial y de costos del ingrediente")))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center gap-3 mb-4"},r.createElement(O.A,{className:"w-5 h-5 text-venezia-600"}),r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white"},"Información de Costos")),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},r.createElement("div",null,r.createElement(N.A,{label:`Costo por ${s.unit}`,name:"unit_cost",type:"number",step:"0.01",value:s.unit_cost,onChange:_,error:o.unit_cost,icon:z.A,required:!0,className:"text-lg font-semibold",placeholder:"0.00"})),r.createElement("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4"},r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1"},"Valor Total Estimado"),r.createElement("div",{className:"text-2xl font-bold text-venezia-600 dark:text-venezia-400"},"$",E.toFixed(2)),r.createElement("div",{className:"text-xs text-gray-500 mt-1"},s.current_stock," ",s.unit," × $",s.unit_cost)))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center gap-3 mb-4"},r.createElement(J.A,{className:"w-5 h-5 text-venezia-600"}),r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white"},"Información del Proveedor")),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},r.createElement("div",null,i.length>0?r.createElement(h.A,{label:"Proveedor",name:"supplier_id",value:s.supplier_id,onChange:_,options:[{value:"",label:"Seleccionar proveedor..."},...i.map((e=>({value:e.id.toString(),label:e.name})))],icon:J.A}):r.createElement(N.A,{label:"Nombre del Proveedor",name:"supplier_name",value:s.supplier_name,onChange:_,placeholder:"Nombre del proveedor",icon:J.A})),r.createElement(N.A,{label:"Fecha de Expiración",name:"expiry_date",type:"date",value:s.expiry_date,onChange:_,error:o.expiry_date,icon:K.A,min:(new Date).toISOString().split("T")[0],help:"Fecha de vencimiento del lote actual"})))),r.createElement("div",{className:"flex justify-between items-center pt-6 border-t dark:border-gray-700"},r.createElement("div",{className:"flex gap-2"},g>1&&r.createElement(f.A,{type:"button",onClick:()=>{g>1&&y(g-1)},variant:"outline",size:"sm"},"Anterior")),r.createElement("div",{className:"flex gap-3"},r.createElement(f.A,{type:"button",onClick:t,variant:"ghost",icon:H.A},"Cancelar"),g<3?r.createElement(f.A,{type:"button",onClick:()=>{g<3&&S(g)&&y(g+1)},variant:"primary",disabled:!S(g)},"Siguiente"):r.createElement(f.A,{type:"submit",variant:"primary",icon:Q.A,loading:m,className:"bg-gradient-to-r from-venezia-600 to-venezia-700 hover:from-venezia-700 hover:to-venezia-800"},n?"Actualizar":"Crear"," Ingrediente")))))},Z=a(86241),ee=({isOpen:e,onClose:t,onSave:a,recipe:n=null,products:i=[],ingredients:c=[]})=>{const[o,m]=(0,r.useState)({name:"",product_id:"",yield_quantity:1,yield_unit:"unidad",preparation_time:30,difficulty:"medio",instructions:"",notes:"",recipe_ingredients:[]}),[u,g]=(0,r.useState)({}),[p,y]=(0,r.useState)(!1),[x,b]=(0,r.useState)(0);(0,r.useEffect)((()=>{m(n?{name:n.name||"",product_id:n.product_id||"",yield_quantity:n.yield_quantity||1,yield_unit:n.yield_unit||"unidad",preparation_time:n.preparation_time||30,difficulty:n.difficulty||"medio",instructions:n.instructions||"",notes:n.notes||"",recipe_ingredients:n.recipe_ingredients||[]}:{name:"",product_id:"",yield_quantity:1,yield_unit:"unidad",preparation_time:30,difficulty:"medio",instructions:"",notes:"",recipe_ingredients:[]}),g({})}),[n]),(0,r.useEffect)((()=>{const e=o.recipe_ingredients.reduce(((e,t)=>{const a=c.find((e=>e.id===t.ingredient_id));return a?e+t.quantity*(a.unit_cost||0):e}),0);b(e)}),[o.recipe_ingredients,c]);const E=e=>{const{name:t,value:a}=e.target;m((e=>({...e,[t]:a}))),u[t]&&g((e=>({...e,[t]:""})))},v=(e,t,a)=>{m((r=>({...r,recipe_ingredients:r.recipe_ingredients.map(((r,n)=>n===e?{...r,[t]:a}:r))})))};return r.createElement(X.A,{isOpen:e,onClose:t,title:r.createElement("div",{className:"flex items-center gap-2"},r.createElement(j.A,{className:"w-5 h-5"}),n?"Editar Receta":"Nueva Receta"),size:"xl"},r.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return o.name.trim()||(e.name="El nombre de la receta es requerido"),o.product_id||(e.product_id="Debe seleccionar un producto"),o.yield_quantity<=0&&(e.yield_quantity="La cantidad debe ser mayor a 0"),0===o.recipe_ingredients.length&&(e.ingredients="Debe agregar al menos un ingrediente"),o.recipe_ingredients.forEach(((t,a)=>{t.ingredient_id||(e[`ingredient_${a}_id`]="Seleccione un ingrediente"),t.quantity<=0&&(e[`ingredient_${a}_quantity`]="La cantidad debe ser mayor a 0")})),g(e),0===Object.keys(e).length})()){y(!0);try{const e={...o,yield_quantity:parseFloat(o.yield_quantity),preparation_time:parseInt(o.preparation_time),total_cost:x,cost_per_unit:x/parseFloat(o.yield_quantity),recipe_ingredients:o.recipe_ingredients.map((e=>({...e,ingredient_id:parseInt(e.ingredient_id),quantity:parseFloat(e.quantity)})))};await a(e),t()}catch(e){console.error("Error saving recipe:",e),g({general:"Error al guardar la receta"})}finally{y(!1)}}},className:"space-y-6"},u.general&&r.createElement("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3"},r.createElement("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-300"},r.createElement(R.A,{className:"w-4 h-4"}),r.createElement("span",{className:"text-sm"},u.general))),r.createElement("div",{className:"space-y-4"},r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2"},r.createElement(s.A,{className:"w-4 h-4"}),"Información Básica"),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},r.createElement(N.A,{label:"Nombre de la Receta",name:"name",value:o.name,onChange:E,placeholder:"Ej: Helado de Vainilla Premium",error:u.name,required:!0}),r.createElement(h.A,{label:"Producto Final",name:"product_id",value:o.product_id,onChange:E,options:[{value:"",label:"Seleccionar producto"},...Array.isArray(i)?i.map((e=>({value:e.id.toString(),label:e.name}))):[]],error:u.product_id,required:!0})),r.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4"},r.createElement(N.A,{label:"Rendimiento",name:"yield_quantity",type:"number",step:"0.01",value:o.yield_quantity,onChange:E,error:u.yield_quantity,icon:l.A,required:!0}),r.createElement(h.A,{label:"Unidad",name:"yield_unit",value:o.yield_unit,onChange:E,options:[{value:"unidad",label:"Unidad"},{value:"porcion",label:"Porción"},{value:"kg",label:"Kilogramo"},{value:"litro",label:"Litro"},{value:"docena",label:"Docena"}]}),r.createElement(N.A,{label:"Tiempo (min)",name:"preparation_time",type:"number",value:o.preparation_time,onChange:E,icon:I.A}),r.createElement(h.A,{label:"Dificultad",name:"difficulty",value:o.difficulty,onChange:E,options:[{value:"facil",label:"Fácil"},{value:"medio",label:"Medio"},{value:"dificil",label:"Difícil"}],icon:F.A}))),r.createElement("div",{className:"space-y-4"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2"},r.createElement(l.A,{className:"w-4 h-4"}),"Ingredientes"),r.createElement(f.A,{type:"button",onClick:()=>{m((e=>({...e,recipe_ingredients:[...e.recipe_ingredients,{id:Date.now(),ingredient_id:"",quantity:0,notes:""}]})))},variant:"outline",size:"sm",icon:d.A},"Agregar Ingrediente")),u.ingredients&&r.createElement("p",{className:"text-sm text-red-600"},u.ingredients),r.createElement("div",{className:"space-y-3"},o.recipe_ingredients.map(((e,t)=>{const a=c.find((t=>t.id===parseInt(e.ingredient_id))),n=(e=>{const t=c.find((t=>t.id===parseInt(e.ingredient_id)));return t?e.quantity*(t.unit_cost||0):0})(e);return r.createElement("div",{key:e.id||t,className:"flex items-start gap-3 p-3 bg-gray-50 dark:bg-gray-700 rounded-lg"},r.createElement("div",{className:"flex-1 grid grid-cols-1 md:grid-cols-3 gap-3"},r.createElement(h.A,{label:"Ingrediente",value:e.ingredient_id,onChange:e=>v(t,"ingredient_id",e.target.value),options:[{value:"",label:"Seleccionar"},...Array.isArray(c)?c.map((e=>({value:e.id.toString(),label:`${e.name} (${e.unit})`}))):[]],error:u[`ingredient_${t}_id`]}),r.createElement(N.A,{label:"Cantidad "+(a?`(${a.unit})`:""),type:"number",step:"0.01",value:e.quantity,onChange:e=>v(t,"quantity",e.target.value),error:u[`ingredient_${t}_quantity`]}),r.createElement(N.A,{label:"Notas",value:e.notes||"",onChange:e=>v(t,"notes",e.target.value),placeholder:"Opcional"})),r.createElement("div",{className:"flex items-center gap-2 mt-6"},r.createElement("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300"},"$",n.toFixed(2)),r.createElement(f.A,{type:"button",onClick:()=>(e=>{m((t=>({...t,recipe_ingredients:t.recipe_ingredients.filter(((t,a)=>a!==e))})))})(t),variant:"ghost",size:"sm",icon:Z.A,className:"text-red-600 hover:text-red-700"})))}))),o.recipe_ingredients.length>0&&r.createElement("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Costo Total de Ingredientes:"),r.createElement("span",{className:"text-lg font-bold text-blue-700 dark:text-blue-300"},"$",x.toFixed(2))),r.createElement("div",{className:"flex items-center justify-between"},r.createElement("span",{className:"text-sm text-gray-600 dark:text-gray-400"},"Costo por ",o.yield_unit,":"),r.createElement("span",{className:"font-medium text-gray-900 dark:text-white"},"$",(x/(o.yield_quantity||1)).toFixed(2))))),r.createElement("div",{className:"space-y-4"},r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white"},"Instrucciones"),r.createElement(N.A,{label:"Instrucciones de Preparación",name:"instructions",value:o.instructions,onChange:E,placeholder:"Describa el proceso de preparación paso a paso...",multiline:!0,rows:4}),r.createElement(N.A,{label:"Notas Adicionales",name:"notes",value:o.notes,onChange:E,placeholder:"Notas, tips o consideraciones especiales (opcional)",multiline:!0,rows:2})),r.createElement("div",{className:"flex justify-end gap-3 pt-4 border-t dark:border-gray-700"},r.createElement(f.A,{type:"button",onClick:t,variant:"outline",icon:H.A},"Cancelar"),r.createElement(f.A,{type:"submit",variant:"primary",icon:Q.A,loading:p},n?"Actualizar":"Crear"," Receta"))))},te=()=>{const e=(0,n.zy)(),t=()=>{switch(e.pathname){case"/ingredients":return"ingredients";case"/recipes":return"recipes";default:return"stock"}},[a,w]=(0,r.useState)(t());(0,r.useEffect)((()=>{w(t())}),[e.pathname]);const[A,C]=(0,r.useState)(""),[S,z]=(0,r.useState)("all"),[j,D]=(0,r.useState)("all"),[I,F]=(0,r.useState)("all"),[L,T]=(0,r.useState)("name"),[O,R]=(0,r.useState)("grid"),[M,U]=(0,r.useState)(!1),[V,B]=(0,r.useState)(!1),[W,G]=(0,r.useState)(!1),[J,K]=(0,r.useState)(null),{success:H,error:Q,warning:X}=(0,v.d)(),{data:Z,loading:te,refetch:ae}=(0,E.Wl)("/api/ingredients"),{data:re,loading:ne,refetch:le}=(0,E.Wl)("/api/recipes"),{data:ie,loading:se}=(0,E.Wl)("/api/products"),{data:ce,loading:oe}=(0,E.Wl)("/api/stores"),{data:de,loading:me,refetch:ue}=(0,E.Wl)("/api/stock_data"),{data:ge,loading:pe}=(0,E.Wl)("/api/providers"),ye=te||ne||se||oe||me||pe,xe=(0,r.useMemo)((()=>{const e=Array.isArray(Z?.ingredients)?Z.ingredients:Array.isArray(Z)?Z:[];if(0===e.length||!de)return{totalIngredients:0,lowStock:0,outOfStock:0,totalValue:0};const t=e.filter((e=>e.current_stock>0&&e.current_stock<=e.min_stock)).length,a=e.filter((e=>e.current_stock<=0)).length,r=e.reduce(((e,t)=>e+t.current_stock*(t.unit_cost||0)),0);return{totalIngredients:e.length,lowStock:t,outOfStock:a,totalValue:r}}),[Z,de]),be=(0,r.useMemo)((()=>{const e=Array.isArray(Z?.ingredients)?Z.ingredients:Array.isArray(Z)?Z:[];return 0===e.length?[]:e.filter((e=>{const t=e.name.toLowerCase().includes(A.toLowerCase())||e.supplier_name?.toLowerCase().includes(A.toLowerCase()),a="all"===j||"low"===j&&e.current_stock<=e.min_stock&&e.current_stock>0||"out"===j&&e.current_stock<=0||"normal"===j&&e.current_stock>e.min_stock;return t&&a})).sort(((e,t)=>{switch(L){case"name":return e.name.localeCompare(t.name);case"stock":return t.current_stock-e.current_stock;case"value":return t.current_stock*t.unit_cost-e.current_stock*e.unit_cost;default:return 0}}))}),[Z,A,j,L]),Ee=(0,r.useMemo)((()=>{const e=Array.isArray(re?.recipes)?re.recipes:Array.isArray(re)?re:[];return 0===e.length?[]:e.filter((e=>{const t=e.name.toLowerCase().includes(A.toLowerCase())||e.product_name?.toLowerCase().includes(A.toLowerCase())||e.category?.toLowerCase().includes(A.toLowerCase()),a="all"===I||e.difficulty?.toLowerCase()===I.toLowerCase();return t&&a})).sort(((e,t)=>{switch(L){case"name":return e.name.localeCompare(t.name);case"difficulty":const a={"fácil":0,facil:0,easy:0,medio:1,medium:1,"difícil":2,dificil:2,hard:2};return(a[e.difficulty?.toLowerCase()]||1)-(a[t.difficulty?.toLowerCase()]||1);case"cost":return(t.total_cost||0)-(e.total_cost||0);case"time":return(e.preparation_time||0)-(t.preparation_time||0);default:return 0}}))}),[re,A,I,L]),ve=async(e,t)=>{if(window.confirm(`¿Está seguro de eliminar este ${"ingredient"===e?"ingrediente":"receta"}?`))try{const a="ingredient"===e?`/api/ingredients/${t}`:`/api/recipes/${t}`,r=await fetch(a,{method:"DELETE"});if(r.ok)H("Eliminado",("ingredient"===e?"Ingrediente":"Receta")+" eliminado correctamente"),"ingredient"===e?ae():le();else{const e=await r.json();Q("Error",e.error||"No se pudo eliminar")}}catch(e){Q("Error","Error al eliminar")}},ke=async e=>{try{const t=await fetch(`/api/recipes/${e.id}/check-availability`,{method:"POST"});if(t.ok){const a=await t.json();a.can_make?H("Receta disponible",`La receta "${e.name}" puede prepararse con el stock actual`):X("Ingredientes faltantes",`La receta "${e.name}" requiere ${a.missing_ingredients.length} ingredientes`)}else Q("Error","No se pudo verificar la disponibilidad")}catch(e){Q("Error","Error al verificar disponibilidad de la receta")}},fe=[{id:"stock",label:"Stock General",icon:l.A,count:xe.totalIngredients},{id:"ingredients",label:"Ingredientes",icon:i.A,count:Array.isArray(Z?.ingredients)?Z.ingredients.length:Array.isArray(Z)?Z.length:0},{id:"recipes",label:"Recetas",icon:s.A,count:Array.isArray(re?.recipes)?re.recipes.length:Array.isArray(re)?re.length:0},{id:"analytics",label:"Análisis",icon:c.A}];return r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},r.createElement("div",null,r.createElement("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white"},"Gestión de Inventario"),r.createElement("p",{className:"text-gray-600 dark:text-gray-400 mt-1"},"Control de ingredientes, recetas y stock")),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(f.A,{onClick:()=>{ae(),le(),ue(),H("Actualizado","Datos actualizados correctamente")},variant:"outline",size:"sm",icon:o.A},"Actualizar"),"ingredients"===a&&r.createElement(f.A,{onClick:()=>{K(null),U(!0)},variant:"primary",icon:d.A},"Nuevo Ingrediente"),"recipes"===a&&r.createElement("div",{className:"flex items-center gap-2"},r.createElement(f.A,{onClick:async()=>{try{const e=Array.isArray(re?.recipes)?re.recipes:Array.isArray(re)?re:[];if(0===e.length)return void X("Sin Recetas","No hay recetas para verificar");const t=await Promise.all(e.map((async e=>{const t=await fetch(`/api/recipes/${e.id}/check-availability`,{method:"POST"}),a=await t.json();return{...e,availability:a}}))),a=t.filter((e=>e.availability.can_make)).length,r=t.length-a;r>0?X("Recetas con ingredientes faltantes",`${a} recetas disponibles, ${r} requieren restock`):H("Todas las recetas disponibles",`Las ${a} recetas pueden prepararse con el stock actual`)}catch(e){Q("Error","Error al verificar disponibilidad de recetas")}},variant:"outline",size:"sm",icon:m.A},"Verificar Disponibilidad"),r.createElement(f.A,{onClick:()=>{K(null),B(!0)},variant:"primary",icon:d.A},"Nueva Receta")))),r.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Total Ingredientes"),r.createElement("p",{className:"text-2xl font-bold mt-1"},xe.totalIngredients)),r.createElement(l.A,{className:"w-8 h-8 text-gray-400"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Stock Bajo"),r.createElement("p",{className:"text-2xl font-bold mt-1 text-yellow-600"},xe.lowStock)),r.createElement(u.A,{className:"w-8 h-8 text-yellow-600"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Sin Stock"),r.createElement("p",{className:"text-2xl font-bold mt-1 text-red-600"},xe.outOfStock)),r.createElement(g.A,{className:"w-8 h-8 text-red-600"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Valor Total"),r.createElement("p",{className:"text-2xl font-bold mt-1"},"$",xe.totalValue.toFixed(2))),r.createElement(p.A,{className:"w-8 h-8 text-green-600"})))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700"},r.createElement("div",{className:"border-b dark:border-gray-700"},r.createElement("div",{className:"flex overflow-x-auto"},fe.map((e=>{const t=e.icon;return r.createElement("button",{key:e.id,onClick:()=>w(e.id),className:(0,q.A)("flex items-center gap-2 px-6 py-3 border-b-2 transition-colors whitespace-nowrap",a===e.id?"border-venezia-600 text-venezia-600 dark:text-venezia-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200")},r.createElement(t,{className:"w-4 h-4"}),r.createElement("span",null,e.label),void 0!==e.count&&r.createElement(_.A,{size:"xs",variant:"default"},e.count))})))),r.createElement("div",{className:"p-4 border-b dark:border-gray-700"},r.createElement("div",{className:"flex flex-col sm:flex-row gap-3"},r.createElement("div",{className:"flex-1"},r.createElement(N.A,{type:"text",placeholder:"Buscar...",value:A,onChange:e=>C(e.target.value),icon:y.A})),("stock"===a||"ingredients"===a)&&r.createElement(r.Fragment,null,r.createElement(h.A,{value:j,onChange:e=>D(e.target.value),options:[{value:"all",label:"Todos los estados"},{value:"normal",label:"Stock Normal"},{value:"low",label:"Stock Bajo"},{value:"out",label:"Sin Stock"}],icon:x.A,className:"w-full sm:w-48"}),r.createElement(h.A,{value:L,onChange:e=>T(e.target.value),options:[{value:"name",label:"Nombre"},{value:"stock",label:"Stock"},{value:"value",label:"Valor"}],icon:b.A,className:"w-full sm:w-40"})),"recipes"===a&&r.createElement(r.Fragment,null,r.createElement(h.A,{value:I,onChange:e=>F(e.target.value),options:[{value:"all",label:"Todas las dificultades"},{value:"fácil",label:"Fácil"},{value:"medio",label:"Medio"},{value:"difícil",label:"Difícil"}],icon:x.A,className:"w-full sm:w-48"}),r.createElement(h.A,{value:L,onChange:e=>T(e.target.value),options:[{value:"name",label:"Nombre"},{value:"difficulty",label:"Dificultad"},{value:"cost",label:"Costo"},{value:"time",label:"Tiempo"}],icon:b.A,className:"w-full sm:w-40"})))),r.createElement("div",{className:"p-6"},ye?r.createElement("div",{className:"flex items-center justify-center h-64"},r.createElement(k.A,{size:"lg"})):r.createElement(r.Fragment,null,("stock"===a||"ingredients"===a)&&r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},be.map((e=>r.createElement($,{key:e.id,ingredient:e,onEdit:e=>{K(e),U(!0)},onDelete:e=>ve("ingredient",e),onStockUpdate:e=>{K(e),G(!0)}}))),0===be.length&&r.createElement("div",{className:"col-span-full text-center py-12"},r.createElement(l.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),r.createElement("p",{className:"text-gray-500"},"No se encontraron ingredientes"))),"recipes"===a&&r.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4"},Ee.map((e=>r.createElement(P,{key:e.id,recipe:e,ingredients:Z||[],onEdit:e=>{K(e),B(!0)},onDelete:e=>ve("recipe",e),onDuplicate:e=>{const t={...e,id:null,name:`${e.name} (Copia)`};K(t),B(!0)},onCalculateCost:async e=>{try{const t=await fetch(`/api/recipes/${e.id}/calculate-cost`);if(t.ok){const e=await t.json();H("Costo actualizado",`Costo total: $${e.total_cost.toFixed(2)}`),le()}else Q("Error","No se pudo calcular el costo")}catch(e){Q("Error","Error al calcular el costo")}},onCheckAvailability:ke}))),0===Ee.length&&r.createElement("div",{className:"col-span-full text-center py-12"},r.createElement(s.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),r.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"No se encontraron recetas"))),"analytics"===a&&r.createElement("div",{className:"text-center py-12"},r.createElement(c.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),r.createElement("p",{className:"text-gray-500"},"Análisis de inventario próximamente"))))),r.createElement(Y,{isOpen:M,onClose:()=>{U(!1),K(null)},onSave:async e=>{try{const t=J?`/api/ingredients/${J.id}`:"/api/ingredients",a=await fetch(t,{method:J?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok)H(J?"Ingrediente actualizado":"Ingrediente creado",`${e.name} se ${J?"actualizó":"creó"} correctamente`),ae(),U(!1),K(null);else{const e=await a.json();Q("Error",e.error||"No se pudo guardar el ingrediente")}}catch(e){Q("Error","Error al guardar el ingrediente")}},ingredient:J,suppliers:ge||[]}),r.createElement(ee,{isOpen:V,onClose:()=>{B(!1),K(null)},onSave:async e=>{try{const t=J?`/api/recipes/${J.id}`:"/api/recipes",a=await fetch(t,{method:J?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok)H(J?"Receta actualizada":"Receta creada",`${e.name} se ${J?"actualizó":"creó"} correctamente`),le(),B(!1),K(null);else{const e=await a.json();Q("Error",e.error||"No se pudo guardar la receta")}}catch(e){Q("Error","Error al guardar la receta")}},recipe:J,products:ie||[],ingredients:Array.isArray(Z?.ingredients)?Z.ingredients:Array.isArray(Z)?Z:[]}))}}}]);