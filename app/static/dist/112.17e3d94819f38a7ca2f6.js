"use strict";(self.webpackChunkvenezia_frontend=self.webpackChunkvenezia_frontend||[]).push([[112],{60112:function(e,t,a){a.r(t),a.d(t,{default:function(){return _}});var r=a(96540),n=a(3385),l=a(81507),s=a(14403),c=a(63322),o=a(37037),m=a(5763),i=a(77117),d=a(89197),u=a(30072),p=a(80794),E=a(45795),g=a(42254),v=a(2889),x=a(93823),y=a(67773),h=a(72284),f=a(11562),N=a(71428),w=a(29310),b=a(45856);const A=new class{invalidateEndpoints(e){Array.isArray(e)||(e=[e]),b.A.emit(b.q.CACHE_INVALIDATE,{endpoints:e})}invalidatePattern(e){b.A.emit(b.q.CACHE_INVALIDATE,{pattern:e})}invalidateAll(){b.A.emit(b.q.CACHE_INVALIDATE,{pattern:""})}invalidateProviders(){this.invalidateEndpoints(["/api/providers","/api/provider_categories"])}invalidateProducts(){this.invalidateEndpoints(["/api/products","/api/product_categories","/api/flavors"])}invalidateStock(){this.invalidateEndpoints(["/api/stock_data","/api/inventory"])}invalidateDashboard(){this.invalidateEndpoints(["/api/dashboard/overview"])}};"undefined"!=typeof window&&(window.cacheManager=A);var C=A,_=()=>{const[e,t]=(0,r.useState)([]),[a,b]=(0,r.useState)([]),[A,_]=(0,r.useState)(!0),[k,S]=(0,r.useState)(""),[P,z]=(0,r.useState)(""),[j,T]=(0,r.useState)(!1),[I,L]=(0,r.useState)(!1),[O,q]=(0,r.useState)(!1),[D,V]=(0,r.useState)(!1),[$,B]=(0,r.useState)(null),[G,H]=(0,r.useState)({name:"",contact_person:"",phone:"",email:"",address:"",cuit:"",category_id:"",notes:""}),[J,U]=(0,r.useState)({}),[F,M]=(0,r.useState)(!1);(0,r.useEffect)((()=>{K(),Q()}),[]);const K=async()=>{try{const e=await fetch("/api/providers");if(e.ok){const a=await e.json(),r=a?.data||a;t(Array.isArray(r)?r:[])}}catch(e){console.error("Error cargando proveedores:",e),t([])}finally{_(!1)}},Q=async()=>{try{const e=await fetch("/api/provider_categories");if(e.ok){const t=await e.json(),a=t?.data||t;b(Array.isArray(a)?a:[])}}catch(e){console.error("Error cargando categorías:",e),b([])}},R=(Array.isArray(e)?e:[]).filter((e=>{const t=e.name.toLowerCase().includes(k.toLowerCase())||e.contact_person?.toLowerCase().includes(k.toLowerCase())||e.phone?.includes(k)||e.email?.toLowerCase().includes(k.toLowerCase()),a=!P||e.category_id?.toString()===P;return t&&a})),W=(e,t)=>{H((a=>({...a,[e]:t}))),J[e]&&U((t=>({...t,[e]:""})))},X=()=>{const e={};return G.name.trim()||(e.name="El nombre es requerido"),G.contact_person.trim()||(e.contact_person="La persona de contacto es requerida"),G.phone.trim()||(e.phone="El teléfono es requerido"),G.email&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(G.email)&&(e.email="El email no es válido"),U(e),0===Object.keys(e).length},Y=()=>{H({name:"",contact_person:"",phone:"",email:"",address:"",cuit:"",category_id:"",notes:""}),U({})};return A?r.createElement("div",{className:"flex items-center justify-center h-64"},r.createElement(x.A,{size:"lg"})):r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between"},r.createElement("div",null,r.createElement("h1",{className:"text-2xl font-bold text-gray-900 flex items-center"},r.createElement(l.A,{className:"h-8 w-8 text-venezia-600 mr-3"}),"Gestión de Proveedores"),r.createElement("p",{className:"mt-1 text-sm text-gray-500"},"Administra proveedores, categorías y contactos")),r.createElement("button",{onClick:()=>T(!0),className:"mt-4 sm:mt-0 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-venezia-600 hover:bg-venezia-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-venezia-500"},r.createElement(s.A,{className:"h-5 w-5 mr-2"}),"Nuevo Proveedor")),r.createElement("div",{className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200"},r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},r.createElement("div",{className:"relative"},r.createElement(c.A,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),r.createElement("input",{type:"text",placeholder:"Buscar proveedores...",value:k,onChange:e=>S(e.target.value),className:"pl-10 block w-full border-gray-300 rounded-md shadow-sm focus:ring-venezia-500 focus:border-venezia-500 sm:text-sm"})),r.createElement("select",{value:P,onChange:e=>z(e.target.value),className:"block w-full border-gray-300 rounded-md shadow-sm focus:ring-venezia-500 focus:border-venezia-500 sm:text-sm"},r.createElement("option",{value:""},"Todas las categorías"),Array.isArray(a)?a.map((e=>r.createElement("option",{key:e.id,value:e.id.toString()},e.name))):[]),r.createElement("div",{className:"text-sm text-gray-500 flex items-center"},"Total: ",R.length," proveedores"))),r.createElement("div",{className:"bg-white shadow-sm rounded-lg border border-gray-200 overflow-hidden"},r.createElement("div",{className:"overflow-x-auto"},r.createElement("table",{className:"min-w-full divide-y divide-gray-200"},r.createElement("thead",{className:"bg-gray-50"},r.createElement("tr",null,r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Proveedor"),r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Contacto"),r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Categoría"),r.createElement("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Estado"),r.createElement("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Acciones"))),r.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},R.map((e=>r.createElement(n.P.tr,{key:e.id,initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50"},r.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},r.createElement("div",{className:"flex items-center"},r.createElement("div",{className:"h-10 w-10 flex-shrink-0"},r.createElement("div",{className:"h-10 w-10 rounded-full bg-venezia-100 flex items-center justify-center"},r.createElement(l.A,{className:"h-5 w-5 text-venezia-600"}))),r.createElement("div",{className:"ml-4"},r.createElement("div",{className:"text-sm font-medium text-gray-900"},e.name),e.cuit&&r.createElement("div",{className:"text-sm text-gray-500"},"CUIT: ",e.cuit)))),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},r.createElement("div",{className:"text-sm text-gray-900"},e.contact_person),r.createElement("div",{className:"text-sm text-gray-500 space-y-1"},e.phone&&r.createElement("div",{className:"flex items-center"},r.createElement(o.A,{className:"h-4 w-4 mr-1"}),e.phone),e.email&&r.createElement("div",{className:"flex items-center"},r.createElement(m.A,{className:"h-4 w-4 mr-1"}),e.email))),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},r.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},e.category_name||"Sin categoría")),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap"},r.createElement("button",{onClick:()=>(async e=>{try{(await fetch(`/api/providers/toggle_status/${e.id}`,{method:"POST"})).ok?(C.invalidateProviders(),await K()):console.error("Error al cambiar estado")}catch(e){console.error("Error:",e)}})(e),className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${e.is_active?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"} transition-colors`},e.is_active?r.createElement(r.Fragment,null,r.createElement(i.A,{className:"h-4 w-4 mr-1"}),"Activo"):r.createElement(r.Fragment,null,r.createElement(d.A,{className:"h-4 w-4 mr-1"}),"Inactivo"))),r.createElement("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium space-x-2"},r.createElement("button",{onClick:()=>(e=>{B(e),q(!0)})(e),className:"text-venezia-600 hover:text-venezia-900 transition-colors",title:"Ver detalles"},r.createElement(u.A,{className:"h-5 w-5"})),r.createElement("button",{onClick:()=>(e=>{H({name:e.name||"",contact_person:e.contact_person||"",phone:e.phone||"",email:e.email||"",address:e.address||"",cuit:e.cuit||"",category_id:e.category_id?.toString()||"",notes:e.notes||""}),B(e),L(!0)})(e),className:"text-blue-600 hover:text-blue-900 transition-colors",title:"Editar"},r.createElement(p.A,{className:"h-5 w-5"})),r.createElement("button",{onClick:()=>(e=>{B(e),V(!0)})(e),className:"text-red-600 hover:text-red-900 transition-colors",title:"Eliminar"},r.createElement(E.A,{className:"h-5 w-5"})))))))),0===R.length&&r.createElement("div",{className:"text-center py-12"},r.createElement(l.A,{className:"mx-auto h-12 w-12 text-gray-400"}),r.createElement("h3",{className:"mt-2 text-sm font-medium text-gray-900"},"No se encontraron proveedores"),r.createElement("p",{className:"mt-1 text-sm text-gray-500"},k||P?"Prueba ajustando los filtros de búsqueda":"Comienza agregando un nuevo proveedor")))),r.createElement(y.A,{isOpen:j||I,onClose:()=>{T(!1),L(!1),Y(),B(null)},title:j?"Nuevo Proveedor":"Editar Proveedor",size:"lg"},r.createElement("div",{className:"space-y-4"},r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},r.createElement(f.A,{label:"Nombre del Proveedor *",value:G.name,onChange:e=>W("name",e.target.value),error:J.name,placeholder:"Ej: Distribuidora ABC"}),r.createElement(f.A,{label:"Persona de Contacto *",value:G.contact_person,onChange:e=>W("contact_person",e.target.value),error:J.contact_person,placeholder:"Ej: Juan Pérez"}),r.createElement(f.A,{label:"Teléfono *",value:G.phone,onChange:e=>W("phone",e.target.value),error:J.phone,placeholder:"Ej: +54 11 1234-5678"}),r.createElement(f.A,{label:"Email",type:"email",value:G.email,onChange:e=>W("email",e.target.value),error:J.email,placeholder:"Ej: contacto@proveedor.com"}),r.createElement(f.A,{label:"CUIT",value:G.cuit,onChange:e=>W("cuit",e.target.value),placeholder:"Ej: 20-12345678-9"}),r.createElement(N.A,{label:"Categoría",value:G.category_id,onChange:e=>W("category_id",e.target.value),placeholder:"Seleccionar categoría"},r.createElement("option",{value:""},"Sin categoría"),Array.isArray(a)?a.map((e=>r.createElement("option",{key:e.id,value:e.id.toString()},e.name))):[])),r.createElement(f.A,{label:"Dirección",value:G.address,onChange:e=>W("address",e.target.value),placeholder:"Ej: Av. Corrientes 1234, CABA"}),r.createElement(w.A,{label:"Notas",value:G.notes,onChange:e=>W("notes",e.target.value),placeholder:"Información adicional sobre el proveedor...",rows:3})),r.createElement("div",{className:"flex justify-end space-x-3 mt-6"},r.createElement(h.A,{variant:"secondary",onClick:()=>{T(!1),L(!1),Y(),B(null)}},"Cancelar"),r.createElement(h.A,{onClick:j?async()=>{if(X()){M(!0);try{(await fetch("/api/providers/add",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(G)})).ok?(C.invalidateProviders(),await K(),T(!1),Y()):console.error("Error al agregar proveedor")}catch(e){console.error("Error:",e)}finally{M(!1)}}}:async()=>{if(X()){M(!0);try{(await fetch("/api/providers/edit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...G,id:$.id})})).ok?(C.invalidateProviders(),await K(),L(!1),Y(),B(null)):console.error("Error al editar proveedor")}catch(e){console.error("Error:",e)}finally{M(!1)}}},loading:F},j?"Agregar Proveedor":"Guardar Cambios"))),r.createElement(y.A,{isOpen:O,onClose:()=>{q(!1),B(null)},title:"Detalles del Proveedor",size:"lg"},$&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6"},r.createElement("div",null,r.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Información General"),r.createElement("dl",{className:"space-y-3"},r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Nombre"),r.createElement("dd",{className:"text-sm text-gray-900"},$.name)),r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Persona de Contacto"),r.createElement("dd",{className:"text-sm text-gray-900"},$.contact_person)),r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Categoría"),r.createElement("dd",{className:"text-sm text-gray-900"},$.category_name||"Sin categoría")),r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Estado"),r.createElement("dd",{className:"text-sm"},r.createElement("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+($.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800")},$.is_active?"Activo":"Inactivo"))))),r.createElement("div",null,r.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-4"},"Información de Contacto"),r.createElement("dl",{className:"space-y-3"},$.phone&&r.createElement("div",{className:"flex items-center"},r.createElement(o.A,{className:"h-5 w-5 text-gray-400 mr-2"}),r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Teléfono"),r.createElement("dd",{className:"text-sm text-gray-900"},$.phone))),$.email&&r.createElement("div",{className:"flex items-center"},r.createElement(m.A,{className:"h-5 w-5 text-gray-400 mr-2"}),r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Email"),r.createElement("dd",{className:"text-sm text-gray-900"},$.email))),$.address&&r.createElement("div",{className:"flex items-center"},r.createElement(g.A,{className:"h-5 w-5 text-gray-400 mr-2"}),r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"Dirección"),r.createElement("dd",{className:"text-sm text-gray-900"},$.address))),$.cuit&&r.createElement("div",{className:"flex items-center"},r.createElement(v.A,{className:"h-5 w-5 text-gray-400 mr-2"}),r.createElement("div",null,r.createElement("dt",{className:"text-sm font-medium text-gray-500"},"CUIT"),r.createElement("dd",{className:"text-sm text-gray-900"},$.cuit)))))),$.notes&&r.createElement("div",null,r.createElement("h3",{className:"text-lg font-medium text-gray-900 mb-2"},"Notas"),r.createElement("div",{className:"bg-gray-50 rounded-lg p-4"},r.createElement("p",{className:"text-sm text-gray-700 whitespace-pre-wrap"},$.notes)))),r.createElement("div",{className:"flex justify-end mt-6"},r.createElement(h.A,{variant:"secondary",onClick:()=>{q(!1),B(null)}},"Cerrar"))),r.createElement(y.A,{isOpen:D,onClose:()=>{V(!1),B(null)},title:"Confirmar Eliminación"},$&&r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-700 mb-4"},"¿Estás seguro de que deseas eliminar el proveedor"," ",r.createElement("strong",null,'"',$.name,'"'),"?"),r.createElement("p",{className:"text-sm text-gray-500"},"Esta acción no se puede deshacer.")),r.createElement("div",{className:"flex justify-end space-x-3 mt-6"},r.createElement(h.A,{variant:"secondary",onClick:()=>{V(!1),B(null)}},"Cancelar"),r.createElement(h.A,{variant:"danger",onClick:async()=>{M(!0);try{(await fetch(`/api/providers/delete/${$.id}`,{method:"POST"})).ok?(C.invalidateProviders(),await K(),V(!1),B(null)):console.error("Error al eliminar proveedor")}catch(e){console.error("Error:",e)}finally{M(!1)}},loading:F},"Eliminar"))))}}}]);