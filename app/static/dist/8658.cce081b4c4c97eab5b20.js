"use strict";(self.webpackChunkvenezia_frontend=self.webpackChunkvenezia_frontend||[]).push([[8658],{68658:function(e,t,a){a.r(t),a.d(t,{default:function(){return Ae}});var r=a(96540),l=a(47767),n=a(48686),s=a(29696),c=a(48110),o=a(67984),m=a(81966),i=a(86589),d=a(50211),u=a(39574),g=a(48697),p=a(44471),x=a(42021),y=a(70700),b=a(42203),E=a(93823),v=a(72284),h=a(11562),N=a(71428),f=a(28219),k=a(67773),w=a(49757),A=a(64905),C=a(58609),S=a(17133),$=a(80697),P=a(20053),_=({product:e,onClick:t,isOutOfStock:a=!1,variant:l="compact"})=>{const n=(()=>{const t=e.category_name?.toLowerCase()||"";return t.includes("helado")?w.A:t.includes("cafe")||t.includes("caf√©")?A.A:t.includes("torta")||t.includes("postre")?C.A:S.A})(),s=()=>{const t=e.category_name?.toLowerCase()||"";return t.includes("helado")?"text-blue-600 bg-blue-50":t.includes("cafe")||t.includes("caf√©")?"text-amber-600 bg-amber-50":t.includes("torta")||t.includes("postre")?"text-pink-600 bg-pink-50":"text-gray-600 bg-gray-50"};return"detailed"===l?r.createElement("button",{onClick:()=>!a&&t(e),disabled:a,"aria-label":`Agregar ${e.name} al carrito`,className:(0,P.A)("relative group bg-white dark:bg-gray-800 border rounded-xl overflow-hidden","transition-all duration-200 hover:shadow-lg","focus-visible:outline focus-visible:outline-2 focus-visible:outline-venezia-500",a?"border-gray-200 dark:border-gray-700 opacity-60 cursor-not-allowed":"border-gray-200 dark:border-gray-700 hover:border-venezia-300 dark:hover:border-venezia-600")},r.createElement("div",{className:(0,P.A)("h-32 flex items-center justify-center",s())},e.image_url?r.createElement("img",{src:e.image_url,alt:e.name,className:"w-full h-full object-cover"}):r.createElement(n,{className:"h-12 w-12",title:`Categor√≠a: ${e.category_name||"Sin categor√≠a"}`})),r.createElement("div",{className:"p-4"},r.createElement("h3",{className:"text-sm font-semibold text-gray-800 dark:text-gray-200 line-clamp-2 mb-1"},e.name),r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement("span",{className:"text-lg font-bold text-venezia-600 dark:text-venezia-400"},"$",e.price),e.max_flavors&&r.createElement("span",{className:"text-xs text-gray-500 dark:text-gray-400"},e.max_flavors," sabores")),void 0!==e.stock&&r.createElement("div",{className:"flex items-center justify-between text-xs"},r.createElement("span",{className:"text-gray-500 dark:text-gray-400"},"Stock:"),r.createElement("span",{className:(0,P.A)("font-medium",e.stock>10?"text-green-600":e.stock>0?"text-yellow-600":"text-red-600")},e.stock>0?e.stock:"Agotado"))),!a&&r.createElement("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 flex items-center justify-center"},r.createElement("div",{className:"bg-venezia-600 text-white rounded-full p-3 transform scale-0 group-hover:scale-100 transition-transform duration-200"},r.createElement($.A,{className:"h-5 w-5"}))),a&&r.createElement("div",{className:"absolute inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center"},r.createElement("span",{className:"bg-red-600 text-white px-3 py-1 rounded-full text-sm font-medium"},"Agotado"))):r.createElement("button",{onClick:()=>!a&&t(e),disabled:a,"aria-label":`Agregar ${e.name} al carrito`,className:(0,P.A)("relative group bg-white dark:bg-gray-800 border rounded-lg p-3","flex flex-col items-center transition-all duration-200","focus-visible:outline focus-visible:outline-2 focus-visible:outline-venezia-500",a?"border-gray-200 dark:border-gray-700 opacity-60 cursor-not-allowed":"border-gray-200 dark:border-gray-700 hover:shadow-md hover:border-venezia-300")},r.createElement("div",{className:(0,P.A)("p-2 rounded-full mb-2",s())},r.createElement(n,{className:"h-5 w-5",title:`Categor√≠a: ${e.category_name||"Sin categor√≠a"}`})),r.createElement("span",{className:"text-xs font-medium text-gray-800 dark:text-gray-200 text-center line-clamp-2"},e.name),r.createElement("span",{className:"text-sm font-bold text-venezia-600 dark:text-venezia-400 mt-1"},"$",e.price),e.max_flavors&&r.createElement("span",{className:"text-[10px] text-gray-500 dark:text-gray-400"},e.max_flavors," sabores"),!a&&r.createElement($.A,{className:"absolute bottom-2 right-2 h-4 w-4 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity"}),a&&r.createElement("span",{className:"absolute top-1 right-1 bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded"},"Agotado"))},j=a(32708),T=a(86241),z=a(75107),I=a(19869),L=a(76069),M=a(3768),q=({cart:e=[],onUpdateQuantity:t,onRemoveItem:a,onCheckout:l,onClearCart:c,onApplyDiscount:o,discount:m=0,paymentMethods:i=[],isMobile:u=!1,onClose:p})=>{const[x,y]=(0,r.useState)(!1),[b,E]=(0,r.useState)({name:"",phone:"",address:"",notes:""}),[f,k]=(0,r.useState)("cash"),[w,A]=(0,r.useState)("percent"),[C,S]=(0,r.useState)(""),_=e.reduce(((e,t)=>e+t.price*t.quantity),0),q="percent"===w?_*(parseFloat(C)||0)/100:parseFloat(C)||0,D=Math.max(0,_-q);return r.createElement("div",{className:"h-full flex flex-col bg-white dark:bg-gray-800 rounded-lg shadow-lg"},r.createElement("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(s.A,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"}),r.createElement("h2",{className:"text-lg font-semibold"},"Carrito (",e.length,")")),r.createElement("div",{className:"flex items-center gap-2"},e.length>0&&r.createElement("button",{onClick:c,className:"p-2 text-gray-400 hover:text-red-600 transition-colors",title:"Vaciar carrito"},r.createElement(j.A,{className:"w-4 h-4"})),u&&r.createElement("button",{onClick:p,className:"p-2 text-gray-400 hover:text-gray-600"},r.createElement(g.A,{className:"w-5 h-5"})))),r.createElement("div",{className:"flex-1 overflow-y-auto p-4 space-y-3"},0===e.length?r.createElement("div",{className:"text-center py-8 text-gray-500"},r.createElement(s.A,{className:"w-12 h-12 mx-auto mb-3 opacity-30"}),r.createElement("p",null,"Carrito vac√≠o")):e.map((e=>r.createElement("div",{key:e.id,className:"bg-gray-50 dark:bg-gray-700 rounded-lg p-3"},r.createElement("div",{className:"flex items-start justify-between mb-2"},r.createElement("div",{className:"flex-1"},r.createElement("h4",{className:"font-medium text-sm"},e.name),e.flavors&&e.flavors.length>0&&r.createElement("p",{className:"text-xs text-gray-500 mt-1"},"Sabores: ",e.flavors.map((e=>e.name)).join(", "))),r.createElement("button",{onClick:()=>a(e.id),className:"p-1 text-gray-400 hover:text-red-600 transition-colors"},r.createElement(g.A,{className:"w-4 h-4"}))),r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement("button",{onClick:()=>t(e.id,Math.max(1,e.quantity-1)),className:"p-1 rounded bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500"},r.createElement(T.A,{className:"w-3 h-3"})),r.createElement("span",{className:"w-8 text-center text-sm font-medium"},e.quantity),r.createElement("button",{onClick:()=>t(e.id,e.quantity+1),className:"p-1 rounded bg-gray-200 dark:bg-gray-600 hover:bg-gray-300 dark:hover:bg-gray-500"},r.createElement($.A,{className:"w-3 h-3"}))),r.createElement("span",{className:"font-semibold"},"$",(e.price*e.quantity).toFixed(2))))))),e.length>0&&r.createElement("div",{className:"border-t dark:border-gray-700 p-4"},r.createElement("button",{onClick:()=>y(!x),className:"w-full flex items-center justify-between p-2 text-left hover:bg-gray-50 dark:hover:bg-gray-700 rounded"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(n.A,{className:"w-4 h-4 text-gray-500"}),r.createElement("span",{className:"text-sm font-medium"},"Informaci√≥n del Cliente")),r.createElement(z.A,{className:(0,P.A)("w-4 h-4 transition-transform",x&&"rotate-180")})),x&&r.createElement("div",{className:"mt-3 space-y-3"},r.createElement(h.A,{placeholder:"Nombre del cliente",value:b.name,onChange:e=>E({...b,name:e.target.value}),icon:n.A}),r.createElement(h.A,{placeholder:"Tel√©fono",value:b.phone,onChange:e=>E({...b,phone:e.target.value}),icon:I.A}),r.createElement(h.A,{placeholder:"Direcci√≥n de entrega",value:b.address,onChange:e=>E({...b,address:e.target.value}),icon:L.A}),r.createElement("textarea",{placeholder:"Notas del pedido",value:b.notes,onChange:e=>E({...b,notes:e.target.value}),className:"w-full px-3 py-2 text-sm border rounded-md resize-none",rows:"2"}))),e.length>0&&r.createElement("div",{className:"border-t dark:border-gray-700 p-4"},r.createElement("div",{className:"flex items-center gap-2 mb-2"},r.createElement(M.A,{className:"w-4 h-4 text-gray-500"}),r.createElement("span",{className:"text-sm font-medium"},"Descuento")),r.createElement("div",{className:"flex gap-2"},r.createElement(N.A,{value:w,onChange:e=>A(e.target.value),className:"w-24",options:[{value:"percent",label:"%"},{value:"amount",label:"$"}]}),r.createElement(h.A,{type:"number",placeholder:"0",value:C,onChange:e=>S(e.target.value),className:"flex-1"}),r.createElement(v.A,{onClick:()=>{o({type:w,value:parseFloat(C)||0,amount:q})},size:"sm",variant:"outline"},"Aplicar"))),e.length>0&&r.createElement("div",{className:"border-t dark:border-gray-700 p-4 space-y-3"},r.createElement("div",{className:"space-y-2"},r.createElement("label",{className:"text-sm font-medium text-gray-700 dark:text-gray-300"},"M√©todo de Pago"),r.createElement(N.A,{value:f,onChange:e=>k(e.target.value),options:[{value:"cash",label:"Efectivo"},{value:"card",label:"Tarjeta"},{value:"transfer",label:"Transferencia"},{value:"mercadopago",label:"MercadoPago"}],icon:d.A})),r.createElement("div",{className:"space-y-2 py-2"},r.createElement("div",{className:"flex justify-between text-sm"},r.createElement("span",{className:"text-gray-600"},"Subtotal"),r.createElement("span",null,"$",_.toFixed(2))),q>0&&r.createElement("div",{className:"flex justify-between text-sm text-green-600"},r.createElement("span",null,"Descuento"),r.createElement("span",null,"-$",q.toFixed(2))),r.createElement("div",{className:"flex justify-between text-lg font-bold pt-2 border-t dark:border-gray-700"},r.createElement("span",null,"Total"),r.createElement("span",{className:"text-venezia-600"},"$",D.toFixed(2)))),r.createElement(v.A,{onClick:()=>{l({items:e,subtotal:_,discount:q,total:D,paymentMethod:f,customer:x?b:null})},variant:"primary",className:"w-full",icon:d.A},"Procesar Venta")))},D=a(67561),F=a(3385),V=a(98445),O=a(76316),R=({products:e,onProductSelect:t,recentSales:a=[],topProducts:l=[]})=>{const[n,s]=(0,r.useState)(!1),[c,o]=(0,r.useState)(""),[m,i]=(0,r.useState)(0),[d,u]=(0,r.useState)([]),p=(0,r.useRef)(null),x=(0,r.useRef)(null);(0,r.useEffect)((()=>{const t=setTimeout((()=>{if(c.trim()){const t=e.filter((e=>e.name.toLowerCase().includes(c.toLowerCase())||e.barcode?.includes(c))).slice(0,8);u(t)}else u([])}),200);return()=>clearTimeout(t)}),[c,e]);const y=(0,r.useCallback)((e=>{const t=d.length||(c?0:l.length);switch(e.key){case"ArrowDown":e.preventDefault(),i((e=>(e+1)%t));break;case"ArrowUp":e.preventDefault(),i((e=>(e-1+t)%t));break;case"Enter":e.preventDefault(),d.length>0?b(d[m]):!c&&l.length>0&&b(l[m]);break;case"Escape":s(!1),p.current?.blur()}}),[d,m,c,l]),b=e=>{t(e),o(""),s(!1),i(0),p.current?.focus()};return(0,r.useEffect)((()=>{const e=e=>{x.current&&!x.current.contains(e.target)&&s(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]),(0,r.useEffect)((()=>{const e=e=>{"F2"===e.key&&(e.preventDefault(),p.current?.focus(),s(!0))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[]),r.createElement("div",{className:"relative w-full",ref:x},r.createElement("div",{className:"relative"},r.createElement(V.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),r.createElement("input",{ref:p,type:"text",value:c,onChange:e=>o(e.target.value),onFocus:()=>s(!0),onKeyDown:y,placeholder:"Buscar producto... (F2)",className:(0,P.A)("w-full pl-10 pr-10 py-3","bg-white dark:bg-gray-800","border-2 border-gray-200 dark:border-gray-700","rounded-xl","focus:border-blue-500 focus:outline-none","transition-all duration-200",n&&"border-blue-500 shadow-lg")}),c&&r.createElement("button",{onClick:()=>o(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded"},r.createElement(g.A,{className:"h-4 w-4 text-gray-400"})),r.createElement("div",{className:"absolute right-12 top-1/2 transform -translate-y-1/2 text-xs text-gray-400 font-mono"},"F2")),r.createElement(D.N,null,n&&r.createElement(F.P.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},className:(0,P.A)("absolute z-50 w-full mt-2","bg-white dark:bg-gray-800","border-2 border-gray-200 dark:border-gray-700","rounded-xl shadow-2xl","max-h-96 overflow-auto")},c&&d.length>0?r.createElement("div",{className:"p-2"},r.createElement("div",{className:"text-xs font-medium text-gray-500 dark:text-gray-400 px-3 py-1"},"Resultados (",d.length,")"),d.map(((e,t)=>r.createElement(F.P.button,{key:e.id,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*t},onClick:()=>b(e),onMouseEnter:()=>i(t),className:(0,P.A)("w-full flex items-center gap-3 p-3 rounded-lg","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors duration-150",m===t&&"bg-blue-50 dark:bg-blue-900/30")},r.createElement("div",{className:"p-2 bg-gray-100 dark:bg-gray-700 rounded"},r.createElement(S.A,{className:"h-4 w-4 text-gray-600 dark:text-gray-400"})),r.createElement("div",{className:"flex-1 text-left"},r.createElement("div",{className:"font-medium text-gray-900 dark:text-white"},e.name),r.createElement("div",{className:"text-sm text-gray-500 dark:text-gray-400"},"$",e.price," ¬∑ Stock: ",e.stock)),m===t&&r.createElement("div",{className:"text-xs text-gray-400"},"Enter"))))):c&&0===d.length?r.createElement("div",{className:"p-8 text-center text-gray-500 dark:text-gray-400"},r.createElement(S.A,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),r.createElement("p",null,"No se encontraron productos")):r.createElement("div",{className:"p-2"},l.length>0&&r.createElement(r.Fragment,null,r.createElement("div",{className:"flex items-center gap-2 text-xs font-medium text-gray-500 dark:text-gray-400 px-3 py-1"},r.createElement(O.A,{className:"h-3 w-3"}),"M√°s vendidos"),l.slice(0,5).map(((e,t)=>r.createElement(F.P.button,{key:e.id,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*t},onClick:()=>b(e),onMouseEnter:()=>i(t),className:(0,P.A)("w-full flex items-center gap-3 p-3 rounded-lg","hover:bg-gray-100 dark:hover:bg-gray-700","transition-colors duration-150",m===t&&"bg-blue-50 dark:bg-blue-900/30")},r.createElement("div",{className:"p-2 bg-green-100 dark:bg-green-900/30 rounded"},r.createElement(O.A,{className:"h-4 w-4 text-green-600 dark:text-green-400"})),r.createElement("div",{className:"flex-1 text-left"},r.createElement("div",{className:"font-medium text-gray-900 dark:text-white"},e.name),r.createElement("div",{className:"text-sm text-gray-500 dark:text-gray-400"},"$",e.price)),r.createElement("div",{className:"text-xs text-gray-400"},t+1))))),r.createElement("div",{className:"border-t border-gray-200 dark:border-gray-700 mt-2 pt-2 px-3 pb-2"},r.createElement("div",{className:"flex gap-4 text-xs text-gray-500 dark:text-gray-400"},r.createElement("span",null,"‚Üë‚Üì Navegar"),r.createElement("span",null,"Enter Seleccionar"),r.createElement("span",null,"Esc Cerrar")))))))},Q=a(27235),H=a(15977),B=({orders:e=[],onRepeatOrder:t,maxOrders:a=5})=>{const l=e.slice(0,a);return 0===l.length?null:r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-4"},r.createElement("div",{className:"flex items-center gap-2 mb-3"},r.createElement(Q.A,{className:"h-4 w-4 text-gray-400"}),r.createElement("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300"},"√öltimas Ventas")),r.createElement("div",{className:"space-y-2"},l.map(((e,a)=>r.createElement(F.P.div,{key:e.id,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*a},className:(0,P.A)("flex items-center justify-between p-3 rounded-lg","bg-gray-50 dark:bg-gray-900/50","hover:bg-gray-100 dark:hover:bg-gray-900/70","transition-colors duration-150 group")},r.createElement("div",{className:"flex-1 min-w-0"},r.createElement("div",{className:"flex items-center gap-2"},e.customer_name&&r.createElement("div",{className:"flex items-center gap-1 text-sm text-gray-600 dark:text-gray-400"},r.createElement(n.A,{className:"h-3 w-3"}),r.createElement("span",{className:"truncate"},e.customer_name)),r.createElement("span",{className:"text-xs text-gray-400"},(e=>{const t=new Date,a=new Date(e),r=t-a,l=Math.floor(r/6e4),n=Math.floor(r/36e5);return l<1?"Reci√©n":l<60?`Hace ${l}m`:n<24?`Hace ${n}h`:a.toLocaleDateString()})(e.created_at))),r.createElement("div",{className:"mt-1"},r.createElement("div",{className:"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400"},r.createElement(S.A,{className:"h-3 w-3"}),r.createElement("span",null,e.items_count," items ¬∑ $",e.total)),r.createElement("div",{className:"text-xs text-gray-400 dark:text-gray-500 mt-1 truncate"},e.items_preview))),r.createElement(F.P.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t(e),className:(0,P.A)("p-2 rounded-lg","bg-blue-100 dark:bg-blue-900/30","text-blue-600 dark:text-blue-400","opacity-0 group-hover:opacity-100","transition-all duration-200"),title:"Repetir pedido"},r.createElement(H.A,{className:"h-4 w-4"})))))),r.createElement("div",{className:"mt-3 text-xs text-gray-400 dark:text-gray-500 text-center"},"Click en ",r.createElement(H.A,{className:"h-3 w-3 inline"})," para repetir pedido"))},G=a(46858),U=({products:e=[],onProductSelect:t,maxProducts:a=9})=>{const l=e.slice(0,a);return(0,r.useEffect)((()=>{const e=e=>{if("INPUT"===document.activeElement.tagName||"TEXTAREA"===document.activeElement.tagName)return;const a=parseInt(e.key);a>=1&&a<=9&&l[a-1]&&(e.preventDefault(),t(l[a-1]))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[l,t]),0===l.length?null:r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-sm border border-gray-200 dark:border-gray-700 p-4"},r.createElement("div",{className:"flex items-center gap-2 mb-3"},r.createElement(G.A,{className:"h-4 w-4 text-yellow-500"}),r.createElement("h3",{className:"text-sm font-medium text-gray-700 dark:text-gray-300"},"Acceso R√°pido"),r.createElement("span",{className:"text-xs text-gray-400"},"(Teclas 1-9)")),r.createElement("div",{className:"grid grid-cols-3 gap-2"},l.map(((e,a)=>r.createElement(F.P.button,{key:e.id,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{delay:.05*a},whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>t(e),className:(0,P.A)("relative p-3 rounded-lg","bg-gray-50 dark:bg-gray-900/50","hover:bg-gray-100 dark:hover:bg-gray-900/70","border border-gray-200 dark:border-gray-700","transition-all duration-150","group")},r.createElement("div",{className:(0,P.A)("absolute top-1 right-1","w-6 h-6 rounded-full","bg-blue-100 dark:bg-blue-900/30","text-blue-600 dark:text-blue-400","text-xs font-bold","flex items-center justify-center")},a+1),r.createElement("div",{className:"flex flex-col items-center gap-2"},r.createElement("div",{className:(0,P.A)("p-2 rounded-lg","bg-gray-100 dark:bg-gray-800","group-hover:bg-blue-100 dark:group-hover:bg-blue-900/30","transition-colors duration-150")},r.createElement(S.A,{className:"h-5 w-5 text-gray-600 dark:text-gray-400 group-hover:text-blue-600 dark:group-hover:text-blue-400"})),r.createElement("div",{className:"text-center"},r.createElement("div",{className:"text-sm font-medium text-gray-900 dark:text-white line-clamp-1"},e.name),r.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400"},"$",e.price))),e.stock<=5&&r.createElement("div",{className:(0,P.A)("absolute bottom-1 left-1","w-2 h-2 rounded-full",0===e.stock?"bg-red-500":"bg-yellow-500","animate-pulse")}))))),r.createElement("div",{className:"mt-3 text-xs text-gray-400 dark:text-gray-500 text-center"},"Presiona 1-9 para agregar r√°pidamente"))},W=a(418),J=a(71429),K=({cashAvailable:e=0,lowCashThreshold:t=500,criticalCashThreshold:a=100,className:l=""})=>{const[n,s]=(0,r.useState)("normal"),[c,o]=(0,r.useState)(!1);(0,r.useEffect)((()=>{let r="normal";e<=a?r="critical":e<=t&&(r="warning"),r!==n&&(o(!0),setTimeout((()=>o(!1)),500)),s(r)}),[e,t,a,n]);const m=(()=>{switch(n){case"critical":return{color:"text-red-600 dark:text-red-400",bg:"bg-red-50 dark:bg-red-900/20",border:"border-red-200 dark:border-red-800",icon:W.A,label:"Efectivo Cr√≠tico",message:"¬°Necesitas m√°s billetes chicos!",pulse:!0};case"warning":return{color:"text-yellow-600 dark:text-yellow-400",bg:"bg-yellow-50 dark:bg-yellow-900/20",border:"border-yellow-200 dark:border-yellow-800",icon:J.A,label:"Efectivo Bajo",message:"Considera reponer billetes",pulse:!1};default:return{color:"text-green-600 dark:text-green-400",bg:"bg-green-50 dark:bg-green-900/20",border:"border-green-200 dark:border-green-800",icon:p.A,label:"Efectivo OK",message:"Suficiente para dar cambio",pulse:!1}}})(),i=m.icon;return r.createElement(F.P.div,{className:(0,P.A)("flex items-center gap-3 p-3 rounded-lg border-2",m.bg,m.border,"transition-all duration-300",l),animate:c?{scale:[1,1.05,1]}:{},transition:{duration:.5}},r.createElement("div",{className:"relative"},r.createElement(i,{className:(0,P.A)("h-5 w-5",m.color)}),m.pulse&&r.createElement(F.P.div,{className:"absolute inset-0",animate:{scale:[1,1.3,1],opacity:[.7,0,.7]},transition:{duration:1.5,repeat:1/0}},r.createElement(i,{className:(0,P.A)("h-5 w-5",m.color)}))),r.createElement("div",{className:"flex-1"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("span",{className:(0,P.A)("text-sm font-medium",m.color)},m.label),r.createElement("span",{className:(0,P.A)("text-lg font-bold",m.color)},"$",e.toFixed(0))),r.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400"},m.message)),r.createElement("div",{className:"w-16"},r.createElement("div",{className:"w-full h-2 bg-gray-200 dark:bg-gray-700 rounded-full overflow-hidden"},r.createElement(F.P.div,{initial:{width:0},animate:{width:`${Math.min(e/(2*t)*100,100)}%`},transition:{duration:.5},className:(0,P.A)("h-full rounded-full transition-colors duration-300","critical"===n&&"bg-red-500","warning"===n&&"bg-yellow-500","normal"===n&&"bg-green-500")})),r.createElement("div",{className:"text-xs text-gray-400 text-center mt-1"},"Cambio")))},X=a(47792);const Y=({title:e,value:t,icon:a,trend:l,color:n="blue",isLoading:s=!1})=>r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-4 shadow-sm border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400"},e),r.createElement("div",{className:"flex items-center gap-2"},s?r.createElement(E.A,{size:"sm"}):r.createElement("p",{className:`text-2xl font-bold text-${n}-600 dark:text-${n}-400`},t),l&&r.createElement("span",{className:"text-xs flex items-center gap-1 "+(l>0?"text-green-600":"text-red-600")},r.createElement(O.A,{className:"h-3 w-3"}),l>0?"+":"",l,"%"))),r.createElement("div",{className:`p-3 bg-${n}-100 dark:bg-${n}-900/20 rounded-lg`},r.createElement(a,{className:`h-6 w-6 text-${n}-600 dark:text-${n}-400`}))));var Z=({className:e=""})=>{const{data:t,loading:a}=(0,y.Wl)("/api/pos/live-metrics",{refreshInterval:3e4}),l=t?.data||{};return r.createElement("div",{className:`space-y-4 ${e}`},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white"},"üìä M√©tricas en Vivo"),r.createElement("div",{className:"flex items-center gap-2 text-sm text-gray-500 dark:text-gray-400"},r.createElement(Q.A,{className:"h-4 w-4"}),r.createElement("span",null,"Actualizado cada 30s"))),r.createElement("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4"},r.createElement(Y,{title:"Ventas Hoy",value:`$${l.todaySales?.toFixed(2)||"0.00"}`,icon:i.A,color:"green",isLoading:a}),r.createElement(Y,{title:"Ticket Promedio",value:`$${l.avgTicket?.toFixed(2)||"0.00"}`,icon:X.A,color:"blue",isLoading:a}),r.createElement(Y,{title:"Productos Vendidos",value:l.itemsSold||0,icon:s.A,color:"purple",isLoading:a}),r.createElement(Y,{title:"Eficiencia",value:`${l.efficiency||0} v/h`,icon:O.A,color:"orange",isLoading:a})),l.deliveries&&(l.deliveries.total>0||l.deliveries.pending>0)&&r.createElement("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4"},r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white mb-3 flex items-center gap-2"},r.createElement(m.A,{className:"h-4 w-4"}),"Estado de Deliveries Hoy"),r.createElement("div",{className:"grid grid-cols-3 gap-4"},r.createElement("div",{className:"text-center"},r.createElement("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400"},l.deliveries.total||0),r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},"Total")),r.createElement("div",{className:"text-center"},r.createElement("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400"},l.deliveries.pending||0),r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},"Pendientes")),r.createElement("div",{className:"text-center"},r.createElement("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400"},l.deliveries.in_transit||0),r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},"En Tr√°nsito")))),r.createElement("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4"},r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white mb-2"},"üí° Insights R√°pidos"),r.createElement("div",{className:"space-y-1 text-sm text-gray-600 dark:text-gray-400"},l.salesCount>0?r.createElement(r.Fragment,null,r.createElement("p",null,"‚Ä¢ Llevas ",l.salesCount," ventas realizadas hoy"),r.createElement("p",null,"‚Ä¢ Tu eficiencia actual es ",l.efficiency," ventas por hora"),l.avgTicket>50&&r.createElement("p",{className:"text-green-600 dark:text-green-400"},"‚Ä¢ ¬°Excelente ticket promedio!")):r.createElement("p",null,"‚Ä¢ ¬°A√∫n no hay ventas hoy! Es momento de empezar üöÄ"))))},ee=a(42640),te=a(54687),ae=a(64997),re=a(77579),le=({cart:e=[],className:t=""})=>{let a,l;try{const e=(0,re.oP)();a=e.sendMessage,l=e.isLoading}catch(e){console.warn("POSAIAssistant: AIChatProvider no disponible, usando fallback"),a=async()=>console.log("AI Chat no disponible"),l=!1}const[n,s]=(0,r.useState)(!1),c=(()=>{const t=[];return e.length>0?(t.push("¬øQu√© puedo sugerir para aumentar esta venta?"),e.some((e=>e.name?.toLowerCase().includes("helado")||e.category?.toLowerCase().includes("helado")))&&t.push("¬øQu√© complementos van bien con estos helados?"),e.length>=3&&t.push("¬øPuedo ofrecer alg√∫n descuento por volumen?")):t.push("¬øQu√© promociones puedo ofrecer hoy?"),[...t,"¬øCu√°l es el helado m√°s vendido hoy?","¬øC√≥mo van las ventas vs ayer?","¬øQu√© sabores est√°n por agotarse?","¬øCu√°l es mi mejor horario de ventas?"].slice(0,6)})();return n?r.createElement("div",{className:`bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-lg p-4 ${t}`},r.createElement("div",{className:"flex items-center justify-between mb-3"},r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2"},r.createElement(ee.A,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"}),"ü§ñ Asistente IA"),r.createElement("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-gray-600 dark:hover:text-gray-300"},"‚úï")),e.length>0&&r.createElement("div",{className:"mb-3 p-2 bg-white/50 dark:bg-gray-800/50 rounded-lg"},r.createElement("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-1"},"Carrito actual:"),r.createElement("p",{className:"text-sm font-medium text-gray-900 dark:text-white"},e.slice(0,2).map((e=>`${e.name} x${e.quantity}`)).join(", "),e.length>2&&` +${e.length-2} m√°s`)),r.createElement("div",{className:"space-y-2"},r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3"},"üí° Preguntas sugeridas:"),r.createElement("div",{className:"grid grid-cols-1 gap-2"},c.map(((t,n)=>{const c=[G.A,O.A,S.A,ae.A,te.A,ee.A],o=c[n%c.length];return r.createElement("button",{key:n,onClick:()=>(async t=>{let r=t;e.length>0&&t.includes("esta venta")&&(r=`${t} Mi carrito actual tiene: ${e.map((e=>`${e.name} x${e.quantity}`)).join(", ")}`),await a(r),s(!1)})(t),disabled:l,className:"text-left p-2 bg-white dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-600 hover:border-purple-300 dark:hover:border-purple-500 transition-colors text-sm disabled:opacity-50 disabled:cursor-not-allowed"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(o,{className:"h-3 w-3 text-purple-600 dark:text-purple-400 flex-shrink-0"}),r.createElement("span",{className:"text-gray-900 dark:text-white"},t)))}))),l&&r.createElement("div",{className:"flex items-center justify-center py-4"},r.createElement(E.A,{size:"sm"}),r.createElement("span",{className:"ml-2 text-sm text-gray-600 dark:text-gray-400"},"Consultando...")),r.createElement("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600"},r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center"},"üí¨ Para preguntas m√°s detalladas, usa el chat principal")))):r.createElement("div",{className:`bg-gradient-to-r from-purple-50 to-blue-50 dark:from-purple-900/20 dark:to-blue-900/20 rounded-lg p-3 ${t}`},r.createElement("button",{onClick:()=>s(!0),className:"w-full flex items-center justify-between text-left hover:bg-white/50 dark:hover:bg-gray-800/50 rounded-lg p-2 transition-colors"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement("div",{className:"p-2 bg-purple-100 dark:bg-purple-900/30 rounded-lg"},r.createElement(ee.A,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"})),r.createElement("div",null,r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white"},"ü§ñ Asistente IA"),r.createElement("p",{className:"text-xs text-gray-600 dark:text-gray-400"},"Preguntas r√°pidas sobre ventas"))),r.createElement(te.A,{className:"h-4 w-4 text-purple-600 dark:text-purple-400"})))},ne=a(46110),se=({cart:e=[],products:t=[],onProductSelect:a,className:l=""})=>{const n=(0,r.useMemo)((()=>{if(0===e.length)return[];const a=e.map((e=>e.name?.toLowerCase()||"")),r=e.map((e=>e.category?.toLowerCase()||"")),l=[];a.some((e=>e.includes("helado")||e.includes("gelato")||r.includes("helado")))&&l.push({reason:"Complementa tu helado",keywords:["cono","topping","salsa","granillo","chispas","crema"],priority:3}),a.some((e=>e.includes("batido")||e.includes("smoothie")||e.includes("milkshake")))&&l.push({reason:"Perfecto con tu bebida",keywords:["galleta","waffle","brownie","alfajor","snack"],priority:2}),1===e.length&&l.push({reason:"Agrega otro sabor",keywords:["helado","gelato","sabor"],priority:2}),e.reduce(((e,t)=>e+t.price*t.quantity),0)>500&&l.push({reason:"Productos premium",keywords:["premium","especial","gourmet","artesanal"],priority:3}),e.length>=2&&l.push({reason:"Completa la promo",keywords:["combo","pack","familiar","promo"],priority:2});const n=[];return l.forEach((a=>{t.filter((t=>{const r=t.name?.toLowerCase()||"",l=t.description?.toLowerCase()||"";return!e.some((e=>e.id===t.id))&&a.keywords.some((e=>r.includes(e)||l.includes(e)))})).slice(0,2).forEach((e=>{n.find((t=>t.id===e.id))||n.push({...e,suggestion_reason:a.reason,priority:a.priority})}))})),n.sort(((e,t)=>t.priority-e.priority)).slice(0,4)}),[e,t]);return 0===n.length?null:r.createElement("div",{className:`bg-gradient-to-r from-blue-50 to-purple-50 dark:from-blue-900/20 dark:to-purple-900/20 rounded-lg p-4 ${l}`},r.createElement("div",{className:"flex items-center gap-2 mb-3"},r.createElement(ne.A,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white"},"üí° Sugerencias para aumentar venta")),r.createElement("div",{className:"space-y-3"},n.map((e=>{const t=(l=e.suggestion_reason,{"Complementa tu helado":ne.A,"Perfecto con tu bebida":X.A,"Agrega otro sabor":$.A,"Productos premium":O.A,"Completa la promo":X.A}[l]||$.A);var l;const n=(e=>({"Complementa tu helado":"purple","Perfecto con tu bebida":"blue","Agrega otro sabor":"green","Productos premium":"yellow","Completa la promo":"red"}[e]||"gray"))(e.suggestion_reason);return r.createElement("div",{key:e.id,className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement("div",{className:"flex-1"},r.createElement("div",{className:"flex items-center gap-2 mb-1"},r.createElement(f.A,{variant:n,size:"sm"},r.createElement(t,{className:"h-3 w-3 mr-1"}),e.suggestion_reason)),r.createElement("h5",{className:"font-medium text-gray-900 dark:text-white text-sm"},e.name),r.createElement("p",{className:"text-sm font-semibold text-green-600 dark:text-green-400"},"$",e.price?.toFixed(2)||"0.00")),r.createElement(v.A,{variant:"outline",size:"sm",onClick:()=>a(e),className:"flex items-center gap-1 bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-700 hover:bg-blue-100 dark:hover:bg-blue-900/40"},r.createElement($.A,{className:"h-3 w-3"}),"Agregar")),e.description&&r.createElement("p",{className:"text-xs text-gray-600 dark:text-gray-400"},e.description))}))),r.createElement("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600"},r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center"},"‚ú® Sugerencias basadas en tendencias de venta y combinaciones populares")))},ce=a(37946),oe=({className:e=""})=>{const{data:t,loading:a}=(0,y.Wl)("/api/deliveries/active",{refreshInterval:6e4}),l=Array.isArray(t)?t:[];return a?r.createElement("div",{className:`bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 ${e}`},r.createElement("div",{className:"flex items-center justify-center"},r.createElement(E.A,{size:"sm"}),r.createElement("span",{className:"ml-2 text-sm text-gray-600 dark:text-gray-400"},"Cargando deliveries..."))):r.createElement("div",{className:`bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4 ${e}`},r.createElement("div",{className:"flex items-center justify-between mb-3"},r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2"},r.createElement(m.A,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"}),"üöö Deliveries Activos"),r.createElement(f.A,{variant:"warning",size:"sm"},l.length)),0===l.length?r.createElement("div",{className:"text-center py-4"},r.createElement(m.A,{className:"h-8 w-8 text-gray-400 mx-auto mb-2"}),r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"No hay deliveries activos"),r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-500"},"Los nuevos deliveries aparecer√°n aqu√≠")):r.createElement("div",{className:"space-y-3"},l.slice(0,5).map((e=>{const t=(e=>{const t={pending:{label:"Pendiente",variant:"default",icon:Q.A,color:"text-yellow-600 dark:text-yellow-400"},assigned:{label:"Asignado",variant:"info",icon:n.A,color:"text-blue-600 dark:text-blue-400"},in_transit:{label:"En Tr√°nsito",variant:"warning",icon:m.A,color:"text-orange-600 dark:text-orange-400"},delivered:{label:"Entregado",variant:"success",icon:p.A,color:"text-green-600 dark:text-green-400"},failed:{label:"Fallido",variant:"danger",icon:ce.A,color:"text-red-600 dark:text-red-400"}};return t[e]||t.pending})(e.status),a=t.icon;return r.createElement("div",{key:e.id,className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-start justify-between mb-2"},r.createElement("div",{className:"flex-1"},r.createElement("div",{className:"flex items-center gap-2 mb-1"},r.createElement("span",{className:"font-medium text-sm text-gray-900 dark:text-white"},"#",e.order_number||e.id),r.createElement(f.A,{variant:t.variant,size:"sm"},r.createElement(a,{className:"h-3 w-3 mr-1"}),t.label)),r.createElement("div",{className:"space-y-1"},r.createElement("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400"},r.createElement(n.A,{className:"h-3 w-3"}),r.createElement("span",null,e.customer_name)),e.address&&r.createElement("div",{className:"flex items-start gap-1 text-xs text-gray-600 dark:text-gray-400"},r.createElement(L.A,{className:"h-3 w-3 mt-0.5 flex-shrink-0"}),r.createElement("span",{className:"line-clamp-2"},"string"==typeof e.address?e.address:`${e.address?.street||""} ${e.address?.number||""}`)),r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",{className:"flex items-center gap-1 text-xs text-gray-600 dark:text-gray-400"},r.createElement(Q.A,{className:"h-3 w-3"}),r.createElement("span",null,(l=e.created_at,new Date(l).toLocaleTimeString("es-AR",{hour:"2-digit",minute:"2-digit"})))),r.createElement("span",{className:"text-sm font-semibold text-green-600 dark:text-green-400"},"$",e.total_amount?.toFixed(2)||"0.00"))))),e.estimated_time&&r.createElement("div",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400 bg-blue-50 dark:bg-blue-900/20 rounded px-2 py-1"},"üïí Tiempo estimado: ",e.estimated_time));var l})),l.length>5&&r.createElement("div",{className:"text-center pt-2"},r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400"},"+",l.length-5," deliveries m√°s..."))),r.createElement("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600"},r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center"},"üì± Se actualiza autom√°ticamente cada minuto")))},me=a(43197),ie=a(21767),de=a(41181),ue=a(32307),ge=a(93893),pe=({cart:e=[],customer:t=null,onApplyDiscount:a,className:l=""})=>{const n=(0,r.useMemo)((()=>{if(0===e.length)return[];const a=e.reduce(((e,t)=>e+t.price*t.quantity),0),r=e.reduce(((e,t)=>e+t.quantity),0),l=e.length,n=[],s=(new Date).getHours(),c=(new Date).getDay();if(r>=5&&n.push({id:"bulk_discount",type:"percent",value:r>=10?20:15,title:(r>=10?"20%":"15%")+" por Volumen",description:`Compraste ${r} productos`,reason:"bulk",priority:3,icon:me.A,color:"purple",condition:`${r} productos o m√°s`}),a>=500){const e=a>=1e3?15:10;n.push({id:"amount_discount",type:"percent",value:e,title:`${e}% por Monto Alto`,description:`Compra de $${a.toFixed(2)}`,reason:"amount",priority:3,icon:ie.A,color:"green",condition:"Compras sobre $"+(a>=1e3?"1000":"500")})}(t?.total_orders>=10||t?.total_spent>=2e3)&&n.push({id:"vip_discount",type:"percent",value:25,title:"25% Cliente VIP",description:`${t.total_orders} √≥rdenes | $${t.total_spent} gastado`,reason:"vip",priority:4,icon:de.A,color:"yellow",condition:"Cliente frecuente"}),s>=14&&s<=17&&n.push({id:"happy_hour",type:"percent",value:10,title:"10% Happy Hour",description:"Promoci√≥n de tarde (14-17hs)",reason:"time",priority:2,icon:ue.A,color:"blue",condition:"V√°lido hasta las 17:00"});const o=e.some((e=>e.name?.toLowerCase().includes("helado")||e.category?.toLowerCase().includes("helado"))),m=e.some((e=>e.name?.toLowerCase().includes("cono")||e.name?.toLowerCase().includes("topping")||e.category?.toLowerCase().includes("complemento")));return o&&m&&n.push({id:"combo_discount",type:"fixed",value:50,title:"$50 Combo Helader√≠a",description:"Helado + Complemento",reason:"combo",priority:2,icon:ie.A,color:"orange",condition:"Helado + Cono/Topping"}),0!==c&&6!==c||n.push({id:"weekend_special",type:"percent",value:12,title:"12% Especial Fin de Semana",description:"Promoci√≥n de weekend",reason:"weekend",priority:2,icon:ue.A,color:"pink",condition:"Solo s√°bados y domingos"}),l>=3&&n.push({id:"variety_discount",type:"percent",value:8,title:"8% por Variedad",description:`${l} productos diferentes`,reason:"variety",priority:1,icon:ge.A,color:"teal",condition:"3 o m√°s productos diferentes"}),n.sort(((e,t)=>t.priority-e.priority)).slice(0,3)}),[e,t]),s=(0,r.useMemo)((()=>{if(0===n.length)return null;const t=e.reduce(((e,t)=>e+t.price*t.quantity),0);return n.reduce(((e,a)=>("percent"===a.type?t*(a.value/100):a.value)>("percent"===e.type?t*(e.value/100):e.value)?a:e))}),[n,e]);return 0===n.length?null:r.createElement("div",{className:`bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 rounded-lg p-4 ${l}`},r.createElement("div",{className:"flex items-center gap-2 mb-3"},r.createElement(M.A,{className:"h-4 w-4 text-green-600 dark:text-green-400"}),r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white"},"üéâ Descuentos Disponibles"),s&&r.createElement(f.A,{variant:"success",size:"sm"},"Mejor: ","percent"===s.type?`${s.value}%`:`$${s.value}`)),r.createElement("div",{className:"space-y-3"},n.map((t=>{const l=(n=t.reason,{bulk:me.A,amount:ie.A,vip:de.A,time:ue.A,combo:ie.A,weekend:ue.A,variety:ge.A}[n]||M.A);var n;const s=e.reduce(((e,t)=>e+t.price*t.quantity),0),c="percent"===t.type?s*(t.value/100):t.value;return r.createElement("div",{key:t.id,className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(f.A,{variant:t.color,size:"sm"},r.createElement(l,{className:"h-3 w-3 mr-1"}),t.title),r.createElement("span",{className:"text-sm font-semibold text-green-600 dark:text-green-400"},"Ahorras: $",c.toFixed(2))),r.createElement(v.A,{variant:"outline",size:"sm",onClick:()=>a(t),className:"flex items-center gap-1 bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-700 hover:bg-green-100 dark:hover:bg-green-900/40"},r.createElement(me.A,{className:"h-3 w-3"}),"Aplicar")),r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1"},t.description),r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-500"},"üìã Condici√≥n: ",t.condition))}))),r.createElement("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600"},r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center"},"üí° Los descuentos se calculan autom√°ticamente seg√∫n tus compras")))},xe=({cart:e=[],products:t=[],onAddToCart:a,className:l=""})=>{const n=(0,r.useMemo)((()=>{if(!Array.isArray(t)||0===t.length)return null;const a={lowStock:[],criticalStock:[],outOfStock:[],cartImpact:[],restockSuggestions:[]};return t.forEach((t=>{const r=t.current_stock||0,l=t.minimum_stock||10,n=e.find((e=>e.id===t.id))?.quantity||0,s=r-n;0===r?a.outOfStock.push({...t,urgency:"critical",message:"Sin stock disponible"}):r<=.3*l?a.criticalStock.push({...t,urgency:"critical",stockLevel:r,daysLeft:Math.floor(r/3),message:`Solo ${r} unidades restantes`}):r<=l&&a.lowStock.push({...t,urgency:"medium",stockLevel:r,daysLeft:Math.floor(r/2),message:`Stock bajo: ${r}/${l}`}),n>0&&s<=l&&a.cartImpact.push({...t,cartQuantity:n,stockAfterCart:s,impact:s<=0?"critical":"warning",message:`Quedar√°n ${s} unidades tras la venta`})})),[...a.criticalStock,...a.lowStock].sort(((e,t)=>e.stockLevel-t.stockLevel)).slice(0,5).forEach((e=>{const t=Math.max(2*e.minimum_stock,50);a.restockSuggestions.push({...e,suggestedQuantity:t,estimatedCost:(e.unit_cost||50)*t,priority:"critical"===e.urgency?"high":"medium"})})),a}),[t,e]);if(!n)return null;const c=n.criticalStock.length+n.lowStock.length+n.outOfStock.length+n.cartImpact.length;return 0===c?null:r.createElement("div",{className:`bg-gradient-to-r from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20 rounded-lg p-4 ${l}`},r.createElement("div",{className:"flex items-center gap-2 mb-3"},r.createElement(S.A,{className:"h-4 w-4 text-amber-600 dark:text-amber-400"}),r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white"},"üì¶ Gesti√≥n Inteligente de Stock"),r.createElement(f.A,{variant:"warning",size:"sm"},c," alertas")),r.createElement("div",{className:"space-y-3"},n.criticalStock.length>0&&r.createElement("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3 border border-red-200 dark:border-red-700"},r.createElement("div",{className:"flex items-center gap-2 mb-2"},r.createElement(W.A,{className:"h-4 w-4 text-red-600 dark:text-red-400"}),r.createElement("span",{className:"font-medium text-red-900 dark:text-red-100"},"üö® Stock Cr√≠tico (",n.criticalStock.length,")")),r.createElement("div",{className:"space-y-2"},n.criticalStock.slice(0,3).map((e=>r.createElement("div",{key:e.id,className:"flex items-center justify-between text-sm"},r.createElement("div",null,r.createElement("span",{className:"font-medium text-red-900 dark:text-red-100"},e.name),r.createElement("div",{className:"text-red-700 dark:text-red-300"},e.message," ‚Ä¢ ~",e.daysLeft," d√≠as")),r.createElement(f.A,{variant:"red",size:"sm"},e.stockLevel," uds")))))),n.cartImpact.length>0&&r.createElement("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-3 border border-yellow-200 dark:border-yellow-700"},r.createElement("div",{className:"flex items-center gap-2 mb-2"},r.createElement(s.A,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"}),r.createElement("span",{className:"font-medium text-yellow-900 dark:text-yellow-100"},"‚ö†Ô∏è Impacto de Venta Actual")),r.createElement("div",{className:"space-y-2"},n.cartImpact.map((e=>r.createElement("div",{key:e.id,className:"flex items-center justify-between text-sm"},r.createElement("div",null,r.createElement("span",{className:"font-medium text-yellow-900 dark:text-yellow-100"},e.name),r.createElement("div",{className:"text-yellow-700 dark:text-yellow-300"},e.message)),r.createElement(f.A,{variant:"critical"===e.impact?"red":"yellow",size:"sm"},"-",e.cartQuantity)))))),n.lowStock.length>0&&r.createElement("div",{className:"bg-orange-50 dark:bg-orange-900/20 rounded-lg p-3 border border-orange-200 dark:border-orange-700"},r.createElement("div",{className:"flex items-center gap-2 mb-2"},r.createElement(J.A,{className:"h-4 w-4 text-orange-600 dark:text-orange-400"}),r.createElement("span",{className:"font-medium text-orange-900 dark:text-orange-100"},"üìâ Stock Bajo (",n.lowStock.length,")")),r.createElement("div",{className:"space-y-1"},n.lowStock.slice(0,2).map((e=>r.createElement("div",{key:e.id,className:"flex items-center justify-between text-sm"},r.createElement("span",{className:"text-orange-900 dark:text-orange-100"},e.name),r.createElement(f.A,{variant:"orange",size:"sm"},e.stockLevel," uds")))))),n.restockSuggestions.length>0&&r.createElement("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 border border-blue-200 dark:border-blue-700"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(G.A,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),r.createElement("span",{className:"font-medium text-blue-900 dark:text-blue-100"},"üí° Sugerencias de Restock"))),r.createElement("div",{className:"space-y-2"},n.restockSuggestions.slice(0,2).map((e=>r.createElement("div",{key:e.id,className:"space-y-2"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("span",{className:"font-medium text-blue-900 dark:text-blue-100 text-sm"},e.name),r.createElement("div",{className:"text-blue-700 dark:text-blue-300 text-xs"},"Sugerido: ",e.suggestedQuantity," uds ‚Ä¢ ~$",e.estimatedCost)),r.createElement(f.A,{variant:"high"===e.priority?"red":"blue",size:"sm"},"high"===e.priority?"Urgente":"Pronto")))))))),r.createElement("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600 flex gap-2"},r.createElement(v.A,{variant:"outline",size:"sm",onClick:()=>{window.dispatchEvent(new CustomEvent("keyboardShortcut",{detail:{type:"filter",action:"low_stock",target:"/inventory"}}))},className:"flex items-center gap-1 text-xs"},r.createElement(S.A,{className:"h-3 w-3"}),"Ver Inventario"),n.restockSuggestions.length>0&&r.createElement(v.A,{variant:"outline",size:"sm",onClick:()=>{const e=n.restockSuggestions.reduce(((e,t)=>e+t.estimatedCost),0);window.dispatchEvent(new CustomEvent("notification",{detail:{type:"info",title:"üìã Orden de Compra Sugerida",message:`${n.restockSuggestions.length} productos ‚Ä¢ ~$${e.toFixed(2)}`}}))},className:"flex items-center gap-1 text-xs"},r.createElement(Q.A,{className:"h-3 w-3"}),"Crear Orden")),r.createElement("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600"},r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center"},"ü§ñ El sistema monitorea el stock autom√°ticamente y sugiere reposiciones inteligentes")))},ye=a(36846),be=({customer:e=null,cart:t=[],onApplyVIPBenefit:a,className:l=""})=>{const n=(0,r.useMemo)((()=>{if(!e)return null;const a=e.total_orders||0,r=e.total_spent||0,l=t.reduce(((e,t)=>e+t.price*t.quantity),0),n={bronze:{orders:5,spent:1e3},silver:{orders:10,spent:2500},gold:{orders:20,spent:5e3},platinum:{orders:50,spent:12e3}};let c="regular",o="bronze",m=[],i=0;a>=n.platinum.orders&&r>=n.platinum.spent?(c="platinum",o=null,m=["30% descuento","Env√≠o gratis","Productos exclusivos","Atenci√≥n prioritaria","Regalos especiales"]):a>=n.gold.orders&&r>=n.gold.spent?(c="gold",o="platinum",m=["25% descuento","Env√≠o gratis","Productos exclusivos","Atenci√≥n prioritaria"],n.platinum.orders,n.platinum.spent,i=Math.min(a/n.platinum.orders*100,r/n.platinum.spent*100)):a>=n.silver.orders&&r>=n.silver.spent?(c="silver",o="gold",m=["20% descuento","Env√≠o gratis","Productos exclusivos"],i=Math.min(a/n.gold.orders*100,r/n.gold.spent*100)):a>=n.bronze.orders&&r>=n.bronze.spent?(c="bronze",o="silver",m=["15% descuento","Puntos dobles"],i=Math.min(a/n.silver.orders*100,r/n.silver.spent*100)):i=Math.min(a/n.bronze.orders*100,r/n.bronze.spent*100);const d=[];if("regular"!==c){const e={bronze:15,silver:20,gold:25,platinum:30}[c];d.push({id:"vip_discount",type:"discount",title:`${e}% Descuento VIP`,description:`Descuento exclusivo para miembros ${c.toUpperCase()}`,value:e,icon:de.A,color:s(c)}),["bronze","silver"].includes(c)&&l>300&&d.push({id:"double_points",type:"points",title:"Puntos Dobles",description:"Gana puntos dobles en esta compra",value:.02*l,icon:ie.A,color:"purple"}),["silver","gold","platinum"].includes(c)&&d.push({id:"free_shipping",type:"shipping",title:"Env√≠o Gratis",description:"Delivery sin costo adicional",value:0,icon:O.A,color:"green"}),["gold","platinum"].includes(c)&&l>500&&d.push({id:"special_gift",type:"gift",title:"Regalo Especial",description:"Producto de cortes√≠a incluido",value:"Helado premium 1/4kg",icon:ie.A,color:"yellow"})}const u=[];if(o&&n[o]){const e=Math.max(0,n[o].orders-a),t=Math.max(0,n[o].spent-r);e>0&&u.push(`${e} compras m√°s`),t>0&&u.push(`$${t} m√°s en compras`)}return{currentTier:c,nextTier:o,currentBenefits:m,availableBenefits:d,nextTierProgress:i,nextTierSuggestions:u,customerStats:{totalOrders:a,totalSpent:r,averageTicket:a>0?(r/a).toFixed(2):0}}}),[e,t]),s=e=>({bronze:"orange",silver:"gray",gold:"yellow",platinum:"purple"}[e]||"gray");if(!e||!n)return r.createElement("div",{className:`bg-gradient-to-r from-gray-50 to-slate-50 dark:from-gray-900/20 dark:to-slate-900/20 rounded-lg p-4 ${l}`},r.createElement("div",{className:"flex items-center gap-2 mb-2"},r.createElement(de.A,{className:"h-4 w-4 text-gray-400"}),r.createElement("h4",{className:"font-medium text-gray-600 dark:text-gray-400"},"üë§ Cliente VIP")),r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Selecciona un cliente para ver sus beneficios VIP"));const{currentTier:c,nextTier:o,availableBenefits:m,nextTierProgress:i,nextTierSuggestions:d,customerStats:u}=n,g=(p=c,{bronze:de.A,silver:de.A,gold:ye.A,platinum:ye.A}[p]||de.A);var p;return"regular"===c?r.createElement("div",{className:`bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 rounded-lg p-4 ${l}`},r.createElement("div",{className:"flex items-center gap-2 mb-3"},r.createElement(de.A,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white"},"üë§ ",e.name),r.createElement(f.A,{variant:"blue",size:"sm"},"Regular")),r.createElement("div",{className:"space-y-3"},r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},"üìä ",u.totalOrders," compras ‚Ä¢ $",u.totalSpent," gastado"),r.createElement("div",{className:"bg-white/50 dark:bg-gray-800/50 rounded-lg p-3"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement("span",{className:"text-sm font-medium text-gray-900 dark:text-white"},"Progreso a Bronze VIP"),r.createElement("span",{className:"text-sm text-blue-600 dark:text-blue-400"},Math.round(i),"%")),r.createElement("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},r.createElement("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:`${i}%`}})),d.length>0&&r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2"},"üíé Para Bronze VIP: ",d.join(" y "))))):r.createElement("div",{className:`bg-gradient-to-r from-yellow-50 to-amber-50 dark:from-yellow-900/20 dark:to-amber-900/20 rounded-lg p-4 border-2 border-yellow-200 dark:border-yellow-700 ${l}`},r.createElement("div",{className:"flex items-center gap-2 mb-3"},r.createElement(g,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"}),r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white"},"üëë ",e.name),r.createElement(f.A,{variant:s(c),size:"sm"},c.charAt(0).toUpperCase()+c.slice(1)," VIP")),r.createElement("div",{className:"space-y-3"},r.createElement("div",{className:"grid grid-cols-3 gap-2 text-xs"},r.createElement("div",{className:"text-center p-2 bg-white/50 dark:bg-gray-800/50 rounded"},r.createElement("div",{className:"font-medium text-gray-900 dark:text-white"},u.totalOrders),r.createElement("div",{className:"text-gray-600 dark:text-gray-400"},"Compras")),r.createElement("div",{className:"text-center p-2 bg-white/50 dark:bg-gray-800/50 rounded"},r.createElement("div",{className:"font-medium text-gray-900 dark:text-white"},"$",u.totalSpent),r.createElement("div",{className:"text-gray-600 dark:text-gray-400"},"Gastado")),r.createElement("div",{className:"text-center p-2 bg-white/50 dark:bg-gray-800/50 rounded"},r.createElement("div",{className:"font-medium text-gray-900 dark:text-white"},"$",u.averageTicket),r.createElement("div",{className:"text-gray-600 dark:text-gray-400"},"Promedio"))),m.length>0&&r.createElement("div",{className:"space-y-2"},r.createElement("p",{className:"text-sm font-medium text-gray-900 dark:text-white"},"üéÅ Beneficios Disponibles:"),m.map((e=>{const t=e.icon;return r.createElement("div",{key:e.id,className:"bg-white dark:bg-gray-800 rounded-lg p-3 border border-gray-200 dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(t,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"}),r.createElement("div",null,r.createElement("div",{className:"font-medium text-gray-900 dark:text-white text-sm"},e.title),r.createElement("div",{className:"text-gray-600 dark:text-gray-400 text-xs"},e.description))),r.createElement(v.A,{variant:"outline",size:"sm",onClick:()=>a&&a(e),className:"flex items-center gap-1"},r.createElement(ie.A,{className:"h-3 w-3"}),"Aplicar")))}))),o&&r.createElement("div",{className:"bg-white/50 dark:bg-gray-800/50 rounded-lg p-3"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement("span",{className:"text-sm font-medium text-gray-900 dark:text-white"},"Progreso a ",o.charAt(0).toUpperCase()+o.slice(1)),r.createElement("span",{className:"text-sm text-yellow-600 dark:text-yellow-400"},Math.round(i),"%")),r.createElement("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},r.createElement("div",{className:"bg-yellow-600 h-2 rounded-full transition-all duration-500",style:{width:`${i}%`}})),d.length>0&&r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-2"},"üíé Faltan: ",d.join(" y ")))),r.createElement("div",{className:"mt-3 pt-3 border-t border-gray-200 dark:border-gray-600"},r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 text-center"},"üëë Cliente VIP con beneficios exclusivos y atenci√≥n preferencial")))},Ee=a(24596),ve=a(8723),he=a(56570),Ne=a(35404),fe=a(18931),ke=a(45773),we=({isOpen:e,onClose:t,cartTotal:a,orderId:l,customerId:n,customerEmail:s,onPaymentComplete:c,paymentMethod:o="cash"})=>{const{success:m,error:u,warning:g}=(0,b.d)(),[p,x]=(0,r.useState)(!1),[y,E]=(0,r.useState)("select"),[N,f]=(0,r.useState)(o),[w,A]=(0,r.useState)(null),[C,S]=(0,r.useState)(!1),[$,_]=(0,r.useState)(!1),[j,T]=(0,r.useState)({number:"",name:"",expiry:"",cvv:"",email:s||""}),[z,I]=(0,r.useState)(null),[L,M]=(0,r.useState)(!0);(0,r.useEffect)((()=>{q()}),[]),(0,r.useEffect)((()=>{let e;return w&&"qr"===y&&(e=setInterval((()=>{D()}),5e3)),()=>{e&&clearInterval(e)}}),[w,y]);const q=async()=>{try{const e=await fetch("/api/payments/config"),t=await e.json();t.success&&I(t)}catch(e){console.error("Error fetching payment config:",e)}finally{M(!1)}},D=async()=>{if(w&&!$){_(!0);try{console.log("Checking payment status for preference:",w.preferenceId)}catch(e){console.error("Error checking payment:",e)}finally{_(!1)}}},F=()=>{p?g("Procesando","Espera a que termine el proceso"):(E("select"),A(null),T({number:"",name:"",expiry:"",cvv:"",email:s||""}),t())},V=e=>{const t=e.replace(/\s+/g,"").replace(/[^0-9]/gi,"").match(/\d{4,16}/g),a=t&&t[0]||"",r=[];for(let e=0,t=a.length;e<t;e+=4)r.push(a.substring(e,e+4));return r.length?r.join(" "):e},O=e=>{const t=e.replace(/\s+/g,"").replace(/[^0-9]/gi,"");return t.length>=2?t.slice(0,2)+"/"+t.slice(2,4):t};return L?r.createElement(k.A,{isOpen:e,onClose:F,title:"Procesando Pago",size:"md"},r.createElement("div",{className:"flex items-center justify-center py-12"},r.createElement(ve.A,{className:"h-8 w-8 animate-spin text-blue-600"}))):r.createElement(k.A,{isOpen:e,onClose:F,title:"complete"===y?"Pago Completado":"Procesar Pago",size:"md"},r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"text-center p-4 bg-gray-50 dark:bg-gray-900 rounded-lg"},r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Total a pagar"),r.createElement("p",{className:"text-3xl font-bold text-gray-900 dark:text-white"},"$",a.toFixed(2))),"select"===y&&r.createElement("div",{className:"space-y-4"},r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white"},"Selecciona el m√©todo de pago"),r.createElement("div",{className:"grid gap-3"},r.createElement("button",{onClick:()=>(async()=>{x(!0);try{setTimeout((()=>{E("complete"),c({method:"cash",amount:a,status:"approved"}),m("Pago registrado",`Pago en efectivo de $${a}`)}),500)}catch(e){u("Error",e.message)}finally{x(!1)}})(),className:(0,P.A)("p-4 rounded-lg border-2 text-left transition-all","hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20","border-gray-200 dark:border-gray-700")},r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:"w-12 h-12 bg-green-100 dark:bg-green-900/20 rounded-lg flex items-center justify-center"},r.createElement(i.A,{className:"h-6 w-6 text-green-600 dark:text-green-400"})),r.createElement("div",null,r.createElement("p",{className:"font-medium text-gray-900 dark:text-white"},"Efectivo"),r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Pago en efectivo en el local")))),z?.configured&&r.createElement("button",{onClick:()=>(async()=>{S(!0);try{const e=await fetch("/api/payments/create-preference",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({items:[{id:l,name:`Orden #${l}`,quantity:1,price:a}],orderId:l,customerId:n,customerEmail:j.email||s,total:a})}),t=await e.json();if(!t.success)throw new Error(t.error||"Error al generar QR");A(t),E("qr"),m("QR generado","Escanea el c√≥digo para pagar")}catch(e){u("Error",e.message)}finally{S(!1)}})(),disabled:C,className:(0,P.A)("p-4 rounded-lg border-2 text-left transition-all","hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20","border-gray-200 dark:border-gray-700","disabled:opacity-50 disabled:cursor-not-allowed")},r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/20 rounded-lg flex items-center justify-center"},C?r.createElement(ve.A,{className:"h-6 w-6 animate-spin text-blue-600"}):r.createElement(he.A,{className:"h-6 w-6 text-blue-600 dark:text-blue-400"})),r.createElement("div",null,r.createElement("p",{className:"font-medium text-gray-900 dark:text-white"},"QR MercadoPago"),r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Escanea y paga con tu celular")))),z?.configured&&r.createElement("button",{onClick:()=>E("card"),className:(0,P.A)("p-4 rounded-lg border-2 text-left transition-all","hover:border-blue-500 hover:bg-blue-50 dark:hover:bg-blue-900/20","border-gray-200 dark:border-gray-700")},r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/20 rounded-lg flex items-center justify-center"},r.createElement(d.A,{className:"h-6 w-6 text-purple-600 dark:text-purple-400"})),r.createElement("div",null,r.createElement("p",{className:"font-medium text-gray-900 dark:text-white"},"Tarjeta de Cr√©dito/D√©bito"),r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Visa, Mastercard, Amex y m√°s"))))),!z?.configured&&r.createElement("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg"},r.createElement("div",{className:"flex gap-3"},r.createElement(ce.A,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 flex-shrink-0 mt-0.5"}),r.createElement("div",{className:"text-sm"},r.createElement("p",{className:"font-medium text-yellow-800 dark:text-yellow-200"},"MercadoPago no configurado"),r.createElement("p",{className:"text-yellow-700 dark:text-yellow-300"},"Solo est√° disponible el pago en efectivo. Configura MercadoPago para habilitar pagos con QR y tarjeta."))))),"qr"===y&&w&&r.createElement("div",{className:"space-y-4"},r.createElement("div",{className:"text-center"},r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white mb-4"},"Escanea el c√≥digo QR para pagar"),r.createElement("div",{className:"inline-block p-4 bg-white rounded-lg shadow-lg"},r.createElement("img",{src:w.qrCode,alt:"QR Code",className:"w-64 h-64"})),r.createElement("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-900 rounded-lg"},r.createElement("p",{className:"text-xs text-gray-600 dark:text-gray-400 mb-2"},"O comparte este link:"),r.createElement("div",{className:"flex items-center gap-2"},r.createElement("input",{type:"text",value:w.initPoint||w.sandboxInitPoint,readOnly:!0,className:"flex-1 text-xs p-2 bg-white dark:bg-gray-800 border rounded"}),r.createElement(v.A,{size:"sm",variant:"outline",onClick:()=>{return e=w.initPoint||w.sandboxInitPoint,navigator.clipboard.writeText(e),void m("Copiado","Link copiado al portapapeles");var e}},r.createElement(Ne.A,{className:"h-4 w-4"})),r.createElement(v.A,{size:"sm",variant:"outline",onClick:()=>window.open(w.initPoint||w.sandboxInitPoint,"_blank")},r.createElement(fe.A,{className:"h-4 w-4"})))),r.createElement("div",{className:"mt-4"},$?r.createElement("div",{className:"flex items-center justify-center gap-2 text-blue-600 dark:text-blue-400"},r.createElement(ve.A,{className:"h-4 w-4 animate-spin"}),r.createElement("span",{className:"text-sm"},"Verificando pago...")):r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Esperando confirmaci√≥n de pago..."))),r.createElement("div",{className:"flex gap-3"},r.createElement(v.A,{variant:"outline",onClick:()=>{E("select"),A(null)},className:"flex-1"},"Cambiar m√©todo"),r.createElement(v.A,{variant:"outline",onClick:D,disabled:$},r.createElement(H.A,{className:(0,P.A)("h-4 w-4",$&&"animate-spin")})))),"card"===y&&r.createElement("div",{className:"space-y-4"},r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white"},"Informaci√≥n de la tarjeta"),r.createElement("div",{className:"space-y-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"N√∫mero de tarjeta"),r.createElement(h.A,{type:"text",placeholder:"1234 5678 9012 3456",value:j.number,onChange:e=>T({...j,number:V(e.target.value)}),maxLength:"19"})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Nombre del titular"),r.createElement(h.A,{type:"text",placeholder:"Juan P√©rez",value:j.name,onChange:e=>T({...j,name:e.target.value})})),r.createElement("div",{className:"grid grid-cols-2 gap-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Vencimiento"),r.createElement(h.A,{type:"text",placeholder:"MM/AA",value:j.expiry,onChange:e=>T({...j,expiry:O(e.target.value)}),maxLength:"5"})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"CVV"),r.createElement(h.A,{type:"text",placeholder:"123",value:j.cvv,onChange:e=>T({...j,cvv:e.target.value.replace(/\D/g,"").slice(0,4)}),maxLength:"4"}))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Email (para el recibo)"),r.createElement(h.A,{type:"email",placeholder:"cliente@email.com",value:j.email,onChange:e=>T({...j,email:e.target.value})}))),r.createElement("div",{className:"p-3 bg-gray-50 dark:bg-gray-900 rounded-lg"},r.createElement("div",{className:"flex gap-2"},r.createElement(ce.A,{className:"h-4 w-4 text-gray-500 flex-shrink-0 mt-0.5"}),r.createElement("p",{className:"text-xs text-gray-600 dark:text-gray-400"},"Tu informaci√≥n est√° segura. Procesamos los pagos a trav√©s de MercadoPago con encriptaci√≥n SSL."))),r.createElement("div",{className:"flex gap-3"},r.createElement(v.A,{variant:"outline",onClick:()=>E("select"),className:"flex-1"},"Volver"),r.createElement(v.A,{onClick:async()=>{if(j.number&&j.name&&j.expiry&&j.cvv)if(j.email){x(!0),E("processing");try{u("Funci√≥n en desarrollo","El pago con tarjeta estar√° disponible pr√≥ximamente"),setTimeout((()=>{E("complete"),c({method:"card",transactionId:"MP-"+Date.now(),amount:a,status:"approved"}),m("Pago completado",`Se proces√≥ el pago de $${a}`)}),2e3)}catch(e){u("Error en el pago",e.message),E("card")}finally{x(!1)}}else g("Email requerido","El email es necesario para procesar el pago");else g("Datos incompletos","Por favor completa todos los campos de la tarjeta")},disabled:p,className:"flex-1"},p?r.createElement(ve.A,{className:"h-4 w-4 animate-spin"}):r.createElement(r.Fragment,null,r.createElement(d.A,{className:"h-4 w-4 mr-2"}),"Pagar $",a.toFixed(2))))),"processing"===y&&r.createElement("div",{className:"text-center py-8"},r.createElement(ve.A,{className:"h-12 w-12 animate-spin text-blue-600 mx-auto mb-4"}),r.createElement("p",{className:"text-gray-600 dark:text-gray-400"},"Procesando tu pago..."),r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-500 mt-2"},"Por favor no cierres esta ventana")),"complete"===y&&r.createElement("div",{className:"text-center py-6"},r.createElement("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-4"},r.createElement(ke.A,{className:"h-8 w-8 text-green-600 dark:text-green-400"})),r.createElement("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},"¬°Pago completado!"),r.createElement("p",{className:"text-gray-600 dark:text-gray-400"},"El pago de $",a.toFixed(2)," se proces√≥ correctamente"),r.createElement(v.A,{onClick:F,className:"mt-6"},"Cerrar"))))},Ae=()=>{(0,l.zy)();const{success:e,error:t,warning:a}=(0,b.d)(),[f,w]=(0,r.useState)([]),[A,C]=(0,r.useState)(null),[S,$]=(0,r.useState)("cash"),[P,j]=(0,r.useState)(0),[T,z]=(0,r.useState)("percent"),[I,L]=(0,r.useState)(""),[M,D]=(0,r.useState)("all"),[F,V]=(0,r.useState)(!1),[O,Q]=(0,r.useState)(!1),[H,G]=(0,r.useState)(!1),[W,J]=(0,r.useState)("pickup"),[X,Y]=(0,r.useState)({address:"",phone:"",estimatedTime:"30-45 minutos",notes:""}),[ee,te]=(0,r.useState)(null),[ae,re]=(0,r.useState)(!1),[ne,ce]=(0,r.useState)(!1),{data:me,loading:ie,refetch:de}=(0,y.Wl)("/api/products"),{data:ue,loading:ge}=(0,y.Wl)("/api/categories"),{data:ye,loading:ve}=(0,y.Wl)("/api/customers"),{data:he,loading:Ne}=(0,y.Wl)("/api/sales/recent?limit=5"),{data:fe,loading:ke}=(0,y.Wl)("/api/cashflow/status"),Ae=ie||ge||ve||Ne||ke,Ce=Array.isArray(me)?me:[],Se=Array.isArray(ue)?ue:[],$e=Array.isArray(ye)?ye:[],Pe=Array.isArray(he)?he:[],_e=fe||{available:0},je=(0,r.useMemo)((()=>Array.isArray(Ce)?Ce.filter((e=>{const t=e.name?.toLowerCase().includes(I.toLowerCase())||e.description?.toLowerCase().includes(I.toLowerCase()),a="all"===M||e.category_id===parseInt(M);return t&&a})):[]),[Ce,I,M]),Te=(0,r.useMemo)((()=>{const e=f.reduce(((e,t)=>e+t.price*t.quantity),0),t="percent"===T?e*(P/100):P,a=Math.max(0,e-t),r=f.reduce(((e,t)=>e+t.quantity),0);return{subtotal:e.toFixed(2),discountAmount:t.toFixed(2),total:a.toFixed(2),itemCount:r}}),[f,P,T]),ze=(0,r.useMemo)((()=>Array.isArray(Ce)?Ce.slice(0,9):[]),[Ce]),Ie=t=>{w((e=>e.find((e=>e.id===t.id))?e.map((e=>e.id===t.id?{...e,quantity:e.quantity+1}:e)):[...e,{...t,quantity:1}])),e("Producto agregado",`${t.name} agregado al carrito`)},Le=e=>{w((t=>t.filter((t=>t.id!==e))))},Me=()=>{w([]),C(null),j(0),J("pickup"),Y({address:"",phone:"",estimatedTime:"30-45 minutos",notes:""}),te(null)};return Ae?r.createElement("div",{className:"flex items-center justify-center min-h-96"},r.createElement(E.A,{size:"lg"})):r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4"},r.createElement("div",null,r.createElement("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white"},"Punto de Venta"),r.createElement("p",{className:"text-gray-600 dark:text-gray-400"},"Sistema de ventas r√°pido y eficiente")),r.createElement("div",{className:"flex items-center gap-3"},r.createElement(v.A,{variant:"outline",onClick:()=>Q(!0),className:"flex items-center gap-2"},r.createElement(n.A,{className:"h-4 w-4"}),A?A.name:"Cliente"),r.createElement(v.A,{onClick:()=>V(!0),disabled:0===f.length,className:"flex items-center gap-2"},r.createElement(s.A,{className:"h-4 w-4"}),"Carrito (",Te.itemCount,")"))),r.createElement(Z,null),r.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6"},r.createElement("div",{className:"lg:col-span-3"},r.createElement(R,{products:Ce,onProductSelect:Ie,topProducts:ze})),r.createElement("div",{className:"space-y-4"},r.createElement(K,{cashAvailable:_e.available,lowCashThreshold:500,criticalCashThreshold:100}),r.createElement(oe,null))),r.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6"},r.createElement("div",{className:"lg:col-span-3 space-y-6"},r.createElement(U,{products:ze,onProductSelect:Ie,maxProducts:9}),"all"!==M&&r.createElement("div",null,r.createElement("div",{className:"flex items-center justify-between mb-4"},r.createElement("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white"},"Productos por Categor√≠a"),r.createElement(N.A,{value:M,onChange:D,className:"w-48"},r.createElement("option",{value:"all"},"Todas las categor√≠as"),Se.map((e=>r.createElement("option",{key:e.id,value:e.id},e.name))))),r.createElement("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4"},je.map((e=>r.createElement(_,{key:e.id,product:e,onAddToCart:Ie,cartQuantity:f.find((t=>t.id===e.id))?.quantity||0})))),0===je.length&&r.createElement("div",{className:"text-center py-12"},r.createElement(c.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),r.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"No se encontraron productos en esta categor√≠a")))),r.createElement("div",{className:"lg:col-span-1 space-y-6"},r.createElement(q,{cart:f,onUpdateQuantity:(e,t)=>{t<=0?Le(e):w((a=>a.map((a=>a.id===e?{...a,quantity:t}:a))))},onRemoveItem:Le,onClearCart:Me,cartStats:Te,onCheckout:()=>V(!0)}),r.createElement(le,{cart:f}),r.createElement(be,{customer:A,cart:f,onApplyVIPBenefit:t=>{"discount"===t.type?(j(t.value),z("percent"),e("üéØ Beneficio VIP aplicado",`${t.title} - ${t.description}`)):"shipping"===t.type?e("üöö Env√≠o gratis activado","Delivery sin costo para cliente VIP"):"gift"===t.type?e("üéÅ Regalo incluido",`${t.value} agregado como cortes√≠a`):"points"===t.type&&e("‚≠ê Puntos dobles",`Ganar√°s ${t.value} puntos extra`)}}),r.createElement(pe,{cart:f,customer:A,onApplyDiscount:t=>{j(t.value),z(t.type),e("¬°Descuento aplicado!",`${t.title} - Ahorras: $${("percent"===t.type?f.reduce(((e,t)=>e+t.price*t.quantity),0)*(t.value/100):t.value).toFixed(2)}`)}}),r.createElement(xe,{cart:f,products:Ce,onAddToCart:Ie}),r.createElement(se,{cart:f,products:Ce,onProductSelect:Ie}),r.createElement(B,{orders:Pe,onRepeatOrder:async a=>{try{e("Pedido repetido",`Orden #${a.id} agregada al carrito`);const t=Array.isArray(Ce)&&Ce.length>0?[{...Ce[0],quantity:2},...Ce[1]?[{...Ce[1],quantity:1}]:[]].filter((e=>e.id)):[];t.length>0&&w((e=>{const a=[...e];return t.forEach((e=>{const t=a.find((t=>t.id===e.id));t?t.quantity+=e.quantity:a.push(e)})),a}))}catch(e){t("Error","No se pudo repetir el pedido")}},maxOrders:5}))),r.createElement(k.A,{isOpen:F,onClose:()=>V(!1),title:"Procesar Venta",size:"lg"},r.createElement("div",{className:"space-y-6"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"},"Tipo de Orden"),r.createElement("div",{className:"grid grid-cols-2 gap-3"},r.createElement("button",{onClick:()=>J("pickup"),className:"p-3 rounded-lg border-2 transition-all "+("pickup"===W?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300")},r.createElement("div",{className:"flex items-center justify-center gap-2"},r.createElement(o.A,{className:"h-5 w-5"}),r.createElement("span",{className:"font-medium"},"Retiro en Local"))),r.createElement("button",{onClick:()=>J("delivery"),className:"p-3 rounded-lg border-2 transition-all "+("delivery"===W?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300")},r.createElement("div",{className:"flex items-center justify-center gap-2"},r.createElement(m.A,{className:"h-5 w-5"}),r.createElement("span",{className:"font-medium"},"Delivery"))))),"delivery"===W&&r.createElement("div",{className:"space-y-4 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-lg"},r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white flex items-center gap-2"},r.createElement(m.A,{className:"h-4 w-4"}),"Informaci√≥n de Entrega"),r.createElement("div",{className:"grid grid-cols-2 gap-3"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Tel√©fono *"),r.createElement(h.A,{type:"tel",placeholder:"123-456-7890",value:X.phone,onChange:e=>Y((t=>({...t,phone:e.target.value}))),required:!0})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Tiempo Estimado"),r.createElement(N.A,{value:X.estimatedTime,onChange:e=>Y((t=>({...t,estimatedTime:e})))},r.createElement("option",{value:"20-30 minutos"},"20-30 minutos"),r.createElement("option",{value:"30-45 minutos"},"30-45 minutos"),r.createElement("option",{value:"45-60 minutos"},"45-60 minutos"),r.createElement("option",{value:"1-2 horas"},"1-2 horas")))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Direcci√≥n de Entrega *"),r.createElement(h.A,{placeholder:"Calle, n√∫mero, barrio, referencias",value:X.address,onChange:e=>Y((t=>({...t,address:e.target.value}))),required:!0})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Notas adicionales"),r.createElement(h.A,{placeholder:"Indicaciones especiales, referencias, etc.",value:X.notes,onChange:e=>Y((t=>({...t,notes:e.target.value})))}))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Cliente"),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(h.A,{value:A?.name||"Cliente General",readOnly:!0,className:"flex-1"}),r.createElement(v.A,{variant:"outline",onClick:()=>Q(!0)},"Cambiar"))),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"M√©todo de Pago"),r.createElement("div",{className:"grid grid-cols-3 gap-2"},r.createElement("button",{onClick:()=>$("cash"),className:"p-3 rounded-lg border-2 transition-all "+("cash"===S?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300")},r.createElement(i.A,{className:"h-5 w-5 mx-auto mb-1"}),r.createElement("span",{className:"text-sm"},"Efectivo")),r.createElement("button",{onClick:()=>$("card"),className:"p-3 rounded-lg border-2 transition-all "+("card"===S?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300")},r.createElement(d.A,{className:"h-5 w-5 mx-auto mb-1"}),r.createElement("span",{className:"text-sm"},"Tarjeta")),r.createElement("button",{onClick:()=>$("qr"),className:"p-3 rounded-lg border-2 transition-all "+("qr"===S?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-200 dark:border-gray-600 hover:border-gray-300")},r.createElement(u.A,{className:"h-5 w-5 mx-auto mb-1"}),r.createElement("span",{className:"text-sm"},"QR")))),r.createElement(pe,{cart:f,customer:A,onApplyDiscount:t=>{j(t.value),z(t.type),e("¬°Descuento aplicado!",`${t.title} - Ahorras: $${("percent"===t.type?f.reduce(((e,t)=>e+t.price*t.quantity),0)*(t.value/100):t.value).toFixed(2)}`)},className:"mb-4"}),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Descuento Manual"),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(h.A,{type:"number",value:P,onChange:e=>j(parseFloat(e.target.value)||0),min:"0",step:"0.01",className:"flex-1",placeholder:"0.00"}),r.createElement(N.A,{value:T,onChange:z,className:"w-24"},r.createElement("option",{value:"percent"},"%"),r.createElement("option",{value:"fixed"},"$"))),r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"O usa los descuentos autom√°ticos de arriba")),r.createElement("div",{className:"border-t pt-4"},r.createElement("div",{className:"space-y-2"},r.createElement("div",{className:"flex justify-between"},r.createElement("span",null,"Subtotal:"),r.createElement("span",null,"$",Te.subtotal)),r.createElement("div",{className:"flex justify-between"},r.createElement("span",null,"Descuento:"),r.createElement("span",null,"-$",Te.discountAmount)),r.createElement("div",{className:"flex justify-between font-bold text-lg"},r.createElement("span",null,"Total:"),r.createElement("span",null,"$",Te.total)))),r.createElement("div",{className:"flex gap-3"},r.createElement(v.A,{variant:"outline",onClick:()=>V(!1),className:"flex-1"},"Cancelar"),r.createElement(v.A,{onClick:async()=>{if(0!==f.length)if("delivery"!==W||X.address&&X.phone){if("card"===S||"qr"===S)return V(!1),void ce(!0);G(!0);try{const t={items:f.map((e=>({product_id:e.id,quantity:e.quantity,price:e.price}))),customer:A?{name:A.name||"Cliente sin nombre",phone:A.phone||X.phone||"",email:A.email||""}:{name:"Cliente sin nombre",phone:X.phone||""},payment_method:S,discount:"percent"===T?P:0,total:parseFloat(Te.total)};let a="/api/sales",r=t;"delivery"===W&&(a="/api/pos/create-delivery-order",r={...t,delivery_address:X.address,delivery_phone:X.phone,estimated_time:X.estimatedTime,notes:X.notes});const l=await fetch(a,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!l.ok)throw new Error("Error al procesar la venta");const n=await l.json();if(!n.success)throw new Error(n.message||"Error desconocido");{const t={...n.sale,items:f.map((e=>({product_name:e.name,quantity:e.quantity,unit_price:e.price,price:e.price}))),customer_name:A?.name||"Cliente General",customer_phone:A?.phone||X.phone||"",customer_email:A?.email||"",payment_method:S,receipt_number:n.receipt_number,discount:P,discount_type:T,sale_type:W,delivery_address:"delivery"===W?X.address:null,estimated_time:"delivery"===W?X.estimatedTime:null};te(t),"delivery"===W?e("üöö Orden de delivery creada exitosamente",`Recibo: ${n.receipt_number} | Total: $${n.sale.total} | Tiempo estimado: ${n.delivery.estimated_time}`):e("üéâ Venta procesada exitosamente",`Recibo: ${n.receipt_number} | Total: $${n.sale.total}`),n.stock_updated&&n.stock_updated.length>0&&console.log("üì¶ Stock actualizado:",n.stock_updated),V(!1),w([]),C(null),j(0),J("pickup"),Y({address:"",phone:"",estimatedTime:"30-45 minutos",notes:""}),re(!0)}}catch(e){t("Error",e.message||"Error al procesar la venta")}finally{G(!1)}}else a("Datos incompletos","La direcci√≥n y tel√©fono son requeridos para delivery");else a("Carrito vac√≠o","Agrega productos antes de procesar la venta")},disabled:H,className:"flex-1"},H?r.createElement(E.A,{size:"sm"}):r.createElement(r.Fragment,null,r.createElement(d.A,{className:"h-4 w-4 mr-2"}),"Procesar Venta"))))),r.createElement(k.A,{isOpen:O,onClose:()=>Q(!1),title:"Seleccionar Cliente",size:"md"},r.createElement("div",{className:"space-y-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Cliente Frecuente"),r.createElement(N.A,{value:"",onChange:t=>{if(t.target.value){const a=$e.find((e=>e.id===parseInt(t.target.value)));a&&(C(a),Q(!1),e("Cliente seleccionado"))}},className:"w-full"},r.createElement("option",{value:""},"Seleccionar cliente..."),$e.map((e=>r.createElement("option",{key:e.id,value:e.id},e.name," - ",e.phone||"Sin tel√©fono"))))),r.createElement("div",{className:"relative"},r.createElement("div",{className:"absolute inset-0 flex items-center"},r.createElement("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})),r.createElement("div",{className:"relative flex justify-center text-sm"},r.createElement("span",{className:"px-2 bg-white dark:bg-gray-800 text-gray-500"},"O ingrese datos manualmente"))),r.createElement("form",{onSubmit:t=>{t.preventDefault();const a=new FormData(t.target),r={name:a.get("name"),phone:a.get("phone"),email:a.get("email"),address:a.get("address")};r.name&&(C(r),Q(!1),e("Cliente agregado"))}},r.createElement("div",{className:"space-y-4"},r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Nombre *"),r.createElement(h.A,{name:"name",placeholder:"Nombre del cliente",required:!0,defaultValue:A?.name||""})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Tel√©fono"),r.createElement(h.A,{name:"phone",type:"tel",placeholder:"123-456-7890",defaultValue:A?.phone||""})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Email"),r.createElement(h.A,{name:"email",type:"email",placeholder:"cliente@email.com",defaultValue:A?.email||""})),r.createElement("div",null,r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1"},"Direcci√≥n"),r.createElement(h.A,{name:"address",placeholder:"Direcci√≥n de entrega",defaultValue:A?.address||""}))),r.createElement("div",{className:"flex gap-3 mt-6"},r.createElement(v.A,{type:"button",variant:"outline",onClick:()=>{C(null),Q(!1)},className:"flex-1"},r.createElement(g.A,{className:"h-4 w-4 mr-2"}),"Limpiar"),r.createElement(v.A,{type:"submit",className:"flex-1"},r.createElement(p.A,{className:"h-4 w-4 mr-2"}),"Confirmar"))))),r.createElement(k.A,{isOpen:ae,onClose:()=>re(!1),title:"Venta Completada",size:"md"},r.createElement("div",{className:"space-y-6"},ee&&r.createElement(r.Fragment,null,r.createElement("div",{className:"text-center"},r.createElement("div",{className:"w-16 h-16 bg-green-100 dark:bg-green-900/20 rounded-full flex items-center justify-center mx-auto mb-4"},r.createElement(p.A,{className:"h-8 w-8 text-green-600 dark:text-green-400"})),r.createElement("h3",{className:"text-lg font-semibold text-gray-900 dark:text-white mb-2"},"¬°Venta Exitosa!"),r.createElement("p",{className:"text-gray-600 dark:text-gray-400"},"Recibo: ",ee.receipt_number),r.createElement("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-2"},"Total: $",parseFloat(ee.total).toFixed(2))),r.createElement("div",{className:"space-y-3"},r.createElement("h4",{className:"font-medium text-gray-900 dark:text-white"},"¬øQu√© deseas hacer con el recibo?"),r.createElement("div",{className:"grid grid-cols-2 gap-3"},r.createElement(v.A,{variant:"outline",onClick:()=>{Ee.A.printReceipt(ee)},className:"flex items-center justify-center gap-2"},r.createElement(x.A,{className:"h-4 w-4"}),"Imprimir Recibo"),r.createElement(v.A,{variant:"outline",onClick:()=>{Ee.A.downloadReceipt(ee)},className:"flex items-center justify-center gap-2"},r.createElement(x.A,{className:"h-4 w-4"}),"Descargar Recibo"),r.createElement(v.A,{variant:"outline",onClick:()=>{Ee.A.printInvoice(ee)},className:"flex items-center justify-center gap-2"},r.createElement(x.A,{className:"h-4 w-4"}),"Imprimir Factura"),r.createElement(v.A,{variant:"outline",onClick:()=>{Ee.A.downloadInvoice(ee)},className:"flex items-center justify-center gap-2"},r.createElement(x.A,{className:"h-4 w-4"}),"Descargar Factura")),r.createElement("div",{className:"pt-3 border-t"},r.createElement("div",{className:"flex items-center gap-3"},r.createElement(h.A,{type:"email",placeholder:"Email del cliente (opcional)",defaultValue:ee.customer_email||"",disabled:!0}),r.createElement(v.A,{variant:"outline",disabled:!0},"Enviar por Email")),r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-1"},"Funci√≥n disponible pr√≥ximamente"))),r.createElement("div",{className:"flex gap-3"},r.createElement(v.A,{variant:"primary",onClick:()=>{re(!1),Me()},className:"flex-1"},"Nueva Venta"),r.createElement(v.A,{variant:"outline",onClick:()=>re(!1),className:"flex-1"},"Cerrar"))))),r.createElement(we,{isOpen:ne,onClose:()=>ce(!1),cartTotal:parseFloat(Te.total),orderId:Date.now(),customerId:A?.id,customerEmail:A?.email,onPaymentComplete:async a=>{ce(!1),G(!0);try{const t={items:f.map((e=>({product_id:e.id,quantity:e.quantity,price:e.price}))),customer:A?{name:A.name||"Cliente sin nombre",phone:A.phone||X.phone||"",email:A.email||""}:{name:"Cliente sin nombre",phone:X.phone||""},payment_method:a.method,payment_id:a.transactionId,discount:"percent"===T?P:0,total:parseFloat(Te.total)};let r="/api/sales",l=t;"delivery"===W&&(r="/api/pos/create-delivery-order",l={...t,delivery_address:X.address,delivery_phone:X.phone,estimated_time:X.estimatedTime,notes:X.notes});const n=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)});if(!n.ok)throw new Error("Error al procesar la venta");const s=await n.json();if(!s.success)throw new Error(s.message||"Error desconocido");{const t={...s.sale,items:f.map((e=>({product_name:e.name,quantity:e.quantity,unit_price:e.price,price:e.price}))),customer_name:A?.name||"Cliente General",customer_phone:A?.phone||X.phone||"",customer_email:A?.email||"",payment_method:a.method,payment_id:a.transactionId,receipt_number:s.receipt_number,discount:P,discount_type:T,sale_type:W,delivery_address:"delivery"===W?X.address:null,estimated_time:"delivery"===W?X.estimatedTime:null};te(t),e("üí≥ Pago procesado exitosamente",`Recibo: ${s.receipt_number} | Total: $${s.sale.total} | M√©todo: ${a.method}`),w([]),C(null),j(0),J("pickup"),Y({address:"",phone:"",estimatedTime:"30-45 minutos",notes:""}),re(!0)}}catch(e){t("Error",e.message||"Error al procesar la venta")}finally{G(!1)}},paymentMethod:S}))}}}]);