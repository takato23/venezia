"use strict";(self.webpackChunkvenezia_frontend=self.webpackChunkvenezia_frontend||[]).push([[9039],{29039:function(e,t,a){a.r(t),a.d(t,{default:function(){return H}});var r=a(96540),s=a(47767),n=a(89667),l=a(17133),c=a(94945),i=a(15977),d=a(80697),o=a(27235),m=a(85731),u=a(418),g=a(44471),p=a(98445),y=a(35627),x=a(32307),E=a(70700),b=a(42203),h=a(93823),f=a(72284),N=a(11562),v=a(71428),w=a(28219),_=a(50180),k=a(7611),A=a(3213),C=a(98188),S=a(35404),z=a(32708),D=a(87677),T=a(20053),L=({order:e,onEdit:t,onDelete:a,onStatusChange:s,onViewDetails:n,onDuplicate:c})=>{const[i,d]=(0,r.useState)(!1),u={pending:{label:"Pendiente",variant:"default",icon:o.A,color:"text-gray-600"},in_progress:{label:"En Proceso",variant:"warning",icon:m.A,color:"text-yellow-600"},completed:{label:"Completado",variant:"success",icon:g.A,color:"text-green-600"},cancelled:{label:"Cancelado",variant:"danger",icon:_.A,color:"text-red-600"},on_hold:{label:"En Espera",variant:"info",icon:k.A,color:"text-blue-600"}},p=u[e.status]||u.pending,y=p.icon,x=(0,r.useMemo)((()=>{if(!e.recipe||!e.recipe.recipe_ingredients)return 0;if("completed"===e.status)return 100;if("cancelled"===e.status)return 0;if("in_progress"===e.status&&e.started_at){const t=Date.now()-new Date(e.started_at).getTime(),a=60*(e.recipe.preparation_time||30)*1e3;return Math.min(Math.round(t/a*100),95)}return 0}),[e]),E=e=>{d(!1),e()};return r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700 hover:shadow-md transition-shadow"},r.createElement("div",{className:"p-6"},r.createElement("div",{className:"flex items-start justify-between mb-4"},r.createElement("div",{className:"flex-1"},r.createElement("div",{className:"flex items-center gap-3 mb-2"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white"},"Orden #",e.order_number||e.id),r.createElement(w.A,{variant:p.variant,size:"sm"},r.createElement(y,{className:"w-3 h-3 mr-1"}),p.label),e.priority&&r.createElement("span",{className:(0,T.A)("px-2 py-1 text-xs font-medium rounded-full",{low:"bg-gray-100 text-gray-600",medium:"bg-yellow-100 text-yellow-700",high:"bg-orange-100 text-orange-700",urgent:"bg-red-100 text-red-700"}[e.priority])},e.priority.charAt(0).toUpperCase()+e.priority.slice(1))),r.createElement("p",{className:"text-gray-600 dark:text-gray-400"},e.recipe?.name||e.product_name)),r.createElement("div",{className:"relative"},r.createElement(f.A,{variant:"ghost",size:"sm",icon:A.A,onClick:()=>d(!i),className:"text-gray-400 hover:text-gray-600"}),i&&r.createElement("div",{className:"absolute right-0 mt-2 w-48 bg-white dark:bg-gray-800 rounded-lg shadow-lg border dark:border-gray-700 py-1 z-10"},r.createElement("button",{onClick:()=>E((()=>n(e))),className:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2"},r.createElement(l.A,{className:"w-4 h-4"}),"Asignar Lotes"),"pending"===e.status&&r.createElement("button",{onClick:()=>E((()=>s(e,"in_progress"))),className:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2"},r.createElement(m.A,{className:"w-4 h-4"}),"Iniciar Producción"),"in_progress"===e.status&&r.createElement(r.Fragment,null,r.createElement("button",{onClick:()=>E((()=>s(e,"completed"))),className:"w-full text-left px-4 py-2 text-sm text-green-700 dark:text-green-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2"},r.createElement(g.A,{className:"w-4 h-4"}),"Marcar Completado"),r.createElement("button",{onClick:()=>E((()=>s(e,"on_hold"))),className:"w-full text-left px-4 py-2 text-sm text-yellow-700 dark:text-yellow-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2"},r.createElement(k.A,{className:"w-4 h-4"}),"Pausar")),"on_hold"===e.status&&r.createElement("button",{onClick:()=>E((()=>s(e,"in_progress"))),className:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2"},r.createElement(m.A,{className:"w-4 h-4"}),"Reanudar"),r.createElement("div",{className:"border-t dark:border-gray-700 my-1"}),r.createElement("button",{onClick:()=>E((()=>t(e))),className:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2"},r.createElement(C.A,{className:"w-4 h-4"}),"Editar"),r.createElement("button",{onClick:()=>E((()=>c(e))),className:"w-full text-left px-4 py-2 text-sm text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2"},r.createElement(S.A,{className:"w-4 h-4"}),"Duplicar"),"in_progress"!==e.status&&r.createElement("button",{onClick:()=>E((()=>a(e.id))),className:"w-full text-left px-4 py-2 text-sm text-red-600 dark:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-700 flex items-center gap-2"},r.createElement(z.A,{className:"w-4 h-4"}),"Eliminar")))),r.createElement("div",{className:"grid grid-cols-2 gap-4 mb-4"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Cantidad"),r.createElement("p",{className:"font-medium text-gray-900 dark:text-white"},e.quantity," ",e.unit||"unidades")),r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Lote"),r.createElement("p",{className:"font-medium text-gray-900 dark:text-white"},e.batch_number||"-")),r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Fecha Programada"),r.createElement("p",{className:"font-medium text-gray-900 dark:text-white"},e.scheduled_date?new Date(e.scheduled_date).toLocaleDateString():"No programado")),r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Responsable"),r.createElement("p",{className:"font-medium text-gray-900 dark:text-white"},e.assigned_to||"Sin asignar"))),"in_progress"===e.status&&r.createElement("div",{className:"mb-4"},r.createElement("div",{className:"flex items-center justify-between mb-1"},r.createElement("span",{className:"text-sm text-gray-500 dark:text-gray-400"},"Progreso"),r.createElement("span",{className:"text-sm font-medium text-gray-900 dark:text-white"},x,"%")),r.createElement("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},r.createElement("div",{className:"bg-venezia-500 h-2 rounded-full transition-all duration-300",style:{width:`${x}%`}}))),e.estimated_cost&&r.createElement("div",{className:"flex items-center justify-between pt-4 border-t dark:border-gray-700"},r.createElement("span",{className:"text-sm text-gray-500 dark:text-gray-400"},"Costo Estimado"),r.createElement("span",{className:"font-medium text-gray-900 dark:text-white"},"$",e.estimated_cost.toFixed(2))),e.notes&&r.createElement("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},e.notes))),r.createElement("div",{className:"px-6 py-3 bg-gray-50 dark:bg-gray-700/30 border-t dark:border-gray-700 flex items-center justify-between"},r.createElement("div",{className:"flex items-center gap-3 text-sm text-gray-500 dark:text-gray-400"},r.createElement("span",{className:"flex items-center gap-1"},r.createElement(o.A,{className:"w-4 h-4"}),e.recipe?.preparation_time||30," min"),e.store_name&&r.createElement("span",{className:"flex items-center gap-1"},r.createElement(l.A,{className:"w-4 h-4"}),e.store_name)),r.createElement(f.A,{onClick:()=>n(e),variant:"ghost",size:"xs",icon:D.A},"Detalles")))},P=a(37946),j=a(40073),q=a(48686),$=a(80827),O=a(48697),I=a(48852),M=a(67773),F=({isOpen:e,onClose:t,onSave:a,order:s=null,recipes:c=[],products:i=[],users:d=[]})=>{const[m,g]=(0,r.useState)({recipe_id:"",product_id:"",quantity:1,unit:"unidad",scheduled_date:(new Date).toISOString().split("T")[0],scheduled_time:"08:00",priority:"medium",assigned_to:"",notes:"",batch_size:1,estimated_duration:60}),[p,y]=(0,r.useState)({}),[E,b]=(0,r.useState)(!1),[h,w]=(0,r.useState)(null);(0,r.useEffect)((()=>{g(s?{recipe_id:s.recipe_id||"",product_id:s.product_id||"",quantity:s.quantity||1,unit:s.unit||"unidad",scheduled_date:s.scheduled_date?new Date(s.scheduled_date).toISOString().split("T")[0]:(new Date).toISOString().split("T")[0],scheduled_time:s.scheduled_time||"08:00",priority:s.priority||"medium",assigned_to:s.assigned_to||"",notes:s.notes||"",batch_size:s.batch_size||1,estimated_duration:s.estimated_duration||60}:{recipe_id:"",product_id:"",quantity:1,unit:"unidad",scheduled_date:(new Date).toISOString().split("T")[0],scheduled_time:"08:00",priority:"medium",assigned_to:"",notes:"",batch_size:1,estimated_duration:60}),y({})}),[s]),(0,r.useEffect)((()=>{if(m.recipe_id){const e=c.find((e=>e.id===parseInt(m.recipe_id)));w(e),e&&g((t=>({...t,product_id:e.product_id||t.product_id,unit:e.yield_unit||t.unit,estimated_duration:e.preparation_time||t.estimated_duration})))}else w(null)}),[m.recipe_id,c]);const _=e=>{const{name:t,value:a}=e.target;g((e=>({...e,[t]:a}))),p[t]&&y((e=>({...e,[t]:""})))},k=()=>{if(!h)return{cost:0,batches:1};const e=Math.ceil(m.quantity/m.batch_size);return{cost:h.total_cost?h.total_cost*m.quantity/h.yield_quantity:0,batches:e}},A=k();return r.createElement(M.A,{isOpen:e,onClose:t,title:r.createElement("div",{className:"flex items-center gap-2"},r.createElement(n.A,{className:"w-5 h-5"}),s?"Editar Orden de Producción":"Nueva Orden de Producción"),size:"lg"},r.createElement("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return m.recipe_id||m.product_id||(e.recipe_id="Debe seleccionar una receta o producto"),m.quantity<=0&&(e.quantity="La cantidad debe ser mayor a 0"),m.batch_size<=0&&(e.batch_size="El tamaño de lote debe ser mayor a 0"),m.scheduled_date||(e.scheduled_date="La fecha es requerida"),m.estimated_duration<=0&&(e.estimated_duration="La duración debe ser mayor a 0"),y(e),0===Object.keys(e).length})()){b(!0);try{const e=k();let r="";if(m.recipe_id&&h)r=h.name;else if(m.product_id&&i.length>0){const e=i.find((e=>e.id===parseInt(m.product_id)));r=e?.name||""}const n={...m,product_name:r,quantity:parseFloat(m.quantity),batch_size:parseFloat(m.batch_size),estimated_duration:parseInt(m.estimated_duration),estimated_cost:e.cost,estimated_batches:e.batches,scheduled_datetime:`${m.scheduled_date}T${m.scheduled_time}:00`,status:s?.status||"pending",created_by:"current_user"};await a(n),t()}catch(e){console.error("Error saving production order:",e),y({general:"Error al guardar la orden de producción"})}finally{b(!1)}}},className:"space-y-6"},p.general&&r.createElement("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3"},r.createElement("div",{className:"flex items-center gap-2 text-red-700 dark:text-red-300"},r.createElement(P.A,{className:"w-4 h-4"}),r.createElement("span",{className:"text-sm"},p.general))),r.createElement("div",{className:"space-y-4"},r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white"},"Producto a Fabricar"),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},r.createElement(v.A,{label:"Receta",name:"recipe_id",value:m.recipe_id,onChange:_,options:[{value:"",label:"Seleccionar receta"},...c.map((e=>({value:e.id.toString(),label:`${e.name} (${e.yield_quantity} ${e.yield_unit})`})))],error:p.recipe_id,icon:l.A}),r.createElement(v.A,{label:"Producto Final",name:"product_id",value:m.product_id,onChange:_,options:[{value:"",label:"Seleccionar producto"},...i.map((e=>({value:e.id.toString(),label:e.name})))],icon:l.A,disabled:!!m.recipe_id})),h&&r.createElement("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4"},r.createElement("div",{className:"flex items-start gap-3"},r.createElement(P.A,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5"}),r.createElement("div",{className:"text-sm"},r.createElement("p",{className:"font-medium text-blue-900 dark:text-blue-100"},"Información de la Receta"),r.createElement("p",{className:"text-blue-700 dark:text-blue-300 mt-1"},"Rendimiento: ",h.yield_quantity," ",h.yield_unit),r.createElement("p",{className:"text-blue-700 dark:text-blue-300"},"Tiempo estimado: ",h.preparation_time," minutos"),h.total_cost&&r.createElement("p",{className:"text-blue-700 dark:text-blue-300"},"Costo por unidad: $",(h.total_cost/h.yield_quantity).toFixed(2)))))),r.createElement("div",{className:"space-y-4"},r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white"},"Detalles de Producción"),r.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4"},r.createElement(N.A,{label:"Cantidad a Producir",name:"quantity",type:"number",step:"0.01",value:m.quantity,onChange:_,error:p.quantity,icon:j.A,required:!0}),r.createElement(v.A,{label:"Unidad",name:"unit",value:m.unit,onChange:_,options:[{value:"unidad",label:"Unidad"},{value:"kg",label:"Kilogramos"},{value:"litro",label:"Litros"},{value:"docena",label:"Docenas"},{value:"caja",label:"Cajas"}]}),r.createElement(N.A,{label:"Tamaño de Lote",name:"batch_size",type:"number",step:"0.01",value:m.batch_size,onChange:_,error:p.batch_size,icon:l.A}),r.createElement(N.A,{label:"Duración (min)",name:"estimated_duration",type:"number",value:m.estimated_duration,onChange:_,error:p.estimated_duration,icon:o.A}))),r.createElement("div",{className:"space-y-4"},r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white"},"Programación"),r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4"},r.createElement(N.A,{label:"Fecha Programada",name:"scheduled_date",type:"date",value:m.scheduled_date,onChange:_,error:p.scheduled_date,icon:x.A,min:(new Date).toISOString().split("T")[0],required:!0}),r.createElement(N.A,{label:"Hora",name:"scheduled_time",type:"time",value:m.scheduled_time,onChange:_,icon:o.A}),r.createElement(v.A,{label:"Prioridad",name:"priority",value:m.priority,onChange:_,options:[{value:"low",label:"Baja"},{value:"medium",label:"Media"},{value:"high",label:"Alta"},{value:"urgent",label:"Urgente"}],icon:u.A})),r.createElement(v.A,{label:"Asignar a",name:"assigned_to",value:m.assigned_to,onChange:_,options:[{value:"",label:"Sin asignar"},...d.map((e=>({value:e.id||e.name,label:e.name||e.email})))],icon:q.A})),h&&r.createElement("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4"},r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white mb-3"},"Estimaciones"),r.createElement("div",{className:"grid grid-cols-2 gap-4"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Número de Lotes"),r.createElement("p",{className:"text-lg font-medium text-gray-900 dark:text-white"},A.batches)),r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-500 dark:text-gray-400"},"Costo Estimado Total"),r.createElement("p",{className:"text-lg font-medium text-gray-900 dark:text-white"},"$",A.cost.toFixed(2))))),r.createElement(N.A,{label:"Notas",name:"notes",value:m.notes,onChange:_,placeholder:"Instrucciones especiales o notas adicionales (opcional)",multiline:!0,rows:3,icon:$.A}),r.createElement("div",{className:"flex justify-end gap-3 pt-4 border-t dark:border-gray-700"},r.createElement(f.A,{type:"button",onClick:t,variant:"outline",icon:O.A},"Cancelar"),r.createElement(f.A,{type:"submit",variant:"primary",icon:I.A,loading:E},s?"Actualizar":"Crear"," Orden"))))},R=a(3802),U=a(65680),J=a(76316),B=a(78793),V=({batch:e,order:t,onUpdateStatus:a,onComplete:s,ingredients:n=[]})=>{const[c,i]=(0,r.useState)(0),[d,o]=(0,r.useState)("in_progress"===e.status);(0,r.useEffect)((()=>{if(!d)return;const t=e.started_at?new Date(e.started_at).getTime():Date.now(),a=setInterval((()=>{const e=Date.now(),a=Math.floor((e-t)/1e3);i(a)}),1e3);return()=>clearInterval(a)}),[d,e.started_at]);const u=async t=>{try{await a(e.id,t),o("in_progress"===t)}catch(e){console.error("Error updating batch status:",e)}},p=t?.estimated_duration||60,y=Math.min(c/(60*p)*100,100),E=(()=>{if(!t?.recipe?.recipe_ingredients)return{available:!0,missing:[]};const a=[];return t.recipe.recipe_ingredients.forEach((t=>{const r=n.find((e=>e.id===t.ingredient_id)),s=t.quantity*e.quantity;(!r||r.current_stock<s)&&a.push({name:r?.name||"Desconocido",needed:s,available:r?.current_stock||0})})),{available:0===a.length,missing:a}})();return r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700 p-6"},r.createElement("div",{className:"flex items-start justify-between mb-4"},r.createElement("div",null,r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white flex items-center gap-2"},r.createElement(l.A,{className:"w-5 h-5"}),"Lote #",e.batch_number),r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1"},t?.recipe?.name||t?.product_name," - ",e.quantity," ",t?.unit)),r.createElement("span",{className:(0,T.A)("px-3 py-1 rounded-full text-sm font-medium",(e=>{switch(e){case"pending":default:return"bg-gray-100 text-gray-700";case"in_progress":return"bg-yellow-100 text-yellow-700";case"completed":return"bg-green-100 text-green-700";case"paused":return"bg-blue-100 text-blue-700";case"cancelled":return"bg-red-100 text-red-700"}})(e.status))},"pending"===e.status&&"Pendiente","in_progress"===e.status&&"En Proceso","completed"===e.status&&"Completado","paused"===e.status&&"Pausado","cancelled"===e.status&&"Cancelado")),"in_progress"===e.status&&r.createElement("div",{className:"mb-4"},r.createElement("div",{className:"flex items-center justify-between mb-2"},r.createElement("span",{className:"text-sm text-gray-600 dark:text-gray-400"},"Progreso"),r.createElement("span",{className:"text-sm font-medium"},Math.round(y),"%")),r.createElement("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},r.createElement("div",{className:"bg-venezia-500 h-2 rounded-full transition-all duration-300",style:{width:`${y}%`}}))),r.createElement("div",{className:"grid grid-cols-2 gap-4 mb-4"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement(q.A,{className:"w-4 h-4 text-gray-400"}),r.createElement("div",null,r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400"},"Responsable"),r.createElement("p",{className:"text-sm font-medium"},e.assigned_to||"Sin asignar"))),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(x.A,{className:"w-4 h-4 text-gray-400"}),r.createElement("div",null,r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400"},"Fecha Inicio"),r.createElement("p",{className:"text-sm font-medium"},new Date(e.start_date).toLocaleDateString()))),d&&r.createElement("div",{className:"flex items-center gap-2"},r.createElement(U.A,{className:"w-4 h-4 text-gray-400"}),r.createElement("div",null,r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400"},"Tiempo Transcurrido"),r.createElement("p",{className:"text-sm font-medium text-venezia-600 dark:text-venezia-400"},(e=>{const t=Math.floor(e/3600),a=Math.floor(e%3600/60),r=e%60;return t>0?`${t}h ${a}m ${r}s`:a>0?`${a}m ${r}s`:`${r}s`})(c)))),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(J.A,{className:"w-4 h-4 text-gray-400"}),r.createElement("div",null,r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400"},"Eficiencia"),r.createElement("p",{className:"text-sm font-medium"},y<=100?r.createElement("span",{className:"text-green-600"},"En tiempo"):r.createElement("span",{className:"text-red-600"},"Retrasado"))))),!E.available&&"pending"===e.status&&r.createElement("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 rounded-lg border border-red-200 dark:border-red-800"},r.createElement("div",{className:"flex items-start gap-2"},r.createElement(P.A,{className:"w-5 h-5 text-red-600 dark:text-red-400 mt-0.5"}),r.createElement("div",{className:"flex-1"},r.createElement("p",{className:"text-sm font-medium text-red-900 dark:text-red-100"},"Ingredientes Insuficientes"),r.createElement("ul",{className:"mt-1 text-xs text-red-700 dark:text-red-300 space-y-1"},E.missing.map(((e,t)=>r.createElement("li",{key:t},e.name,": Necesita ",e.needed,", disponible ",e.available))))))),e.notes&&r.createElement("div",{className:"mb-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},e.notes)),r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",{className:"flex items-center gap-2"},"pending"===e.status&&r.createElement(f.A,{onClick:()=>u("in_progress"),variant:"primary",size:"sm",icon:m.A,disabled:!E.available},"Iniciar"),"in_progress"===e.status&&r.createElement(r.Fragment,null,r.createElement(f.A,{onClick:()=>u("paused"),variant:"outline",size:"sm",icon:k.A},"Pausar"),r.createElement(f.A,{onClick:()=>u("completed"),variant:"success",size:"sm",icon:g.A},"Completar")),"paused"===e.status&&r.createElement(f.A,{onClick:()=>u("in_progress"),variant:"primary",size:"sm",icon:m.A},"Reanudar"),("pending"===e.status||"paused"===e.status)&&r.createElement(f.A,{onClick:()=>u("cancelled"),variant:"danger",size:"sm",icon:_.A},"Cancelar")),r.createElement(f.A,{variant:"ghost",size:"sm",icon:B.A},"Ver Métricas")))},H=()=>{const e=(0,s.zy)(),[t,a]=(0,r.useState)((e.pathname,"orders")),[_,k]=(0,r.useState)(""),[A,C]=(0,r.useState)("all"),[S,z]=(0,r.useState)("all"),[D,P]=(0,r.useState)("all"),[j,q]=(0,r.useState)("scheduled_date"),[$,O]=(0,r.useState)("grid"),[I,M]=(0,r.useState)(!1),[U,J]=(0,r.useState)(!1),[B,H]=(0,r.useState)(null),{success:W,error:G,warning:K}=(0,b.d)(),{data:X,loading:Q,refetch:Y}=(0,E.Wl)("/api/production_orders"),{data:Z,loading:ee,refetch:te}=(0,E.Wl)("/api/production_batches"),{data:ae,loading:re}=(0,E.Wl)("/api/recipes"),{data:se,loading:ne}=(0,E.Wl)("/api/products"),{data:le,loading:ce}=(0,E.Wl)("/api/ingredients"),ie=X||[],de=Z||[],oe=Array.isArray(ae?.recipes)?ae.recipes:Array.isArray(ae)?ae:[],me=Array.isArray(se?.products)?se.products:Array.isArray(se)?se:[],ue=Array.isArray(le?.ingredients)?le.ingredients:Array.isArray(le)?le:[],ge=Q||ee||re||ne||ce;((e=[],t=[])=>{const{info:a,success:s,warning:n}=(0,b.d)(),l=(0,r.useRef)([]),c=(0,r.useRef)([]);(0,r.useEffect)((()=>{const r=l.current;e.forEach((e=>{const t=r.find((t=>t.id===e.id));if(t&&t.status!==e.status)switch(e.status){case"in_progress":a(`Lote ${e.batch_number} iniciado`,"El lote ha comenzado producción");break;case"completed":s(`Lote ${e.batch_number} completado`,"La producción del lote ha finalizado exitosamente"),i();break;case"paused":n(`Lote ${e.batch_number} pausado`,"La producción ha sido pausada temporalmente");break;case"cancelled":n(`Lote ${e.batch_number} cancelado`,"La producción del lote ha sido cancelada")}}));const d=c.current;t.forEach((e=>{const t=d.find((t=>t.id===e.id));t&&"completed"!==t.status&&"completed"===e.status&&s(`Orden #${e.order_number||e.id} completada`,"Todos los lotes han sido producidos exitosamente")})),l.current=[...e],c.current=[...t]}),[e,t,a,s,n]);const i=()=>{try{const e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),a=e.createGain();t.connect(a),a.connect(e.destination),t.frequency.value=800,t.type="sine",a.gain.setValueAtTime(.3,e.currentTime),a.gain.exponentialRampToValueAtTime(.01,e.currentTime+.2),t.start(e.currentTime),t.stop(e.currentTime+.2)}catch(e){console.log("Could not play notification sound")}}})(de,ie),(0,r.useEffect)((()=>{const e=e=>{if("INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&"SELECT"!==e.target.tagName)if("n"===e.key&&e.ctrlKey)e.preventDefault(),H(null),M(!0);else if("r"===e.key&&e.ctrlKey)e.preventDefault(),he();else if(e.key>="1"&&e.key<="3"){const t=parseInt(e.key)-1,r=["orders","batches","analytics"];r[t]&&a(r[t])}};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[]);const pe=(0,r.useMemo)((()=>{const e=new Date;return e.setHours(0,0,0,0),{pending:ie.filter((e=>"pending"===e.status)).length,inProgress:ie.filter((e=>"in_progress"===e.status)).length,completed:ie.filter((e=>"completed"===e.status)).length,dueToday:ie.filter((t=>{const a=new Date(t.scheduled_date);return a.setHours(0,0,0,0),a.getTime()===e.getTime()&&"completed"!==t.status})).length}}),[ie]),ye=(0,r.useMemo)((()=>ie.filter((e=>{const t=(e.recipe?.name||"").toLowerCase().includes(_.toLowerCase())||(e.product_name||"").toLowerCase().includes(_.toLowerCase())||(e.order_number||"").toLowerCase().includes(_.toLowerCase())||(e.batch_number||"").toLowerCase().includes(_.toLowerCase()),a="all"===A||e.status===A,r="all"===S||e.priority===S;let s=!0;if("all"!==D){const t=new Date(e.scheduled_date),a=new Date;switch(D){case"today":s=t.toDateString()===a.toDateString();break;case"week":const e=new Date;e.setDate(e.getDate()-7),s=t>=e;break;case"month":const r=new Date;r.setMonth(r.getMonth()-1),s=t>=r}}return t&&a&&r&&s})).sort(((e,t)=>{switch(j){case"scheduled_date":return new Date(e.scheduled_date)-new Date(t.scheduled_date);case"priority":const a={urgent:0,high:1,medium:2,low:3};return a[e.priority]-a[t.priority];case"status":return e.status.localeCompare(t.status);default:return 0}}))),[ie,_,A,S,D,j]),xe=(0,r.useMemo)((()=>de.filter((e=>{const t=(e.batch_number||"").toLowerCase().includes(_.toLowerCase())||(e.assigned_to||"").toLowerCase().includes(_.toLowerCase())||(e.order_id||"").toString().includes(_.toLowerCase()),a="all"===A||e.status===A;return t&&a})).sort(((e,t)=>{switch(j){case"batch_number":return(e.batch_number||"").localeCompare(t.batch_number||"");case"start_date":return new Date(e.start_date||0)-new Date(t.start_date||0);case"status":return(e.status||"").localeCompare(t.status||"");default:return 0}}))),[de,_,A,j]),Ee=async(e,t)=>{try{const a=await fetch(`/api/production_orders/${e.id}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})});if(a.ok)W("Estado actualizado",`La orden ahora está ${fe(t)}`),Y(),"in_progress"===t&&te();else{const e=await a.json();G("Error",e.error||"No se pudo actualizar el estado")}}catch(e){G("Error","Error al actualizar el estado")}},be=async e=>{if(window.confirm("¿Está seguro de eliminar esta orden de producción?"))try{const t=await fetch(`/api/production_orders/${e}`,{method:"DELETE"});if(t.ok)W("Eliminado","Orden de producción eliminada correctamente"),Y();else{const e=await t.json();G("Error",e.error||"No se pudo eliminar la orden")}}catch(e){G("Error","Error al eliminar la orden")}},he=()=>{Y(),te(),W("Actualizado","Datos actualizados correctamente")},fe=e=>({pending:"Pendiente",in_progress:"En Proceso",completed:"Completado",cancelled:"Cancelado",on_hold:"En Espera"}[e]||e),Ne=[{id:"orders",label:"Órdenes de Producción",icon:n.A,count:ie.length},{id:"batches",label:"Lotes",icon:l.A,count:de.length},{id:"analytics",label:"Análisis",icon:c.A}];return r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},r.createElement("div",null,r.createElement("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white"},"Gestión de Producción"),r.createElement("p",{className:"text-gray-600 dark:text-gray-400 mt-1"},"Control de órdenes de producción y lotes")),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(f.A,{onClick:he,variant:"outline",size:"sm",icon:i.A,title:"Actualizar (Ctrl+R)"},"Actualizar"),r.createElement(f.A,{onClick:()=>{H(null),M(!0)},variant:"primary",icon:d.A,title:"Nueva Orden (Ctrl+N)"},"Nueva Orden"))),r.createElement("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4"},r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Pendientes"),r.createElement("p",{className:"text-2xl font-bold mt-1"},pe.pending)),r.createElement(o.A,{className:"w-8 h-8 text-gray-400 dark:text-gray-500"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"En Proceso"),r.createElement("p",{className:"text-2xl font-bold mt-1 text-blue-600"},pe.inProgress)),r.createElement(m.A,{className:"w-8 h-8 text-blue-600"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Vencen Hoy"),r.createElement("p",{className:"text-2xl font-bold mt-1 text-orange-600"},pe.dueToday)),r.createElement(u.A,{className:"w-8 h-8 text-orange-600"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Completadas"),r.createElement("p",{className:"text-2xl font-bold mt-1 text-green-600"},pe.completed)),r.createElement(g.A,{className:"w-8 h-8 text-green-600"})))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700"},r.createElement("div",{className:"border-b dark:border-gray-700"},r.createElement("div",{className:"flex overflow-x-auto"},Ne.map((e=>{const s=e.icon;return r.createElement("button",{key:e.id,onClick:()=>a(e.id),className:(0,T.A)("flex items-center gap-2 px-6 py-3 border-b-2 transition-colors whitespace-nowrap",t===e.id?"border-venezia-600 text-venezia-600 dark:text-venezia-400":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200")},r.createElement(s,{className:"w-4 h-4"}),r.createElement("span",null,e.label),void 0!==e.count&&r.createElement(w.A,{size:"xs",variant:"default"},e.count))})))),("orders"===t||"batches"===t)&&r.createElement("div",{className:"p-4 border-b dark:border-gray-700"},r.createElement("div",{className:"flex flex-col sm:flex-row gap-3"},r.createElement("div",{className:"flex-1"},r.createElement(N.A,{type:"text",placeholder:"orders"===t?"Buscar órdenes...":"Buscar lotes...",value:_,onChange:e=>k(e.target.value),icon:p.A})),r.createElement(v.A,{value:A,onChange:e=>C(e.target.value),options:[{value:"all",label:"Todos los estados"},{value:"pending",label:"Pendiente"},{value:"in_progress",label:"En Proceso"},{value:"completed",label:"Completado"},{value:"on_hold",label:"En Espera"},{value:"cancelled",label:"Cancelado"}],icon:y.A,className:"w-full sm:w-48"}),r.createElement(v.A,{value:S,onChange:e=>z(e.target.value),options:[{value:"all",label:"Todas las prioridades"},{value:"low",label:"Baja"},{value:"medium",label:"Media"},{value:"high",label:"Alta"},{value:"urgent",label:"Urgente"}],icon:u.A,className:"w-full sm:w-48"}),r.createElement(v.A,{value:D,onChange:e=>P(e.target.value),options:[{value:"all",label:"Todas las fechas"},{value:"today",label:"Hoy"},{value:"week",label:"Esta semana"},{value:"month",label:"Este mes"}],icon:x.A,className:"w-full sm:w-40"}))),r.createElement("div",{className:"p-6"},ge?r.createElement("div",{className:"flex items-center justify-center h-64"},r.createElement(h.A,{size:"lg"})):r.createElement(r.Fragment,null,"orders"===t&&r.createElement(r.Fragment,null,U&&B?r.createElement("div",{className:"space-y-4"},r.createElement(R.A,{order:B,onAssignBatch:async(e,t)=>{try{const a=await fetch(`/api/production_orders/${e}/batches`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({batches:t})});if(a.ok)W("Lotes asignados","Los lotes se asignaron correctamente"),Y(),te(),J(!1),H(null);else{const e=await a.json();G("Error",e.error||"No se pudieron asignar los lotes")}}catch(e){G("Error","Error al asignar los lotes")}},onCancel:()=>{J(!1),H(null)},users:[{id:"1",name:"Juan Pérez"},{id:"2",name:"María García"},{id:"3",name:"Carlos López"}],existingBatches:de.filter((e=>e.order_id===B.id))}),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700 p-6"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Detalles de la Orden"),B.recipe&&r.createElement("div",{className:"space-y-4"},r.createElement("div",null,r.createElement("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Ingredientes Necesarios"),r.createElement("div",{className:"space-y-2"},B.recipe.recipe_ingredients?.map(((e,t)=>{const a=ue.find((t=>t.id===e.ingredient_id)),s=e.quantity*B.quantity,n=a?.current_stock||0,l=n>=s;return r.createElement("div",{key:t,className:"flex items-center justify-between p-2 bg-gray-50 dark:bg-gray-700/50 rounded"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement("span",{className:"text-sm"},a?.name||"Desconocido"),!l&&r.createElement(w.A,{variant:"danger",size:"xs"},r.createElement(u.A,{className:"w-3 h-3 mr-1"}),"Insuficiente")),r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},r.createElement("span",{className:l?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"},n.toFixed(2)),r.createElement("span",null," / ",s.toFixed(2)," ",a?.unit)))})))),r.createElement("div",null,r.createElement("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},"Línea de Tiempo Estimada"),r.createElement("div",{className:"relative"},r.createElement("div",{className:"absolute left-4 top-0 bottom-0 w-0.5 bg-gray-300 dark:bg-gray-600"}),r.createElement("div",{className:"space-y-4"},r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"},r.createElement(o.A,{className:"w-4 h-4 text-white"})),r.createElement("div",null,r.createElement("p",{className:"text-sm font-medium"},"Inicio Programado"),r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400"},new Date(B.scheduled_date).toLocaleDateString()," - ",B.scheduled_time))),r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:"w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center"},r.createElement(m.A,{className:"w-4 h-4 text-white"})),r.createElement("div",null,r.createElement("p",{className:"text-sm font-medium"},"Duración Estimada"),r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400"},B.estimated_duration||60," minutos"))),r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center"},r.createElement(g.A,{className:"w-4 h-4 text-white"})),r.createElement("div",null,r.createElement("p",{className:"text-sm font-medium"},"Finalización Esperada"),r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400"},(()=>{const e=new Date(B.scheduled_date+"T"+B.scheduled_time);return e.setMinutes(e.getMinutes()+(B.estimated_duration||60)),e.toLocaleString()})()))))))))):r.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4"},ye.map((e=>r.createElement(L,{key:e.id,order:e,onEdit:e=>{H(e),M(!0)},onDelete:be,onStatusChange:Ee,onViewDetails:e=>{H(e),J(!0)},onDuplicate:e=>{const t={...e,id:null,order_number:null,status:"pending",scheduled_date:(new Date).toISOString().split("T")[0]};H(t),M(!0)}}))),0===ye.length&&r.createElement("div",{className:"col-span-full text-center py-12"},r.createElement(n.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),r.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"No se encontraron órdenes de producción")))),"batches"===t&&r.createElement("div",null,0===xe.length?r.createElement("div",{className:"text-center py-12"},r.createElement(l.A,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),r.createElement("p",{className:"text-gray-500 dark:text-gray-400"},0===de.length?"No hay lotes asignados":"No se encontraron lotes"),r.createElement("p",{className:"text-sm text-gray-400 dark:text-gray-500 mt-1"},0===de.length?"Los lotes aparecerán aquí cuando asignes órdenes de producción":"Prueba con otros filtros de búsqueda")):r.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4"},xe.map((e=>{const t=ie.find((t=>t.id===e.order_id));return r.createElement(V,{key:e.id,batch:e,order:t,ingredients:ue,onUpdateStatus:async(a,r)=>{try{if((await fetch(`/api/production_batches/${a}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:r})})).ok){if(W("Estado actualizado",`El lote ahora está ${r}`),te(),"completed"===r){if(de.filter((t=>t.order_id===e.order_id)).every((t=>t.id===e.id?"completed"===r:"completed"===t.status))&&t&&await Ee(t,"completed"),t?.recipe?.recipe_ingredients)try{await fetch("/api/production/consume-ingredients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({orderId:t.id,batchId:e.id,quantity:e.quantity,ingredients:t.recipe.recipe_ingredients})}),t.product_id&&await fetch(`/api/products/${t.product_id}/stock`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({adjustment:e.quantity,type:"production",reference:`Lote ${e.batch_number}`})}),info("Inventario actualizado","Stock de ingredientes y productos actualizado")}catch(e){K("Advertencia","No se pudo actualizar el inventario automáticamente")}}}else G("Error","No se pudo actualizar el estado del lote")}catch(e){G("Error","Error al actualizar el lote")}},onComplete:async e=>{te(),Y()}})})))),"analytics"===t&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border dark:border-gray-700"},r.createElement("div",{className:"text-center"},r.createElement("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Eficiencia"),r.createElement("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400 mt-1"},ie.length>0?Math.round(pe.completed/ie.length*100):0,"%"))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border dark:border-gray-700"},r.createElement("div",{className:"text-center"},r.createElement("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Tiempo Promedio"),r.createElement("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400 mt-1"},ie.filter((e=>e.recipe?.preparation_time)).length>0?Math.round(ie.filter((e=>e.recipe?.preparation_time)).reduce(((e,t)=>e+(t.recipe.preparation_time||0)),0)/ie.filter((e=>e.recipe?.preparation_time)).length):0," min"))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border dark:border-gray-700"},r.createElement("div",{className:"text-center"},r.createElement("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Lotes Activos"),r.createElement("p",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400 mt-1"},de.filter((e=>"in_progress"===e.status)).length))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border dark:border-gray-700"},r.createElement("div",{className:"text-center"},r.createElement("h3",{className:"text-sm font-medium text-gray-600 dark:text-gray-400"},"Costo Total"),r.createElement("p",{className:"text-2xl font-bold text-gray-900 dark:text-white mt-1"},"$",ie.reduce(((e,t)=>e+(t.estimated_cost||0)),0).toFixed(0))))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700 p-6"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Producción por Receta"),r.createElement("div",{className:"space-y-3"},(()=>{const e={};return ie.forEach((t=>{const a=t.recipe?.name||t.product_name||"Sin receta";e[a]||(e[a]={count:0,quantity:0,completed:0}),e[a].count++,e[a].quantity+=t.quantity||0,"completed"===t.status&&e[a].completed++})),Object.entries(e).sort((([,e],[,t])=>t.count-e.count)).slice(0,5).map((([e,t])=>r.createElement("div",{key:e,className:"flex items-center justify-between"},r.createElement("div",{className:"flex-1"},r.createElement("div",{className:"flex items-center justify-between mb-1"},r.createElement("span",{className:"text-sm font-medium text-gray-900 dark:text-white"},e),r.createElement("span",{className:"text-sm text-gray-500 dark:text-gray-400"},t.count," órdenes • ",t.quantity," unidades")),r.createElement("div",{className:"w-full bg-gray-200 dark:bg-gray-700 rounded-full h-2"},r.createElement("div",{className:"bg-venezia-500 h-2 rounded-full",style:{width:t.completed/t.count*100+"%"}}))))))})())),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700 p-6"},r.createElement("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-4"},"Actividad Reciente"),r.createElement("div",{className:"space-y-3"},ie.sort(((e,t)=>new Date(t.updated_at||t.created_at)-new Date(e.updated_at||e.created_at))).slice(0,5).map((e=>r.createElement("div",{key:e.id,className:"flex items-center gap-3 py-2"},r.createElement("div",{className:(0,T.A)("w-2 h-2 rounded-full","completed"===e.status?"bg-green-500":"in_progress"===e.status?"bg-yellow-500":"cancelled"===e.status?"bg-red-500":"bg-gray-400")}),r.createElement("div",{className:"flex-1"},r.createElement("p",{className:"text-sm text-gray-900 dark:text-white"},"Orden #",e.order_number||e.id," - ",e.recipe?.name||e.product_name),r.createElement("p",{className:"text-xs text-gray-500 dark:text-gray-400"},e.updated_at?`Actualizado ${new Date(e.updated_at).toLocaleDateString()}`:`Creado ${new Date(e.created_at||Date.now()).toLocaleDateString()}`)),r.createElement(w.A,{variant:"completed"===e.status?"success":"in_progress"===e.status?"warning":"cancelled"===e.status?"danger":"default",size:"xs"},fe(e.status))))),0===ie.length&&r.createElement("p",{className:"text-gray-500 dark:text-gray-400 text-center py-4"},"No hay actividad reciente"))))))),r.createElement(F,{isOpen:I,onClose:()=>{M(!1),H(null)},onSave:async e=>{try{const t=B?`/api/production_orders/${B.id}`:"/api/production_orders",a=await fetch(t,{method:B?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(a.ok)W(B?"Orden actualizada":"Orden creada",`La orden de producción se ${B?"actualizó":"creó"} correctamente`),Y(),M(!1),H(null);else{const e=await a.json();G("Error",e.error||"No se pudo guardar la orden")}}catch(e){G("Error","Error al guardar la orden de producción")}},order:B,recipes:oe,products:me,users:[{id:"1",name:"Juan Pérez"},{id:"2",name:"María García"},{id:"3",name:"Carlos López"}]}))}}}]);