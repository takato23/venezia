"use strict";(self.webpackChunkvenezia_frontend=self.webpackChunkvenezia_frontend||[]).push([[746],{30746:function(e,t,a){a.r(t),a.d(t,{default:function(){return N}});var s=a(96540),l=a(42640),n=a(48686),r=a(54687),c=a(76316),m=a(94945),i=a(17133),o=a(37946),d=a(8723),u=a(27775),p=a(32307),E=a(29696),x=a(86589),g=a(44471),b=a(1474),y=a(42693),v=()=>{const[e,t]=(0,s.useState)("chat"),[a,v]=(0,s.useState)([]),[N,f]=(0,s.useState)(""),[h,w]=(0,s.useState)(null),[k,A]=(0,s.useState)(null),[z,C]=(0,s.useState)(null),[j,_]=(0,s.useState)(!1),[S,P]=(0,s.useState)(null),I=(0,s.useRef)(null);(0,s.useEffect)((()=>{I.current?.scrollIntoView({behavior:"smooth"})}),[a]);const R=async()=>{if(!N.trim()||j)return;const e=N;f(""),v((t=>[...t,{role:"user",content:e}])),_(!0),P(null);try{const t=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,history:a.slice(-10)})});if(!t.ok){const e=await t.json().catch((()=>({})));throw new Error(e.error||`Error ${t.status}: ${t.statusText}`)}{const e=await t.json();v((t=>[...t,{role:"assistant",content:e.response}]))}}catch(t){console.error("Chat error:",t);try{const t=await y.default.chatResponse(e,a.slice(-10));v((e=>[...e,{role:"assistant",content:t}]))}catch(t){const a=`âŒ **Error de conectividad**\n\nNo pude procesar tu consulta: "${e}"\n\n**Posibles causiones:**\nâ€¢ Servidor temporalmente no disponible\nâ€¢ Error de red\nâ€¢ Servicio en mantenimiento\n\n**Mientras tanto puedes:**\nâ€¢ Intentar de nuevo en unos segundos\nâ€¢ Verificar tu conexiÃ³n a internet\nâ€¢ Consultar directamente las otras pestaÃ±as (Dashboard, Ventas, etc.)\n\nÂ¿Te gustarÃ­a intentar una consulta diferente?`;v((e=>[...e,{role:"assistant",content:a}]))}}finally{_(!1)}},O=async(e=7)=>{_(!0),P(null);try{let t;try{const a=await fetch(`/api/ai/predict_sales?days=${e}`);if(!a.ok)throw new Error("API not available");t=await a.json()}catch(a){t=await y.default.getPredictions(e)}w(t)}catch(e){P("Error al obtener predicciones de ventas"),console.error("Error:",e)}finally{_(!1)}},V=({id:e,label:t,icon:a,isActive:l,onClick:n})=>s.createElement("button",{onClick:()=>n(e),className:"flex items-center space-x-2 px-4 py-2 rounded-lg font-medium transition-colors "+(l?"bg-blue-500 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200")},s.createElement(a,{size:18}),s.createElement("span",null,t)),T=({message:e})=>s.createElement("div",{className:"flex items-start space-x-3 "+("user"===e.role?"justify-end":"")},"assistant"===e.role&&s.createElement("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0"},s.createElement(l.A,{size:16,className:"text-white"})),s.createElement("div",{className:"max-w-2xl p-4 rounded-lg "+("user"===e.role?"bg-blue-500 text-white ml-auto":"bg-white border border-gray-200 text-gray-800 shadow-sm")},s.createElement("div",{className:"text-sm leading-relaxed whitespace-pre-line"},"assistant"===e.role?e.content.split(/(\*\*[^*]+\*\*)/g).map(((e,t)=>e.startsWith("**")&&e.endsWith("**")?s.createElement("strong",{key:t},e.slice(2,-2)):e)):e.content),"assistant"===e.role&&s.createElement("div",{className:"text-xs text-gray-500 mt-2 flex items-center"},s.createElement("div",{className:"w-2 h-2 bg-green-400 rounded-full mr-2"}),"Respuesta en tiempo real de la base de datos")),"user"===e.role&&s.createElement("div",{className:"w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center flex-shrink-0"},s.createElement(n.A,{size:16,className:"text-white"})));return s.createElement("div",{className:"max-w-6xl mx-auto p-6"},s.createElement("div",{className:"mb-6"},s.createElement("h1",{className:"text-3xl font-bold text-gray-900 mb-2"},"Asistente AI Venezia"),s.createElement("p",{className:"text-gray-600"},"AnÃ¡lisis inteligente y predicciones para tu heladerÃ­a")),s.createElement("div",{className:"flex space-x-2 mb-6 overflow-x-auto pb-2"},s.createElement(V,{id:"chat",label:"Chat Inteligente",icon:r.A,isActive:"chat"===e,onClick:t}),s.createElement(V,{id:"predictions",label:"Predicciones",icon:c.A,isActive:"predictions"===e,onClick:t}),s.createElement(V,{id:"analysis",label:"AnÃ¡lisis",icon:m.A,isActive:"analysis"===e,onClick:t}),s.createElement(V,{id:"inventory",label:"Inventario",icon:i.A,isActive:"inventory"===e,onClick:t})),S&&s.createElement("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center space-x-2"},s.createElement(o.A,{size:20,className:"text-red-500"}),s.createElement("span",{className:"text-red-700"},S)),s.createElement("div",{className:"bg-white rounded-lg shadow-lg"},"chat"===e&&s.createElement("div",{className:"p-6"},s.createElement("div",{className:"h-96 overflow-y-auto mb-4 space-y-4 border rounded-lg p-4 bg-gray-50"},0===a.length&&s.createElement("div",{className:"text-center text-gray-500 mt-8"},s.createElement(l.A,{size:48,className:"mx-auto mb-4 text-blue-500"}),s.createElement("div",{className:"space-y-4"},s.createElement("div",null,s.createElement("h3",{className:"font-semibold text-lg text-gray-800"},"Â¡Hola! Soy tu asistente AI ejecutivo para Venezia Ice Cream"),s.createElement("p",{className:"text-sm text-gray-600"},"Conectado a la base de datos real - Puedo consultar y ejecutar acciones")),s.createElement("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm max-w-4xl mx-auto"},s.createElement("div",{className:"bg-blue-50 p-3 rounded-lg"},s.createElement("h4",{className:"font-medium text-blue-800 mb-2"},"ðŸ“Š Consultas en tiempo real"),s.createElement("ul",{className:"text-xs space-y-1 text-blue-700"},s.createElement("li",null,'â€¢ "Â¿QuÃ© helados tenemos?"'),s.createElement("li",null,'â€¢ "Â¿CuÃ¡nto vendimos hoy?"'),s.createElement("li",null,'â€¢ "MuÃ©strame los proveedores"'),s.createElement("li",null,'â€¢ "Â¿CÃ³mo van las ventas?"'))),s.createElement("div",{className:"bg-green-50 p-3 rounded-lg"},s.createElement("h4",{className:"font-medium text-green-800 mb-2"},"âš¡ Acciones ejecutivas"),s.createElement("ul",{className:"text-xs space-y-1 text-green-700"},s.createElement("li",null,'â€¢ "Suma 2 kg de chocolate"'),s.createElement("li",null,'â€¢ "Producir 25 kg de vainilla"'),s.createElement("li",null,'â€¢ "Â¿QuÃ© repartidores disponibles?"'),s.createElement("li",null,'â€¢ "Crear orden de producciÃ³n"')))),s.createElement("div",{className:"text-xs text-gray-500 bg-gray-50 p-3 rounded-lg max-w-md mx-auto"},s.createElement("p",null,s.createElement("strong",null,"ðŸ”— Conectividad:")," Acceso directo a productos, ventas, stock y proveedores"),s.createElement("p",null,s.createElement("strong",null,"âš¡ Poder ejecutivo:")," Puedo modificar inventario y crear Ã³rdenes reales")))),a.map(((e,t)=>s.createElement(T,{key:t,message:e}))),j&&s.createElement("div",{className:"flex items-center space-x-2 text-blue-600 bg-blue-50 p-3 rounded-lg"},s.createElement(d.A,{size:16,className:"animate-spin"}),s.createElement("span",null,"ðŸ¤– Procesando comando y ejecutando acciÃ³n...")),s.createElement("div",{ref:I})),s.createElement("div",{className:"mb-3"},s.createElement("div",{className:"flex flex-wrap gap-2"},["Â¿QuÃ© helados tenemos?","Â¿CuÃ¡nto vendimos hoy?","Suma 2 kg de chocolate","MuÃ©strame los proveedores"].map(((e,t)=>s.createElement("button",{key:t,onClick:()=>f(e),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded-full hover:bg-blue-200 transition-colors",disabled:j},e))))),s.createElement("div",{className:"flex space-x-2"},s.createElement("input",{type:"text",value:N,onChange:e=>f(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),R())},placeholder:"Escribe tu consulta o comando...",className:"flex-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:j}),s.createElement("button",{onClick:R,disabled:!N.trim()||j,className:"px-6 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2"},j?s.createElement(d.A,{size:18,className:"animate-spin"}):s.createElement(u.A,{size:18}),s.createElement("span",null,"Enviar")))),"predictions"===e&&s.createElement("div",{className:"p-6"},s.createElement("div",{className:"flex justify-between items-center mb-6"},s.createElement("h2",{className:"text-xl font-semibold"},"Predicciones de Ventas"),s.createElement("div",{className:"flex space-x-2"},s.createElement("button",{onClick:()=>O(7),className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",disabled:j},"7 dÃ­as"),s.createElement("button",{onClick:()=>O(14),className:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600",disabled:j},"14 dÃ­as"),s.createElement("button",{onClick:()=>O(30),className:"px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600",disabled:j},"30 dÃ­as"))),j&&s.createElement("div",{className:"flex items-center justify-center py-12"},s.createElement(d.A,{size:32,className:"animate-spin text-blue-500"}),s.createElement("span",{className:"ml-2 text-gray-600"},"Generando predicciones...")),h&&!j&&s.createElement("div",{className:"space-y-6"},s.createElement("div",{className:"bg-blue-50 p-4 rounded-lg"},s.createElement("h3",{className:"font-medium text-blue-900 mb-2"},"Resumen Ejecutivo"),s.createElement("p",{className:"text-blue-800"},h.summary)),h.predictions&&h.predictions.length>0&&s.createElement("div",null,s.createElement("h3",{className:"font-medium mb-4"},"Predicciones Diarias"),s.createElement("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3"},h.predictions.map(((e,t)=>s.createElement("div",{key:t,className:"border rounded-lg p-4"},s.createElement("div",{className:"flex items-center justify-between mb-2"},s.createElement(p.A,{size:16,className:"text-gray-500"}),s.createElement("span",{className:"text-sm font-medium"},e.date)),s.createElement("div",{className:"space-y-2"},s.createElement("div",{className:"flex items-center space-x-2"},s.createElement(E.A,{size:14,className:"text-blue-500"}),s.createElement("span",{className:"text-sm"},"Ventas: ",e.predicted_sales)),s.createElement("div",{className:"flex items-center space-x-2"},s.createElement(x.A,{size:14,className:"text-green-500"}),s.createElement("span",{className:"text-sm"},"Ingresos: $",e.predicted_revenue?.toFixed(2))),s.createElement("div",{className:"text-xs text-gray-500"},"Confianza: ",(100*e.confidence).toFixed(0),"%"))))))),h.recommended_products&&h.recommended_products.length>0&&s.createElement("div",null,s.createElement("h3",{className:"font-medium mb-4"},"Productos Recomendados"),s.createElement("div",{className:"grid gap-2"},h.recommended_products.map(((e,t)=>s.createElement("div",{key:t,className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg"},s.createElement("span",{className:"font-medium"},e.product_name),s.createElement("div",{className:"text-right"},s.createElement("div",{className:"text-sm"},"Demanda: ",e.expected_demand),s.createElement("div",{className:"text-xs "+("alta"===e.priority?"text-red-600":"media"===e.priority?"text-yellow-600":"text-green-600")},"Prioridad: ",e.priority))))))),h.insights&&h.insights.length>0&&s.createElement("div",null,s.createElement("h3",{className:"font-medium mb-4"},"Insights Clave"),s.createElement("ul",{className:"space-y-2"},h.insights.map(((e,t)=>s.createElement("li",{key:t,className:"flex items-start space-x-2"},s.createElement(g.A,{size:16,className:"text-green-500 mt-0.5 flex-shrink-0"}),s.createElement("span",{className:"text-sm text-gray-700"},e))))))),!h&&!j&&s.createElement("div",{className:"text-center py-12 text-gray-500"},s.createElement(c.A,{size:48,className:"mx-auto mb-4 text-gray-400"}),s.createElement("p",null,"Selecciona un perÃ­odo para generar predicciones de ventas"))),"analysis"===e&&s.createElement("div",{className:"p-6"},s.createElement("div",{className:"flex justify-between items-center mb-6"},s.createElement("h2",{className:"text-xl font-semibold"},"AnÃ¡lisis de Rendimiento"),s.createElement("button",{onClick:async()=>{_(!0),P(null);try{let e;try{const t=await fetch("/api/ai/business_analysis");if(!t.ok)throw new Error("API not available");e=await t.json()}catch(t){e=await y.default.getBusinessAnalysis()}A(e)}catch(e){P("Error al obtener anÃ¡lisis de negocio"),console.error("Error:",e)}finally{_(!1)}},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",disabled:j},j?s.createElement(d.A,{size:16,className:"animate-spin"}):"Generar AnÃ¡lisis")),j&&s.createElement("div",{className:"flex items-center justify-center py-12"},s.createElement(d.A,{size:32,className:"animate-spin text-blue-500"}),s.createElement("span",{className:"ml-2 text-gray-600"},"Analizando rendimiento...")),k&&!j&&s.createElement("div",{className:"space-y-6"},k.performance_score&&s.createElement("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-lg"},s.createElement("h3",{className:"font-medium mb-4"},"Score de Rendimiento"),s.createElement("div",{className:"flex items-center space-x-4"},s.createElement("div",{className:"text-4xl font-bold text-blue-600"},k.performance_score,"/10"),s.createElement("div",{className:"flex-1"},s.createElement("div",{className:"w-full bg-gray-200 rounded-full h-2"},s.createElement("div",{className:"bg-blue-600 h-2 rounded-full",style:{width:10*k.performance_score+"%"}}))))),s.createElement("div",{className:"bg-gray-50 p-4 rounded-lg"},s.createElement("h3",{className:"font-medium mb-2"},"Resumen Ejecutivo"),s.createElement("p",{className:"text-gray-700"},k.summary)),k.recommendations&&s.createElement("div",null,s.createElement("h3",{className:"font-medium mb-4"},"Recomendaciones EstratÃ©gicas"),s.createElement("div",{className:"space-y-3"},k.recommendations.map(((e,t)=>s.createElement("div",{key:t,className:"border rounded-lg p-4"},s.createElement("div",{className:"flex items-center justify-between mb-2"},s.createElement("span",{className:"font-medium text-gray-900"},e.category),s.createElement("span",{className:"px-2 py-1 rounded text-xs font-medium "+("alta"===e.priority?"bg-red-100 text-red-800":"media"===e.priority?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800")},e.priority)),s.createElement("p",{className:"text-sm text-gray-700 mb-2"},e.action),s.createElement("p",{className:"text-xs text-gray-500"},e.impact))))))),!k&&!j&&s.createElement("div",{className:"text-center py-12 text-gray-500"},s.createElement(m.A,{size:48,className:"mx-auto mb-4 text-gray-400"}),s.createElement("p",null,"Genera un anÃ¡lisis completo del rendimiento de tu negocio"))),"inventory"===e&&s.createElement("div",{className:"p-6"},s.createElement("div",{className:"flex justify-between items-center mb-6"},s.createElement("h2",{className:"text-xl font-semibold"},"OptimizaciÃ³n de Inventario"),s.createElement("button",{onClick:async()=>{_(!0),P(null);try{let e;try{const t=await fetch("/api/ai/inventory_optimization");if(!t.ok)throw new Error("API not available");e=await t.json()}catch(t){e=await y.default.getInventoryOptimization()}C(e)}catch(e){P("Error al obtener optimizaciÃ³n de inventario"),console.error("Error:",e)}finally{_(!1)}},className:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600",disabled:j},j?s.createElement(d.A,{size:16,className:"animate-spin"}):"Optimizar Inventario")),j&&s.createElement("div",{className:"flex items-center justify-center py-12"},s.createElement(d.A,{size:32,className:"animate-spin text-blue-500"}),s.createElement("span",{className:"ml-2 text-gray-600"},"Optimizando inventario...")),z&&!j&&s.createElement("div",{className:"space-y-6"},s.createElement("div",{className:"bg-orange-50 p-4 rounded-lg"},s.createElement("h3",{className:"font-medium text-orange-900 mb-2"},"Resumen de OptimizaciÃ³n"),s.createElement("p",{className:"text-orange-800"},z.summary)),z.stock_alerts&&z.stock_alerts.length>0&&s.createElement("div",null,s.createElement("h3",{className:"font-medium mb-4 flex items-center space-x-2"},s.createElement(o.A,{size:18,className:"text-red-500"}),s.createElement("span",null,"Alertas de Stock")),s.createElement("div",{className:"space-y-3"},z.stock_alerts.map(((e,t)=>s.createElement("div",{key:t,className:"border rounded-lg p-4"},s.createElement("div",{className:"flex items-center justify-between mb-2"},s.createElement("span",{className:"font-medium"},e.product),s.createElement("span",{className:"px-2 py-1 rounded text-xs font-medium "+("alta"===e.urgency?"bg-red-100 text-red-800":"media"===e.urgency?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800")},e.urgency)),s.createElement("div",{className:"text-sm text-gray-600 space-y-1"},s.createElement("div",null,"Tienda: ",e.store),s.createElement("div",null,"Stock actual: ",e.current_stock),s.createElement("div",null,"Stock recomendado: ",e.recommended_stock),s.createElement("div",{className:"text-xs text-gray-500 mt-2"},e.reasoning))))))),z.overstock_items&&z.overstock_items.length>0&&s.createElement("div",null,s.createElement("h3",{className:"font-medium mb-4 flex items-center space-x-2"},s.createElement(b.A,{size:18,className:"text-yellow-500"}),s.createElement("span",null,"Exceso de Stock")),s.createElement("div",{className:"space-y-3"},z.overstock_items.map(((e,t)=>s.createElement("div",{key:t,className:"border rounded-lg p-4 bg-yellow-50"},s.createElement("div",{className:"flex items-center justify-between mb-2"},s.createElement("span",{className:"font-medium"},e.product),s.createElement("span",{className:"text-sm text-gray-600"},e.store)),s.createElement("div",{className:"text-sm text-gray-700"},s.createElement("div",null,"Stock actual: ",e.current_stock),s.createElement("div",{className:"text-xs text-gray-500 mt-1"},"AcciÃ³n sugerida: ",e.suggested_action))))))),z.production_priorities&&z.production_priorities.length>0&&s.createElement("div",null,s.createElement("h3",{className:"font-medium mb-4"},"Prioridades de ProducciÃ³n"),s.createElement("div",{className:"grid gap-2"},z.production_priorities.map(((e,t)=>s.createElement("div",{key:t,className:"flex items-center justify-between p-3 bg-green-50 rounded-lg"},s.createElement("span",{className:"font-medium text-green-900"},e),s.createElement("span",{className:"text-sm text-green-700"},"Prioridad ",t+1))))))),!z&&!j&&s.createElement("div",{className:"text-center py-12 text-gray-500"},s.createElement(i.A,{size:48,className:"mx-auto mb-4 text-gray-400"}),s.createElement("p",null,"Optimiza tu inventario con recomendaciones inteligentes")))))},N=()=>s.createElement(v,null)}}]);