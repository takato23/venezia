"use strict";(self.webpackChunkvenezia_frontend=self.webpackChunkvenezia_frontend||[]).push([[107],{20107:function(e,t,a){a.r(t),a.d(t,{default:function(){return W}});var r=a(96540),l=a(86589),n=a(17133),s=a(89667),c=a(76316),o=a(81966),i=a(15977),d=a(48309),m=a(32307),g=a(93893),u=a(96844),p=a(80827),y=a(70700),x=a(42203),v=a(72284),E=a(71428),b=a(11562),k=a(28219),f=a(10607),N=a(74362),h=a(48234),w=a(94945),A=a(71429),_=a(86241),S=a(20053),z=({title:e,description:t,data:a=[],type:l="bar",onExport:n,className:s})=>{const o=(()=>{switch(l){case"line":return N.A;case"pie":return h.A;default:return w.A}})(),i=(()=>{if(!a||a.length<2)return null;const e=a[a.length-1]?.value||0,t=a[a.length-2]?.value||0;if(0===t)return null;const r=(e-t)/t*100;return{value:Math.abs(r).toFixed(1),direction:r>0?"up":r<0?"down":"neutral"}})();return r.createElement("div",{className:(0,S.A)("bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700",s)},r.createElement("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700"},r.createElement("div",{className:"flex items-center gap-3"},r.createElement("div",{className:"p-2 bg-venezia-100 dark:bg-venezia-900/20 rounded-lg"},r.createElement(o,{className:"w-5 h-5 text-venezia-600 dark:text-venezia-400"})),r.createElement("div",null,r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white"},e),r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},t))),r.createElement(v.A,{onClick:n,variant:"ghost",size:"sm",icon:d.A,className:"text-gray-400 hover:text-gray-600"})),r.createElement("div",{className:"p-4"},a&&a.length>0?r.createElement(r.Fragment,null,r.createElement("div",{className:"mb-4"},(()=>{switch(l){case"line":return r.createElement("div",{className:"h-32 flex items-end space-x-1"},a.slice(0,12).map(((e,t)=>r.createElement("div",{key:t,className:"flex-1 bg-gradient-to-t from-venezia-200 to-venezia-400 rounded-t",style:{height:`${Math.max(10,e.value/Math.max(...a.map((e=>e.value)))*100)}%`}}))));case"pie":return r.createElement("div",{className:"h-32 flex items-center justify-center"},r.createElement("div",{className:"w-24 h-24 rounded-full border-8 border-venezia-200 border-t-venezia-500 border-r-venezia-400"}));default:return r.createElement("div",{className:"h-32 flex items-end space-x-2"},a.slice(0,8).map(((e,t)=>r.createElement("div",{key:t,className:"flex-1 bg-gradient-to-t from-venezia-300 to-venezia-500 rounded-t",style:{height:`${Math.max(10,e.value/Math.max(...a.map((e=>e.value)))*100)}%`}}))))}})()),r.createElement("div",{className:"grid grid-cols-2 gap-4"},r.createElement("div",{className:"text-center p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Total"),r.createElement("p",{className:"text-lg font-bold text-gray-900 dark:text-white"},a.reduce(((e,t)=>e+(t.value||0)),0).toLocaleString())),r.createElement("div",{className:"text-center p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Promedio"),r.createElement("p",{className:"text-lg font-bold text-gray-900 dark:text-white"},(a.reduce(((e,t)=>e+(t.value||0)),0)/a.length).toLocaleString()))),i&&r.createElement("div",{className:"mt-4 p-3 bg-gray-50 dark:bg-gray-700/50 rounded-lg"},r.createElement("div",{className:"flex items-center justify-center gap-2"},"up"===i.direction&&r.createElement(r.Fragment,null,r.createElement(c.A,{className:"w-4 h-4 text-green-500"}),r.createElement("span",{className:"text-sm text-green-600 dark:text-green-400"},"+",i.value,"% vs período anterior")),"down"===i.direction&&r.createElement(r.Fragment,null,r.createElement(A.A,{className:"w-4 h-4 text-red-500"}),r.createElement("span",{className:"text-sm text-red-600 dark:text-red-400"},"-",i.value,"% vs período anterior")),"neutral"===i.direction&&r.createElement(r.Fragment,null,r.createElement(_.A,{className:"w-4 h-4 text-gray-500"}),r.createElement("span",{className:"text-sm text-gray-500"},"Sin cambios vs período anterior"))))):r.createElement("div",{className:"text-center py-8"},r.createElement(o,{className:"w-12 h-12 mx-auto text-gray-400 mb-2"}),r.createElement("p",{className:"text-gray-500 dark:text-gray-400"},"No hay datos disponibles para mostrar"))))},C=a(98445),M=a(72102),R=a(75107),P=a(98645),j=a(3160),F=({title:e,data:t=[],columns:a=[],onExport:l,searchable:n=!0,sortable:s=!0,pageSize:c=10,className:o})=>{const[i,m]=(0,r.useState)(""),[g,u]=(0,r.useState)(null),[p,y]=(0,r.useState)("asc"),[x,E]=(0,r.useState)(1),f=(0,r.useMemo)((()=>{let e=t;return i&&n&&(e=t.filter((e=>a.some((t=>String(e[t.key]||"").toLowerCase().includes(i.toLowerCase())))))),g&&s&&(e=[...e].sort(((e,t)=>{const a=e[g]||"",r=t[g]||"";if("number"==typeof a&&"number"==typeof r)return"asc"===p?a-r:r-a;const l=String(a).toLowerCase(),n=String(r).toLowerCase();return"asc"===p?l.localeCompare(n):n.localeCompare(l)}))),e}),[t,i,g,p,a,n,s]),N=Math.ceil(f.length/c),h=(x-1)*c,w=h+c,A=f.slice(h,w),_=(e,t)=>{if(null==e)return"-";switch(t){case"currency":return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS"}).format(e);case"percentage":return`${Number(e).toFixed(1)}%`;case"date":return new Date(e).toLocaleDateString("es-AR");case"number":return Number(e).toLocaleString("es-AR");default:return String(e)}},z=e=>{switch(e?.toLowerCase()){case"completed":case"delivered":case"active":case"success":return"success";case"pending":case"processing":return"warning";case"cancelled":case"failed":case"error":return"error";default:return"default"}};return r.createElement("div",{className:(0,S.A)("bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700",o)},r.createElement("div",{className:"flex items-center justify-between p-4 border-b dark:border-gray-700"},r.createElement("div",null,r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white"},e),r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},f.length," registro",1!==f.length?"s":"",t.length!==f.length&&` de ${t.length} total`)),r.createElement("div",{className:"flex items-center gap-2"},n&&r.createElement("div",{className:"w-64"},r.createElement(b.A,{type:"text",placeholder:"Buscar en tabla...",value:i,onChange:e=>m(e.target.value),icon:C.A,size:"sm"})),r.createElement(v.A,{onClick:l,variant:"outline",size:"sm",icon:d.A},"Exportar"))),r.createElement("div",{className:"overflow-x-auto"},r.createElement("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700"},r.createElement("thead",{className:"bg-gray-50 dark:bg-gray-700/50"},r.createElement("tr",null,a.map((e=>r.createElement("th",{key:e.key,className:(0,S.A)("px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-400 uppercase tracking-wider",s&&"cursor-pointer hover:bg-gray-100 dark:hover:bg-gray-600 select-none"),onClick:()=>{return t=e.key,void(s&&(g===t?y("asc"===p?"desc":"asc"):(u(t),y("asc"))));var t}},r.createElement("div",{className:"flex items-center gap-2"},r.createElement("span",null,e.label),s&&r.createElement("div",{className:"flex flex-col"},g===e.key?"asc"===p?r.createElement(M.A,{className:"w-3 h-3"}):r.createElement(R.A,{className:"w-3 h-3"}):r.createElement(P.A,{className:"w-3 h-3 text-gray-400"})))))))),r.createElement("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700"},A.length>0?A.map(((e,t)=>r.createElement("tr",{key:t,className:"hover:bg-gray-50 dark:hover:bg-gray-700/50 transition-colors"},a.map((t=>r.createElement("td",{key:t.key,className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 dark:text-white"},"status"===t.key?r.createElement(k.A,{variant:z(e[t.key])},_(e[t.key],t.format)):_(e[t.key],t.format))))))):r.createElement("tr",null,r.createElement("td",{colSpan:a.length,className:"px-6 py-12 text-center text-gray-500 dark:text-gray-400"},r.createElement(j.A,{className:"w-12 h-12 mx-auto mb-2 text-gray-400"}),r.createElement("p",null,"No se encontraron datos"),i&&r.createElement("p",{className:"text-sm mt-1"},"Intenta con otros términos de búsqueda")))))),N>1&&r.createElement("div",{className:"flex items-center justify-between px-6 py-3 border-t dark:border-gray-700"},r.createElement("div",{className:"text-sm text-gray-600 dark:text-gray-400"},"Mostrando ",h+1," a ",Math.min(w,f.length)," de ",f.length," resultados"),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(v.A,{onClick:()=>E(x-1),disabled:1===x,variant:"outline",size:"sm"},"Anterior"),r.createElement("div",{className:"flex items-center gap-1"},Array.from({length:Math.min(5,N)},((e,t)=>{let a;return a=N<=5||x<=3?t+1:x>=N-2?N-4+t:x-2+t,r.createElement(v.A,{key:a,onClick:()=>E(a),variant:x===a?"primary":"ghost",size:"sm",className:"w-8 h-8 p-0"},a)}))),r.createElement(v.A,{onClick:()=>E(x+1),disabled:x===N,variant:"outline",size:"sm"},"Siguiente"))))},$=a(31929),D=a(59612),I=a(45773),L=a(43954),O=a(48852),V=a(48697),T=a(67773),U=({isOpen:e,onClose:t,onExport:a,reportName:l="reporte"})=>{const[n,s]=(0,r.useState)("pdf"),[c,o]=(0,r.useState)(!0),[i,m]=(0,r.useState)(!0),[g,u]=(0,r.useState)(!1),[y,x]=(0,r.useState)(""),[E,k]=(0,r.useState)(!1),f=[{value:"pdf",label:"PDF",description:"Documento PDF completo",icon:p.A,recommended:!0},{value:"excel",label:"Excel",description:"Hoja de cálculo con datos",icon:$.A},{value:"csv",label:"CSV",description:"Datos en formato CSV",icon:$.A},{value:"png",label:"PNG",description:"Imagen de alta calidad",icon:D.A}],N=()=>{s("pdf"),o(!0),m(!0),u(!1),x(""),t()};return r.createElement(T.A,{isOpen:e,onClose:N,title:r.createElement("div",{className:"flex items-center gap-2"},r.createElement(d.A,{className:"w-5 h-5"}),"Exportar Reporte"),size:"md"},r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"bg-gray-50 dark:bg-gray-700/50 rounded-lg p-4"},r.createElement("h3",{className:"font-medium text-gray-900 dark:text-white mb-1"},l?.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase()))||"Reporte"),r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Selecciona el formato y opciones de exportación")),r.createElement("div",{className:"space-y-3"},r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Formato de Exportación"),r.createElement("div",{className:"grid grid-cols-1 gap-3"},f.map((e=>{const t=e.icon;return r.createElement("button",{key:e.value,onClick:()=>s(e.value),className:(0,S.A)("relative p-4 border rounded-lg text-left transition-all","hover:bg-gray-50 dark:hover:bg-gray-700/50",n===e.value?"border-venezia-500 bg-venezia-50 dark:bg-venezia-900/20":"border-gray-200 dark:border-gray-700")},r.createElement("div",{className:"flex items-start gap-3"},r.createElement(t,{className:(0,S.A)("w-5 h-5 mt-0.5",n===e.value?"text-venezia-600 dark:text-venezia-400":"text-gray-400")}),r.createElement("div",{className:"flex-1"},r.createElement("div",{className:"flex items-center gap-2"},r.createElement("span",{className:(0,S.A)("font-medium",n===e.value?"text-venezia-900 dark:text-venezia-100":"text-gray-900 dark:text-white")},e.label),e.recommended&&r.createElement("span",{className:"px-2 py-0.5 text-xs bg-green-100 text-green-700 dark:bg-green-900/20 dark:text-green-400 rounded-full"},"Recomendado")),r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-1"},e.description)),r.createElement("div",{className:(0,S.A)("w-4 h-4 rounded-full border-2 flex items-center justify-center",n===e.value?"border-venezia-500 bg-venezia-500":"border-gray-300 dark:border-gray-600")},n===e.value&&r.createElement(I.A,{className:"w-2.5 h-2.5 text-white"}))))})))),r.createElement("div",{className:"space-y-4"},r.createElement("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300"},"Opciones de Contenido"),r.createElement("div",{className:"space-y-3"},r.createElement("label",{className:"flex items-center gap-3"},r.createElement("input",{type:"checkbox",checked:c,onChange:e=>o(e.target.checked),className:"rounded border-gray-300 text-venezia-600 focus:ring-venezia-500",disabled:"csv"===n}),r.createElement("div",null,r.createElement("span",{className:"text-sm font-medium text-gray-900 dark:text-white"},"Incluir gráficos"),r.createElement("p",{className:"text-xs text-gray-600 dark:text-gray-400"},"Incluye visualizaciones y gráficos en el reporte"))),r.createElement("label",{className:"flex items-center gap-3"},r.createElement("input",{type:"checkbox",checked:i,onChange:e=>m(e.target.checked),className:"rounded border-gray-300 text-venezia-600 focus:ring-venezia-500"}),r.createElement("div",null,r.createElement("span",{className:"text-sm font-medium text-gray-900 dark:text-white"},"Incluir tablas de datos"),r.createElement("p",{className:"text-xs text-gray-600 dark:text-gray-400"},"Incluye datos detallados en formato de tabla"))))),r.createElement("div",{className:"space-y-4"},r.createElement("label",{className:"flex items-center gap-3"},r.createElement("input",{type:"checkbox",checked:g,onChange:e=>u(e.target.checked),className:"rounded border-gray-300 text-venezia-600 focus:ring-venezia-500"}),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(L.A,{className:"w-4 h-4 text-gray-500"}),r.createElement("span",{className:"text-sm font-medium text-gray-900 dark:text-white"},"Enviar por email"))),g&&r.createElement(b.A,{type:"email",placeholder:"correo@ejemplo.com",value:y,onChange:e=>x(e.target.value),label:"Dirección de email",icon:L.A,required:!0})),r.createElement("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4"},r.createElement("div",{className:"flex items-start gap-3"},r.createElement(O.A,{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mt-0.5"}),r.createElement("div",null,r.createElement("h4",{className:"text-sm font-medium text-blue-900 dark:text-blue-100"},"Vista previa del archivo"),r.createElement("p",{className:"text-sm text-blue-700 dark:text-blue-300 mt-1"},"Nombre: ",l,"_",(new Date).toISOString().split("T")[0],".",n),r.createElement("div",{className:"mt-2 text-xs text-blue-600 dark:text-blue-400"},r.createElement("p",null,"✓ ",c?"Con gráficos":"Sin gráficos"),r.createElement("p",null,"✓ ",i?"Con datos detallados":"Solo resumen"),g&&r.createElement("p",null,"✓ Se enviará a ",y))))),r.createElement("div",{className:"flex justify-end gap-3 pt-4 border-t dark:border-gray-700"},r.createElement(v.A,{onClick:N,variant:"outline",icon:V.A},"Cancelar"),r.createElement(v.A,{onClick:async()=>{k(!0);try{await a(n,{includeCharts:c,includeData:i,emailReport:g,emailAddress:g?y:null}),t()}catch(e){console.error("Export error:",e)}finally{k(!1)}},variant:"primary",icon:d.A,loading:E,disabled:g&&!y},g?"Enviar y Descargar":"Descargar"))))},W=()=>{const[e,t]=(0,r.useState)("sales"),[a,k]=(0,r.useState)("last_30_days"),[N,h]=(0,r.useState)(""),[w,A]=(0,r.useState)(""),[_,C]=(0,r.useState)("all"),[M,R]=(0,r.useState)(!1),[P,j]=(0,r.useState)(null),{success:$,error:D}=(0,x.d)(),{data:I,loading:L,error:O,refetch:V}=(0,y.Wl)(`/api/reports/sales?range=${a}&store=${_}&from=${N}&to=${w}`),{data:T,loading:W,refetch:B}=(0,y.Wl)(`/api/reports/inventory?range=${a}&store=${_}`),{data:q,loading:H,refetch:G}=(0,y.Wl)(`/api/reports/production?range=${a}`),{data:Z,loading:J,refetch:K}=(0,y.Wl)(`/api/reports/financial?range=${a}&store=${_}`),{data:Q,loading:X,refetch:Y}=(0,y.Wl)(`/api/reports/delivery?range=${a}`),{data:ee,loading:te}=(0,y.Wl)("/api/stores"),ae=I||{},re=T||{},le=q||{},ne=Z||{},se=Q||{},ce=ee||[],oe=L||W||H||J||X||te,ie=[{id:"sales",name:"Ventas",icon:l.A,description:"Análisis de ventas y rendimiento comercial",color:"text-green-600"},{id:"inventory",name:"Inventario",icon:n.A,description:"Estado de stock y movimientos de inventario",color:"text-blue-600"},{id:"production",name:"Producción",icon:s.A,description:"Eficiencia y métricas de producción",color:"text-purple-600"},{id:"financial",name:"Financiero",icon:c.A,description:"Análisis financiero y rentabilidad",color:"text-indigo-600"},{id:"delivery",name:"Entregas",icon:o.A,description:"Rendimiento de entregas y logística",color:"text-orange-600"}],de=(0,r.useMemo)((()=>({totalRevenue:ae.total_revenue||0,totalOrders:ae.total_orders||0,averageOrderValue:ae.avg_order_value||0,totalCustomers:ae.unique_customers||0,inventoryValue:re.total_value||0,lowStockItems:re.low_stock_count||0,productionEfficiency:le.efficiency_percentage||0,completedBatches:le.completed_batches||0,netProfit:ne.net_profit||0,profitMargin:ne.profit_margin||0,deliveredOrders:se.delivered_orders||0,deliveryEfficiency:se.efficiency_percentage||0})),[ae,re,le,ne,se]),me=()=>{V(),B(),G(),K(),Y(),$("Actualizado","Datos actualizados correctamente")},ge=e=>{j(e),R(!0)};return r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4"},r.createElement("div",null,r.createElement("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white"},"Centro de Reportes"),r.createElement("p",{className:"text-gray-600 dark:text-gray-400 mt-1"},"Análisis completo y reportes de negocio")),r.createElement("div",{className:"flex items-center gap-2"},r.createElement(v.A,{onClick:me,variant:"outline",size:"sm",icon:i.A},"Actualizar"),r.createElement(v.A,{onClick:()=>ge(e),variant:"primary",icon:d.A},"Exportar"))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700 p-4"},r.createElement("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4"},r.createElement(E.A,{label:"Período",value:a,onChange:e=>k(e.target.value),options:[{value:"today",label:"Hoy"},{value:"yesterday",label:"Ayer"},{value:"last_7_days",label:"Últimos 7 días"},{value:"last_30_days",label:"Últimos 30 días"},{value:"last_90_days",label:"Últimos 90 días"},{value:"this_month",label:"Este mes"},{value:"last_month",label:"Mes pasado"},{value:"this_year",label:"Este año"},{value:"custom",label:"Personalizado"}],icon:m.A}),r.createElement(E.A,{label:"Tienda",value:_,onChange:e=>C(e.target.value),options:[{value:"all",label:"Todas las tiendas"},...ce.map((e=>({value:e.id.toString(),label:e.name})))],icon:g.A}),"custom"===a&&r.createElement(r.Fragment,null,r.createElement(b.A,{label:"Desde",type:"date",value:N,onChange:e=>h(e.target.value)}),r.createElement(b.A,{label:"Hasta",type:"date",value:w,onChange:e=>A(e.target.value)})))),r.createElement("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4"},r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Ingresos"),r.createElement("p",{className:"text-xl font-bold text-green-600"},"$",de.totalRevenue.toLocaleString())),r.createElement(l.A,{className:"w-8 h-8 text-green-600"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Órdenes"),r.createElement("p",{className:"text-xl font-bold text-blue-600"},de.totalOrders)),r.createElement(u.A,{className:"w-8 h-8 text-blue-600"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Stock Bajo"),r.createElement("p",{className:"text-xl font-bold text-orange-600"},de.lowStockItems)),r.createElement(n.A,{className:"w-8 h-8 text-orange-600"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Producción"),r.createElement("p",{className:"text-xl font-bold text-purple-600"},de.productionEfficiency.toFixed(1),"%")),r.createElement(s.A,{className:"w-8 h-8 text-purple-600"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Margen"),r.createElement("p",{className:"text-xl font-bold text-indigo-600"},de.profitMargin.toFixed(1),"%")),r.createElement(c.A,{className:"w-8 h-8 text-indigo-600"}))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm p-4 border dark:border-gray-700"},r.createElement("div",{className:"flex items-center justify-between"},r.createElement("div",null,r.createElement("p",{className:"text-sm text-gray-600 dark:text-gray-400"},"Entregas"),r.createElement("p",{className:"text-xl font-bold text-orange-600"},de.deliveryEfficiency.toFixed(1),"%")),r.createElement(o.A,{className:"w-8 h-8 text-orange-600"})))),r.createElement("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border dark:border-gray-700"},r.createElement("div",{className:"border-b dark:border-gray-700"},r.createElement("div",{className:"flex overflow-x-auto"},ie.map((a=>{const l=a.icon;return r.createElement("button",{key:a.id,onClick:()=>t(a.id),className:(0,S.A)("flex items-center gap-3 px-6 py-4 border-b-2 transition-colors whitespace-nowrap min-w-fit",e===a.id?"border-venezia-600 text-venezia-600 dark:text-venezia-400 bg-venezia-50 dark:bg-venezia-900/20":"border-transparent text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-700/50")},r.createElement(l,{className:(0,S.A)("w-5 h-5",a.color)}),r.createElement("div",{className:"text-left"},r.createElement("div",{className:"font-medium"},a.name),r.createElement("div",{className:"text-xs text-gray-500 dark:text-gray-400"},a.description)))})))),r.createElement("div",{className:"p-6"},r.createElement(f.A,{loading:oe,error:O,empty:!1,onRetry:me,emptyText:"No hay datos disponibles",emptyIcon:p.A}),!oe&&r.createElement(r.Fragment,null,"sales"===e&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},r.createElement(z,{title:"Ventas por Período",description:"Evolución de ventas en el tiempo",data:ae.sales_by_period,type:"line",onExport:()=>ge("sales_period")}),r.createElement(z,{title:"Productos Más Vendidos",description:"Top productos por volumen de ventas",data:ae.top_products,type:"bar",onExport:()=>ge("top_products")})),r.createElement(F,{title:"Detalle de Ventas",data:ae.sales_detail||[],columns:[{key:"date",label:"Fecha"},{key:"order_id",label:"Orden"},{key:"customer",label:"Cliente"},{key:"products",label:"Productos"},{key:"total",label:"Total",format:"currency"},{key:"status",label:"Estado"}],onExport:()=>ge("sales_detail")})),"inventory"===e&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},r.createElement(z,{title:"Valor de Inventario",description:"Distribución del valor por categoría",data:re.value_by_category,type:"pie",onExport:()=>ge("inventory_value")}),r.createElement(z,{title:"Movimientos de Stock",description:"Entradas y salidas de inventario",data:re.stock_movements,type:"bar",onExport:()=>ge("stock_movements")})),r.createElement(F,{title:"Productos con Stock Bajo",data:re.low_stock_items||[],columns:[{key:"name",label:"Producto"},{key:"current_stock",label:"Stock Actual"},{key:"min_stock",label:"Stock Mínimo"},{key:"value",label:"Valor",format:"currency"},{key:"last_movement",label:"Último Movimiento"}],onExport:()=>ge("low_stock")})),"production"===e&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},r.createElement(z,{title:"Eficiencia de Producción",description:"Métricas de rendimiento por período",data:le.efficiency_by_period,type:"line",onExport:()=>ge("production_efficiency")}),r.createElement(z,{title:"Producción por Sabor",description:"Volumen de producción por tipo de helado",data:le.production_by_flavor,type:"bar",onExport:()=>ge("production_flavor")})),r.createElement(F,{title:"Lotes de Producción",data:le.production_batches||[],columns:[{key:"batch_id",label:"Lote"},{key:"product",label:"Producto"},{key:"quantity",label:"Cantidad"},{key:"start_date",label:"Inicio"},{key:"completion_date",label:"Finalización"},{key:"efficiency",label:"Eficiencia",format:"percentage"}],onExport:()=>ge("production_batches")})),"financial"===e&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},r.createElement(z,{title:"Ingresos vs Gastos",description:"Análisis de rentabilidad",data:ne.revenue_vs_costs,type:"line",onExport:()=>ge("revenue_costs")}),r.createElement(z,{title:"Márgenes por Producto",description:"Rentabilidad por línea de producto",data:ne.margins_by_product,type:"bar",onExport:()=>ge("product_margins")})),r.createElement(F,{title:"Resumen Financiero",data:ne.financial_summary||[],columns:[{key:"period",label:"Período"},{key:"revenue",label:"Ingresos",format:"currency"},{key:"costs",label:"Costos",format:"currency"},{key:"gross_profit",label:"Utilidad Bruta",format:"currency"},{key:"net_profit",label:"Utilidad Neta",format:"currency"},{key:"margin",label:"Margen",format:"percentage"}],onExport:()=>ge("financial_summary")})),"delivery"===e&&r.createElement("div",{className:"space-y-6"},r.createElement("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6"},r.createElement(z,{title:"Rendimiento de Entregas",description:"Métricas de eficiencia en entregas",data:se.delivery_performance,type:"line",onExport:()=>ge("delivery_performance")}),r.createElement(z,{title:"Entregas por Zona",description:"Distribución geográfica de entregas",data:se.deliveries_by_zone,type:"pie",onExport:()=>ge("delivery_zones")})),r.createElement(F,{title:"Detalle de Entregas",data:se.delivery_detail||[],columns:[{key:"date",label:"Fecha"},{key:"order_id",label:"Orden"},{key:"customer",label:"Cliente"},{key:"address",label:"Dirección"},{key:"driver",label:"Repartidor"},{key:"status",label:"Estado"},{key:"delivery_time",label:"Tiempo Entrega"}],onExport:()=>ge("delivery_detail")}))))),r.createElement(U,{isOpen:M,onClose:()=>R(!1),onExport:async(t,r)=>{try{const l=new URLSearchParams({category:e,range:a,store:_,format:t,charts:r,...N&&{from:N},...w&&{to:w}}),n=await fetch(`/api/reports/export?${l}`);if(n.ok){const a=await n.blob(),r=window.URL.createObjectURL(a),l=document.createElement("a");l.style.display="none",l.href=r;const s=(new Date).toISOString().split("T")[0],c=`reporte_${e}_${s}.${t}`;l.download=c,document.body.appendChild(l),l.click(),window.URL.revokeObjectURL(r),document.body.removeChild(l),$("Exportado",`Reporte exportado como ${c}`)}else D("Error","No se pudo exportar el reporte")}catch(e){D("Error","Error al exportar el reporte")}R(!1),j(null)},reportName:P}))}}}]);